{"programModules":{"EXT130MI":{"program":"EXT130MI","triggers":{},"transactions":{"LstReceiving":{"sourceUuid":"f8b32df4-0138-4ce3-955d-5bed4539efb8","name":"LstReceiving","program":"EXT130MI","description":"List Receiving","active":true,"multi":true,"modified":1721248500729,"modifiedBy":"900046","outputFields":[{"name":"WHLO","description":"warehouse","length":3,"mandatory":false,"type":"A"},{"name":"ITNO","description":"item number","length":15,"mandatory":false,"type":"A"},{"name":"BANO","description":"lot number","length":20,"mandatory":false,"type":"A"},{"name":"CAMU","description":"container","length":20,"mandatory":false,"type":"A"},{"name":"STAS","description":"status - balance ID","length":1,"mandatory":false,"type":"A"},{"name":"STQT","description":"on-hand balance approved","length":15,"mandatory":false,"type":"N"},{"name":"RGDT","description":"entry date","length":8,"mandatory":false,"type":"N"},{"name":"ITDS","description":"name","length":60,"mandatory":false,"type":"A"},{"name":"STAT","description":"status","length":2,"mandatory":false,"type":"A"},{"name":"QSTA","description":"QI request status","length":1,"mandatory":false,"type":"N"},{"name":"QRID","description":"QI request ID","length":8,"mandatory":false,"type":"A"},{"name":"QAPR","description":"QI request approval status","length":1,"mandatory":false,"type":"N"},{"name":"EXPI","description":"expiration date","length":8,"mandatory":false,"type":"N"},{"name":"MFDT","description":"manufacturing date","length":8,"mandatory":false,"type":"N"},{"name":"REDA","description":"receipt date","length":8,"mandatory":false,"type":"N"},{"name":"SEDT","description":"sales date","length":8,"mandatory":false,"type":"N"},{"name":"SUNO","description":"supplier","length":10,"mandatory":false,"type":"A"},{"name":"TRDT","description":"transaction date","length":8,"mandatory":false,"type":"N"},{"name":"QRI1","description":"QI request ID","length":8,"mandatory":false,"type":"A"},{"name":"QAP1","description":"QI request approval status","length":1,"mandatory":false,"type":"N"},{"name":"QST1","description":"QI request status","length":1,"mandatory":false,"type":"N"},{"name":"RIDN","description":"order number","length":10,"mandatory":false,"type":"A"},{"name":"SUN1","description":"supplier","length":10,"mandatory":false,"type":"A"}],"inputFields":[{"name":"CONO","description":"Company","length":3,"mandatory":true,"type":"A"}],"utilities":["DateUtil"],"market":"ALL"}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"f8b32df4-0138-4ce3-955d-5bed4539efb8":{"uuid":"f8b32df4-0138-4ce3-955d-5bed4539efb8","updated":1721773771397,"updatedBy":"900046","created":1720738023156,"createdBy":"900046","apiVersion":"0.21","beVersion":"16.0.0.20240418165458.8","language":"GROOVY","codeHash":"92C14F1CF4C93A168FCBF0B1F9B46F45606C54B6D76BE3CB3653EB1C82B0C729","code":"LyoqDQogKiBSRUFETUUNCiAqIFRoaXMgY2xhc3MgZXh0ZW5kcyBFeHRlbmRNM1RyYW5zYWN0aW9uIGFuZCBsaXN0cyByZWNvcmRzIGZvciB0aGUgUmVjZWl2aW5nIHBhbmVsIGluIHRoZSBRTVMgYXBwLg0KICoNCiAqIE5hbWU6IEVYVDEzME1JLkxzdFJlY2VpdmluZw0KICogRGVzY3JpcHRpb246IExpc3QgZGF0YSBmb3IgdGhlIGN1c3RvbWVyIFJlY2VpdmluZyBwYW5lbA0KICogRGF0ZQkgICAgICBDaGFuZ2VkIEJ5ICAgIERlc2NyaXB0aW9uDQogKiAyMDI0MDcyMAkgIEFKQVlZICAgICAgICAJVGhpcyBjbGFzcyBleHRlbmRzIEV4dGVuZE0zVHJhbnNhY3Rpb24gYW5kIGxpc3RzIHJlY29yZHMgZm9yIHRoZSBSZWNlaXZpbmcgcGFuZWwgaW4gdGhlIFFNUyBhcHAuDQogKiAyMDI0MDcyMwkgIEFKQVlZICAgICAgICAJQ29kZSBjbGVhbnVwDQogKiovDQoNCg0KcHVibGljIGNsYXNzIExzdFJlY2VpdmluZyBleHRlbmRzIEV4dGVuZE0zVHJhbnNhY3Rpb24gew0KICBwcml2YXRlIGZpbmFsIE1JQVBJIG1pDQogIHByaXZhdGUgZmluYWwgRGF0YWJhc2VBUEkgZGF0YWJhc2UNCiAgcHJpdmF0ZSBmaW5hbCBQcm9ncmFtQVBJIHByb2dyYW0NCiAgcHJpdmF0ZSBmaW5hbCBVdGlsaXR5QVBJIHV0aWxpdHkNCg0KICBwcml2YXRlIFN0cmluZyBpQ09OTzsgICAvLyBDb21wYW55IG51bWJlcg0KDQogIHByaXZhdGUgTGlzdDxEQkNvbnRhaW5lcj4gbWlsb21hTGlzdCA9IG5ldyBBcnJheUxpc3Q8PigpICAgLy8gTGlzdCBvZiBjb250YWluZXJzIGZyb20gTUlMT01BIHRhYmxlDQogIHByaXZhdGUgTGlzdDxEQkNvbnRhaW5lcj4gbWl0bWFzTGlzdCA9IG5ldyBBcnJheUxpc3Q8PigpICAgLy8gTGlzdCBvZiBjb250YWluZXJzIGZyb20gTUlUTUFTIHRhYmxlDQogIHByaXZhdGUgTGlzdDxEQkNvbnRhaW5lcj4gcW1zcnFoTGlzdCA9IG5ldyBBcnJheUxpc3Q8PigpICAgLy8gTGlzdCBvZiBjb250YWluZXJzIGZyb20gUU1TUlFIIHRhYmxlDQogIHByaXZhdGUgTGlzdDxEQkNvbnRhaW5lcj4gcW1zcnFoTGlzdDEgPSBuZXcgQXJyYXlMaXN0PD4oKSAgLy8gQW5vdGhlciBsaXN0IG9mIGNvbnRhaW5lcnMgZnJvbSBRTVNSUUggdGFibGUNCiAgcHJpdmF0ZSBMaXN0PERCQ29udGFpbmVyPiBtaXR0cmFMaXN0ID0gbmV3IEFycmF5TGlzdDw+KCkgICAvLyBMaXN0IG9mIGNvbnRhaW5lcnMgZnJvbSBNSVRUUkEgdGFibGUNCiAgcHJpdmF0ZSBMaXN0PERCQ29udGFpbmVyPiBtcGhlYWRMaXN0ID0gbmV3IEFycmF5TGlzdDw+KCkgICAvLyBMaXN0IG9mIGNvbnRhaW5lcnMgZnJvbSBNUEhFQUQgdGFibGUNCg0KICAvKioNCiAgICogQ29uc3RydWN0b3IgZm9yIExzdFJlY2VpdmluZyBjbGFzcy4NCiAgICogQHBhcmFtIG1pICAgICAgIE1JQVBJIG9iamVjdA0KICAgKiBAcGFyYW0gZGF0YWJhc2UgRGF0YWJhc2VBUEkgb2JqZWN0DQogICAqIEBwYXJhbSBwcm9ncmFtICBQcm9ncmFtQVBJIG9iamVjdA0KICAgKiBAcGFyYW0gdXRpbGl0eSAgVXRpbGl0eUFQSSBvYmplY3QNCiAgICovDQogIHB1YmxpYyBMc3RSZWNlaXZpbmcoTUlBUEkgbWksIERhdGFiYXNlQVBJIGRhdGFiYXNlLCBQcm9ncmFtQVBJIHByb2dyYW0sIFV0aWxpdHlBUEkgdXRpbGl0eSkgew0KICAgIHRoaXMubWkgPSBtaQ0KICAgIHRoaXMuZGF0YWJhc2UgPSBkYXRhYmFzZQ0KICAgIHRoaXMucHJvZ3JhbSA9IHByb2dyYW0NCiAgICB0aGlzLnV0aWxpdHkgPSB1dGlsaXR5DQogIH0NCg0KICAvKioNCiAgICogTWFpbiBtZXRob2QgdGhhdCBwZXJmb3JtcyB0aGUgbGlzdGluZyBvcGVyYXRpb24gZm9yIHJlY2VpdmluZyByZWNvcmRzLg0KICAgKi8NCiAgcHVibGljIHZvaWQgbWFpbigpIHsNCiAgICBpQ09OTyA9IG1pLmluLmdldCgiQ09OTyIpLnRvU3RyaW5nKCkgPT0gbnVsbCA/IHByb2dyYW0uTERBWkQuQ09OTyA6IG1pLmluLmdldCgiQ09OTyIpLnRvU3RyaW5nKCkudHJpbSgpDQoNCiAgICAvLyBDYWxjdWxhdGUgdGhlIHRpbWVzdGFtcCBmb3IgMSBkYXkgYWdvDQogICAgbG9uZyBjdXJyZW50RXBvY2hNaWxsaXNlY29uZHMgPSB1dGlsaXR5LmNhbGwoIkRhdGVVdGlsIiwgImN1cnJlbnRFcG9jaE1pbGxpc2Vjb25kcyIpIGFzIGxvbmcNCiAgICBjdXJyZW50RXBvY2hNaWxsaXNlY29uZHMgPSBjdXJyZW50RXBvY2hNaWxsaXNlY29uZHMgLSAoMSAqIDI0ICogNjAgKiA2MCAqIDEwMDBMKQ0KDQogICAgLy8gQ3JlYXRlIGV4cHJlc3Npb24gZm9yIHF1ZXJ5aW5nIHRoZSBNSVRMT0MgdGFibGUgd2l0aCBhIGRhdGUgY29uZGl0aW9uDQogICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwcmVzc2lvbiA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJNSVRMT0MiKQ0KICAgIGV4cHJlc3Npb24gPSBleHByZXNzaW9uLmdlKCJNTExNVFMiLCBjdXJyZW50RXBvY2hNaWxsaXNlY29uZHMudG9TdHJpbmcoKSkNCg0KICAgIC8vIENyZWF0ZSBhY3Rpb24gZm9yIHF1ZXJ5aW5nIE1JVExPQyB0YWJsZQ0KICAgIERCQWN0aW9uIGFjdGlvbk1JVExPQyA9IGRhdGFiYXNlLnRhYmxlKCJNSVRMT0MiKS5pbmRleCgiMTAiKS5tYXRjaGluZyhleHByZXNzaW9uKQ0KICAgICAgLnNlbGVjdGlvbigiTUxDT05PIiwgIk1MV0hMTyIsICJNTElUTk8iLCAiTUxCQU5PIiwgIk1MQ0FNVSIsICJNTFNUQVMiLCAiTUxTVFFUIiwgIk1MUkdEVCIpLmJ1aWxkKCkNCiAgICBEQkNvbnRhaW5lciBjb250YWluZXJNSVRMT0MgPSBhY3Rpb25NSVRMT0MuZ2V0Q29udGFpbmVyKCkNCg0KICAgIGNvbnRhaW5lck1JVExPQy5zZXRJbnQoIk1MQ09OTyIsIGlDT05PIGFzIGludCkNCg0KICAgIC8vIENsb3N1cmUgdG8gcHJvY2VzcyBhbGwgcmVjb3JkcyBmZXRjaGVkIGZyb20gTUlUTE9DDQogICAgQ2xvc3VyZTw/PiByZWFkQWxsUmVjb3Jkc01JVExPQyA9IHsNCiAgICAgIERCQ29udGFpbmVyIHJlc3VsdENvbnRhaW5lck1JVExPQyAtPg0KICAgICAgICBTdHJpbmcgSVROTyA9IHJlc3VsdENvbnRhaW5lck1JVExPQy5nZXRTdHJpbmcoIk1MSVROTyIpLnRyaW0oKQ0KICAgICAgICBTdHJpbmcgQkFOTyA9IHJlc3VsdENvbnRhaW5lck1JVExPQy5nZXRTdHJpbmcoIk1MQkFOTyIpLnRyaW0oKQ0KICAgICAgICBTdHJpbmcgQ0FNVSA9IHJlc3VsdENvbnRhaW5lck1JVExPQy5nZXRTdHJpbmcoIk1MQ0FNVSIpLnRyaW0oKQ0KICAgICAgICBTdHJpbmcgV0hMTyA9IHJlc3VsdENvbnRhaW5lck1JVExPQy5nZXRTdHJpbmcoIk1MV0hMTyIpLnRyaW0oKQ0KICAgICAgICANCiAgICAgICAgU3RyaW5nIFJJRE4gPSAiIg0KDQogICAgICAgIG1pLm91dERhdGEucHV0KCJXSExPIiwgcmVzdWx0Q29udGFpbmVyTUlUTE9DLmdldFN0cmluZygiTUxXSExPIikudHJpbSgpKQ0KICAgICAgICBtaS5vdXREYXRhLnB1dCgiSVROTyIsIElUTk8pDQogICAgICAgIG1pLm91dERhdGEucHV0KCJCQU5PIiwgQkFOTykNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNUQVMiLCByZXN1bHRDb250YWluZXJNSVRMT0MuZ2V0KCJNTFNUQVMiKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNUUVQiLCByZXN1bHRDb250YWluZXJNSVRMT0MuZ2V0KCJNTFNUUVQiKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgbWkub3V0RGF0YS5wdXQoIkNBTVUiLCByZXN1bHRDb250YWluZXJNSVRMT0MuZ2V0KCJNTENBTVUiKS50b1N0cmluZygpLnRyaW0oKSkNCg0KICAgICAgICAvLyBGaW5kIGNvcnJlc3BvbmRpbmcgcmVjb3JkIGluIE1JVE1BUyBsaXN0DQogICAgICAgIERCQ29udGFpbmVyIGNvbnRhaW5lck1JVE1BUyA9IG1pdG1hc0xpc3QuZmluZCB7DQogICAgICAgICAgaXQuZ2V0U3RyaW5nKCJNTUlUTk8iKSA9PSBJVE5PDQogICAgICAgIH0NCiAgICAgICAgaWYgKGNvbnRhaW5lck1JVE1BUyA9PSBudWxsKSB7DQogICAgICAgICAgREJBY3Rpb24gYWN0aW9uTUlUTUFTID0gZGF0YWJhc2UudGFibGUoIk1JVE1BUyIpLmluZGV4KCIzMCIpLnNlbGVjdGlvbigiTU1JVERTIiwgIk1NU1RBVCIpLmJ1aWxkKCkNCiAgICAgICAgICBjb250YWluZXJNSVRNQVMgPSBhY3Rpb25NSVRNQVMuZ2V0Q29udGFpbmVyKCkNCg0KICAgICAgICAgIGNvbnRhaW5lck1JVE1BUy5zZXQoIk1NQ09OTyIsIGlDT05PIGFzIGludCkNCiAgICAgICAgICBjb250YWluZXJNSVRNQVMuc2V0KCJNTUlUTk8iLCBJVE5PKQ0KDQogICAgICAgICAgaWYgKGFjdGlvbk1JVE1BUy5yZWFkKGNvbnRhaW5lck1JVE1BUykpIHsNCiAgICAgICAgICAgIG1pdG1hc0xpc3QuYWRkKGNvbnRhaW5lck1JVE1BUy5jcmVhdGVDb3B5KCkpDQoNCiAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJJVERTIiwgY29udGFpbmVyTUlUTUFTLmdldFN0cmluZygiTU1JVERTIikudHJpbSgpKQ0KICAgICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNUQVQiLCBjb250YWluZXJNSVRNQVMuZ2V0U3RyaW5nKCJNTVNUQVQiKS50cmltKCkpDQogICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJJVERTIiwgY29udGFpbmVyTUlUTUFTLmdldFN0cmluZygiTU1JVERTIikudHJpbSgpKQ0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJTVEFUIiwgY29udGFpbmVyTUlUTUFTLmdldFN0cmluZygiTU1TVEFUIikudHJpbSgpKQ0KICAgICAgICB9DQoNCiAgICAgICAgLy8gRmluZCBjb3JyZXNwb25kaW5nIHJlY29yZCBpbiBRTVNSUUggbGlzdA0KICAgICAgICBEQkNvbnRhaW5lciBjb250YWluZXJRTVNSUUggPSBxbXNycWhMaXN0LmZpbmQgew0KICAgICAgICAgIGl0LmdldFN0cmluZygiUkhJVE5PIikgPT0gSVROTyAmJiBpdC5nZXRTdHJpbmcoIlJIQkFOTyIpID09IEJBTk8NCiAgICAgICAgfQ0KICAgICAgICBpZiAoY29udGFpbmVyUU1TUlFIID09IG51bGwpIHsNCiAgICAgICAgICBEQkFjdGlvbiBhY3Rpb25RTVNSUUggPSBkYXRhYmFzZS50YWJsZSgiUU1TUlFIIikuaW5kZXgoIjMwIikuc2VsZWN0aW9uKCJSSFFTVEEiLCAiUkhRQVBSIiwgIlJIUVJJRCIpLmJ1aWxkKCkNCiAgICAgICAgICBjb250YWluZXJRTVNSUUggPSBhY3Rpb25RTVNSUUguZ2V0Q29udGFpbmVyKCkNCg0KICAgICAgICAgIGNvbnRhaW5lclFNU1JRSC5zZXQoIlJIQ09OTyIsIGlDT05PIGFzIGludCkNCiAgICAgICAgICBjb250YWluZXJRTVNSUUguc2V0KCJSSElUTk8iLCBJVE5PKQ0KICAgICAgICAgIGNvbnRhaW5lclFNU1JRSC5zZXQoIlJIQkFOTyIsIEJBTk8pDQoNCiAgICAgICAgICAvLyBDbG9zdXJlIHRvIHByb2Nlc3MgYWxsIHJlY29yZHMgZmV0Y2hlZCBmcm9tIFFNU1JRSA0KICAgICAgICAgIENsb3N1cmU8Pz4gcmVhZEFsbFJlY29yZFFNU1JRSCA9IHsNCiAgICAgICAgICAgIERCQ29udGFpbmVyIHJlc3VsdENvbnRhaW5lclFNU1JRSCAtPg0KICAgICAgICAgICAgICBxbXNycWhMaXN0LmFkZChyZXN1bHRDb250YWluZXJRTVNSUUguY3JlYXRlQ29weSgpKQ0KDQogICAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJRQVBSIiwgcmVzdWx0Q29udGFpbmVyUU1TUlFILmdldCgiUkhRQVBSIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJRUklEIiwgcmVzdWx0Q29udGFpbmVyUU1TUlFILmdldCgiUkhRUklEIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgfQ0KDQogICAgICAgICAgYWN0aW9uUU1TUlFILnJlYWRBbGwoY29udGFpbmVyUU1TUlFILCAzLCAxLCByZWFkQWxsUmVjb3JkUU1TUlFIKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJRQVBSIiwgY29udGFpbmVyUU1TUlFILmdldCgiUkhRQVBSIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlFSSUQiLCBjb250YWluZXJRTVNSUUguZ2V0KCJSSFFSSUQiKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEZpbmQgY29ycmVzcG9uZGluZyByZWNvcmQgaW4gTUlMT01BIGxpc3QNCiAgICAgICAgREJDb250YWluZXIgY29udGFpbmVyTUlMT01BID0gbWlsb21hTGlzdC5maW5kIHsNCiAgICAgICAgICBpdC5nZXRTdHJpbmcoIkxNSVROTyIpID09IElUTk8gJiYgaXQuZ2V0U3RyaW5nKCJMTUJBTk8iKSA9PSBCQU5PDQogICAgICAgIH0NCiAgICAgICAgaWYgKGNvbnRhaW5lck1JTE9NQSA9PSBudWxsKSB7DQogICAgICAgICAgREJBY3Rpb24gYWN0aW9uTUlMT01BID0gZGF0YWJhc2UudGFibGUoIk1JTE9NQSIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiTE1NRkRUIiwgIkxNUkVEQSIsICJMTUVYUEkiLCAiTE1TRURUIiwgIkxNU1VOTyIpLmJ1aWxkKCkNCiAgICAgICAgICBjb250YWluZXJNSUxPTUEgPSBhY3Rpb25NSUxPTUEuZ2V0Q29udGFpbmVyKCkNCg0KICAgICAgICAgIGNvbnRhaW5lck1JTE9NQS5zZXQoIkxNQ09OTyIsIGlDT05PIGFzIGludCkNCiAgICAgICAgICBjb250YWluZXJNSUxPTUEuc2V0KCJMTUlUTk8iLCBJVE5PKQ0KICAgICAgICAgIGNvbnRhaW5lck1JTE9NQS5zZXQoIkxNQkFOTyIsIEJBTk8pDQoNCiAgICAgICAgICBpZiAoYWN0aW9uTUlMT01BLnJlYWQoY29udGFpbmVyTUlMT01BKSkgew0KICAgICAgICAgICAgbWkub3V0RGF0YS5wdXQoIk1GRFQiLCBjb250YWluZXJNSUxPTUEuZ2V0KCJMTU1GRFQiKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJSRURBIiwgY29udGFpbmVyTUlMT01BLmdldCgiTE1SRURBIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiRVhQSSIsIGNvbnRhaW5lck1JTE9NQS5nZXQoIkxNRVhQSSIpLnRvU3RyaW5nKCkudHJpbSgpKQ0KICAgICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNFRFQiLCBjb250YWluZXJNSUxPTUEuZ2V0KCJMTVNFRFQiKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJTVU5PIiwgY29udGFpbmVyTUlMT01BLmdldCgiTE1TVU5PIikudG9TdHJpbmcoKS50cmltKCkpDQoNCiAgICAgICAgICAgIG1pbG9tYUxpc3QuYWRkKGNvbnRhaW5lck1JTE9NQS5jcmVhdGVDb3B5KCkpDQogICAgICAgICAgfQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJNRkRUIiwgY29udGFpbmVyTUlMT01BLmdldCgiTE1NRkRUIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlJFREEiLCBjb250YWluZXJNSUxPTUEuZ2V0KCJMTVJFREEiKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiRVhQSSIsIGNvbnRhaW5lck1JTE9NQS5nZXQoIkxNRVhQSSIpLnRvU3RyaW5nKCkudHJpbSgpKQ0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJTRURUIiwgY29udGFpbmVyTUlMT01BLmdldCgiTE1TRURUIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNVTk8iLCBjb250YWluZXJNSUxPTUEuZ2V0KCJMTVNVTk8iKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEZpbmQgY29ycmVzcG9uZGluZyByZWNvcmQgaW4gTUlUVFJBIGxpc3QNCiAgICAgICAgREJDb250YWluZXIgY29udGFpbmVyTUlUVFJBID0gbWl0dHJhTGlzdC5maW5kIHsNCiAgICAgICAgICBpdC5nZXRTdHJpbmcoIk1USVROTyIpID09IElUTk8gJiYgaXQuZ2V0U3RyaW5nKCJNVEJBTk8iKSA9PSBCQU5PICYmIGl0LmdldFN0cmluZygiTVRUVFlQIikgPT0gMjUNCiAgICAgICAgfQ0KICAgICAgICBpZiAoY29udGFpbmVyTUlUVFJBID09IG51bGwpIHsNCiAgICAgICAgICAvLyBDcmVhdGUgZXhwcmVzc2lvbiBmb3IgcXVlcnlpbmcgTUlUVFJBIHRhYmxlIHdpdGggQ0FNVSBjb25kaXRpb24NCiAgICAgICAgICBFeHByZXNzaW9uRmFjdG9yeSBtaXR0cmFFeHByZXNzaW9uID0gZGF0YWJhc2UuZ2V0RXhwcmVzc2lvbkZhY3RvcnkoIk1JVFRSQSIpDQogICAgICAgICAgbWl0dHJhRXhwcmVzc2lvbiA9IG1pdHRyYUV4cHJlc3Npb24uZXEoIk1UQ0FNVSIsIENBTVUpDQoNCiAgICAgICAgICBEQkFjdGlvbiBhY3Rpb25NSVRUUkEgPSBkYXRhYmFzZS50YWJsZSgiTUlUVFJBIikuaW5kZXgoIjIwIikubWF0Y2hpbmcobWl0dHJhRXhwcmVzc2lvbikNCiAgICAgICAgICAgIC5zZWxlY3Rpb24oIk1UUklETiIsICJNVFdITE8iKS5idWlsZCgpDQogICAgICAgICAgY29udGFpbmVyTUlUVFJBID0gYWN0aW9uTUlUVFJBLmdldENvbnRhaW5lcigpDQoNCiAgICAgICAgICBjb250YWluZXJNSVRUUkEuc2V0KCJNVENPTk8iLCBpQ09OTyBhcyBpbnQpDQogICAgICAgICAgY29udGFpbmVyTUlUVFJBLnNldCgiTVRJVE5PIiwgSVROTykNCiAgICAgICAgICBjb250YWluZXJNSVRUUkEuc2V0KCJNVEJBTk8iLCBCQU5PKQ0KICAgICAgICAgIGNvbnRhaW5lck1JVFRSQS5zZXQoIk1UVFRZUCIsIDI1KQ0KDQogICAgICAgICAgLy8gQ2xvc3VyZSB0byBwcm9jZXNzIGFsbCByZWNvcmRzIGZldGNoZWQgZnJvbSBNSVRUUkENCiAgICAgICAgICBDbG9zdXJlPD8+IHJlYWRBbGxSZWNvcmRNSVRUUkEgPSB7DQogICAgICAgICAgICBEQkNvbnRhaW5lciByZXN1bHRDb250YWluZXJNSVRUUkEgLT4NCiAgICAgICAgICAgICAgbWl0dHJhTGlzdC5hZGQocmVzdWx0Q29udGFpbmVyTUlUVFJBLmNyZWF0ZUNvcHkoKSkNCg0KICAgICAgICAgICAgICBSSUROID0gcmVzdWx0Q29udGFpbmVyTUlUVFJBLmdldCgiTVRSSUROIikudG9TdHJpbmcoKS50cmltKCkNCg0KICAgICAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiUklETiIsIFJJRE4pDQogICAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJUUkRUIiwgcmVzdWx0Q29udGFpbmVyTUlUVFJBLmdldCgiTVRUUkRUIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgfQ0KDQogICAgICAgICAgYWN0aW9uTUlUVFJBLnJlYWRBbGwoY29udGFpbmVyTUlUVFJBLCA0LCAxLCByZWFkQWxsUmVjb3JkTUlUVFJBKQ0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJSSUROIiwgY29udGFpbmVyTUlUVFJBLmdldCgiTVRSSUROIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlRSRFQiLCBjb250YWluZXJNSVRUUkEuZ2V0KCJNVFRSRFQiKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEFkZGl0aW9uYWwgcHJvY2Vzc2luZyBpZiBSSUROIGlzIG5vdCBlbXB0eQ0KICAgICAgICBpZiAoIVJJRE4uaXNFbXB0eSgpKSB7DQogICAgICAgICAgY29udGFpbmVyUU1TUlFIID0gcW1zcnFoTGlzdDEuZmluZCB7DQogICAgICAgICAgICBpdC5nZXRTdHJpbmcoIlJISVROTyIpID09IElUTk8gJiYgaXQuZ2V0U3RyaW5nKCJSSEJBTk8iKSA9PSBCQU5PICYmIGl0LmdldCgiUkhST1JDIikudG9TdHJpbmcoKSA9PSAiMiIgJiYgaXQuZ2V0U3RyaW5nKCJSSFJPUk4iKSA9PSBSSURODQogICAgICAgICAgfQ0KICAgICAgICAgIGlmIChjb250YWluZXJRTVNSUUggPT0gbnVsbCkgew0KICAgICAgICAgICAgREJBY3Rpb24gYWN0aW9uUU1TUlFIID0gZGF0YWJhc2UudGFibGUoIlFNU1JRSCIpLmluZGV4KCIzMCIpLnNlbGVjdGlvbigiUkhRU1RBIiwgIlJIUUFQUiIsICJSSFFSSUQiKS5yZXZlcnNlKCkuYnVpbGQoKQ0KICAgICAgICAgICAgY29udGFpbmVyUU1TUlFIID0gYWN0aW9uUU1TUlFILmdldENvbnRhaW5lcigpDQoNCiAgICAgICAgICAgIGNvbnRhaW5lclFNU1JRSC5zZXQoIlJIQ09OTyIsIGlDT05PIGFzIGludCkNCiAgICAgICAgICAgIGNvbnRhaW5lclFNU1JRSC5zZXQoIlJISVROTyIsIElUTk8pDQogICAgICAgICAgICBjb250YWluZXJRTVNSUUguc2V0KCJSSEJBTk8iLCBCQU5PKQ0KICAgICAgICAgICAgY29udGFpbmVyUU1TUlFILnNldCgiUkhST1JDIiwgMikNCiAgICAgICAgICAgIGNvbnRhaW5lclFNU1JRSC5zZXQoIlJIUk9STiIsIFJJRE4pDQoNCiAgICAgICAgICAgIC8vIENsb3N1cmUgdG8gcHJvY2VzcyBhbGwgcmVjb3JkcyBmZXRjaGVkIGZyb20gUU1TUlFIMQ0KICAgICAgICAgICAgQ2xvc3VyZTw/PiByZWFkQWxsUmVjb3JkUU1TUlFIMSA9IHsNCiAgICAgICAgICAgICAgREJDb250YWluZXIgcmVzdWx0Q29udGFpbmVyUU1TUlFIMSAtPg0KICAgICAgICAgICAgICAgIHFtc3JxaExpc3QxLmFkZChyZXN1bHRDb250YWluZXJRTVNSUUgxLmNyZWF0ZUNvcHkoKSkNCg0KICAgICAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJRQVAxIiwgcmVzdWx0Q29udGFpbmVyUU1TUlFIMS5nZXQoIlJIUUFQUiIpLnRvU3RyaW5nKCkudHJpbSgpKQ0KICAgICAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJRUkkxIiwgcmVzdWx0Q29udGFpbmVyUU1TUlFIMS5nZXQoIlJIUVJJRCIpLnRvU3RyaW5nKCkudHJpbSgpKQ0KICAgICAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJRU1QxIiwgcmVzdWx0Q29udGFpbmVyUU1TUlFIMS5nZXQoIlJIUVNUQSIpLnRvU3RyaW5nKCkudHJpbSgpKQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBhY3Rpb25RTVNSUUgucmVhZEFsbChjb250YWluZXJRTVNSUUgsIDUsIDEsIHJlYWRBbGxSZWNvcmRRTVNSUUgxKQ0KICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiUUFQMSIsIGNvbnRhaW5lclFNU1JRSC5nZXQoIlJIUUFQUiIpLnRvU3RyaW5nKCkudHJpbSgpKQ0KICAgICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlFSSTEiLCBjb250YWluZXJRTVNSUUguZ2V0KCJSSFFSSUQiKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJRU1QxIiwgY29udGFpbmVyUU1TUlFILmdldCgiUkhRU1RBIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgfQ0KDQogICAgICAgICAgLy8gRmluZCBjb3JyZXNwb25kaW5nIHJlY29yZCBpbiBNUEhFQUQgbGlzdA0KICAgICAgICAgIERCQ29udGFpbmVyIGNvbnRhaW5lck1QSEVBRCA9IG1waGVhZExpc3QuZmluZCB7DQogICAgICAgICAgICBpdC5nZXRTdHJpbmcoIklBUFVOTyIpID09IFJJRE4NCiAgICAgICAgICB9DQogICAgICAgICAgaWYgKGNvbnRhaW5lck1QSEVBRCA9PSBudWxsKSB7DQogICAgICAgICAgICBEQkFjdGlvbiBhY3Rpb25NUEhFQUQgPSBkYXRhYmFzZS50YWJsZSgiTVBIRUFEIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJJQVNVTk8iKS5idWlsZCgpDQogICAgICAgICAgICBjb250YWluZXJNUEhFQUQgPSBhY3Rpb25NUEhFQUQuZ2V0Q29udGFpbmVyKCkNCg0KICAgICAgICAgICAgY29udGFpbmVyTVBIRUFELnNldCgiSUFDT05PIiwgaUNPTk8gYXMgaW50KQ0KICAgICAgICAgICAgY29udGFpbmVyTVBIRUFELnNldCgiSUFQVU5PIiwgUklETikNCg0KICAgICAgICAgICAgaWYgKGFjdGlvbk1QSEVBRC5yZWFkKGNvbnRhaW5lck1QSEVBRCkpIHsNCiAgICAgICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNVTjEiLCBjb250YWluZXJNUEhFQUQuZ2V0KCJJQVNVTk8iKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNVTjEiLCBjb250YWluZXJNUEhFQUQuZ2V0KCJJQVNVTk8iKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICAvLyBXcml0ZSB0byBtaS5vdXREYXRhDQogICAgICAgIG1pLndyaXRlKCkNCiAgICB9DQoNCiAgICAvLyBSZWFkIGFsbCByZWNvcmRzIGZyb20gTUlUTE9DIHRhYmxlDQogICAgYWN0aW9uTUlUTE9DLnJlYWRBbGwoY29udGFpbmVyTUlUTE9DLCAxLCAxMDAwLCByZWFkQWxsUmVjb3Jkc01JVExPQykNCiAgfQ0KfQ0K"}}}