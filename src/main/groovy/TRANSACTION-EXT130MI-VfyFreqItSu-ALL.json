{"programModules":{"EXT130MI":{"program":"EXT130MI","triggers":{},"transactions":{"VfyFreqItSu":{"sourceUuid":"bf92f835-d7f6-4c9e-b8a1-9ac5a2418bde","name":"VfyFreqItSu","program":"EXT130MI","description":"QMS Multi Test and Test Frequency","active":true,"multi":false,"modified":1677049281525,"modifiedBy":"900073","outputFields":[{"name":"CONF","description":"New Record","length":1,"mandatory":false,"type":"A"},{"name":"TRMN","description":"Tests Remaining","length":3,"mandatory":false,"type":"N"},{"name":"NBTR","description":"Number of Base Tests Required","length":2,"mandatory":false,"type":"N"},{"name":"QAPR","description":"QI Status","length":1,"mandatory":false,"type":"A"},{"name":"PUNO","description":"PO number","length":10,"mandatory":false,"type":"A"},{"name":"QRID","description":"QI Request ID","length":8,"mandatory":false,"type":"A"},{"name":"SPEC","description":"Specification","length":20,"mandatory":false,"type":"A"},{"name":"NBTO","description":"Number of Base Tests Required - Original","length":2,"mandatory":false,"type":"N"},{"name":"QTST","description":"Test Code","length":10,"mandatory":false,"type":"A"},{"name":"TSTT","description":"Test Status - First","length":1,"mandatory":false,"type":"N"},{"name":"LTST","description":"Test Status - Last","length":1,"mandatory":false,"type":"N"},{"name":"QTRS","description":"Test Result Quant - First","length":17,"mandatory":false,"type":"N"},{"name":"LQTR","description":"Test Result Quant - Last","length":17,"mandatory":false,"type":"N"},{"name":"QLC2","description":"Test Result Qual - First","length":10,"mandatory":false,"type":"A"},{"name":"LQLC","description":"Test Result Qual - First","length":10,"mandatory":false,"type":"A"},{"name":"CHID","description":"Changed by - first","length":10,"mandatory":false,"type":"A"},{"name":"LCHI","description":"Changed by - last","length":10,"mandatory":false,"type":"A"}],"inputFields":[{"name":"CONO","description":"Company","length":3,"mandatory":true,"type":"N"},{"name":"SUNO","description":"Supplier","length":10,"mandatory":true,"type":"A"},{"name":"ITNO","description":"Item Number","length":15,"mandatory":true,"type":"A"},{"name":"QTST","description":"Test Code","length":10,"mandatory":false,"type":"A"},{"name":"BANO","description":"Lot Number","length":20,"mandatory":false,"type":"A"},{"name":"TTPE","description":"Type(V=Verify, X=Execute, H=History)","length":1,"mandatory":false,"type":"A"},{"name":"SCST","description":"Successful Test (Y/N)","length":1,"mandatory":false,"type":"A"},{"name":"QAPR","description":"QI Status","length":1,"mandatory":false,"type":"A"},{"name":"PUNO","description":"PO Number","length":10,"mandatory":false,"type":"A"},{"name":"SPEC","description":"Specification","length":20,"mandatory":false,"type":"A"}],"utilities":[],"market":"ALL"}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"bf92f835-d7f6-4c9e-b8a1-9ac5a2418bde":{"uuid":"bf92f835-d7f6-4c9e-b8a1-9ac5a2418bde","updated":1677035330030,"updatedBy":"900107","created":1677049268522,"createdBy":"900073","apiVersion":"UNKNOWN","beVersion":"16.0.0.20221210044646.7","language":"GROOVY","codeHash":"8797555A1BE594113252ADA211B4CD5B55226AF9A3B07C2D6E7D1DCED527106D","code":"aW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGUNCmltcG9ydCBqYXZhLnRpbWUuZm9ybWF0LkRhdGVUaW1lRm9ybWF0dGVyDQoNCi8qKg0KICogUkVBRE1FDQogKiBWZXJpZnkgU3VwcGxpZXIvSXRlbSBUZXN0IEZyZXF1ZW5jeQ0KICoNCiAqIE5hbWU6IEVYVDEzME1JLlZmeUZyZXFJdFN1DQogKiBEZXNjcmlwdGlvbjogVmVyaWZ5IFN1cHBsaWVyL0l0ZW0gVGVzdCBGcmVxdWVuY3kNCiAqIERhdGUJICAgICAgQ2hhbmdlZCBCeSAgICAgICAgICAgIERlc2NyaXB0aW9uDQogKiAyMDIyMTIwMwkgIFZJRFZFTiAgICAgICAgVmVyaWZ5IFN1cHBsaWVyL0l0ZW0gVGVzdCBGcmVxdWVuY3kNCiAqKi8NCg0KcHVibGljIGNsYXNzIFZmeUZyZXFJdFN1IGV4dGVuZHMgRXh0ZW5kTTNUcmFuc2FjdGlvbiB7DQogIHByaXZhdGUgZmluYWwgTUlBUEkgbWkNCiAgcHJpdmF0ZSBmaW5hbCBEYXRhYmFzZUFQSSBkYXRhYmFzZQ0KICBwcml2YXRlIGZpbmFsIExvZ2dlckFQSSBsb2dnZXINCiAgcHJpdmF0ZSBmaW5hbCBQcm9ncmFtQVBJIHByb2dyYW0NCiAgcHJpdmF0ZSBmaW5hbCBVdGlsaXR5QVBJIHV0aWxpdHkNCg0KICAvL0lucHV0IGZpZWxkcw0KICBwcml2YXRlIFN0cmluZyBpQ09OTywgaVNVTk8sIGlJVE5PLCBpUVRTVCwgaUJBTk8sIGlUVFBFLCBpU0NTVCwgaVFBUFIsIGlQVU5PLCBpU1BFQw0KICBwcml2YXRlIFN0cmluZyBiYXNlUVRTVA0KICBwcml2YXRlIFN0cmluZyBNSVRWRVFfVE9TUA0KICBwcml2YXRlIFN0cmluZyBNSVRWRVFfSVROTw0KICBwcml2YXRlIFN0cmluZyBNSVRWRVFfU1VOTw0KICBwcml2YXRlIFN0cmluZyBFWFQyMDFfUUlUTA0KICBwcml2YXRlIFN0cmluZyBFWFQyMDFfUUFQUg0KICBwcml2YXRlIFN0cmluZyBFWFQyMDFfUVRTVA0KICBwcml2YXRlIFN0cmluZyBRTVNSUUhfUk9STg0KICBwcml2YXRlIFN0cmluZyBRTVNSUUhfUVJJRA0KICBwcml2YXRlIFN0cmluZyBDU1lUQUJfUEFSTQ0KICBwcml2YXRlIGludCBmaXJzdFRpbWUNCg0KICBwcml2YXRlIERCQ29udGFpbmVyIE1JVE1BUywgTUlUVkVRLCBNSUxPTUEsIEVYVDIwMSwgRVhUMjAyLCBRTVNSUUgsIFFNU1JRVA0KDQogIHB1YmxpYyBWZnlGcmVxSXRTdShNSUFQSSBtaSwgRGF0YWJhc2VBUEkgZGF0YWJhc2UsIExvZ2dlckFQSSBsb2dnZXIsIFByb2dyYW1BUEkgcHJvZ3JhbSwgVXRpbGl0eUFQSSB1dGlsaXR5KSB7DQogICAgdGhpcy5taSA9IG1pDQogICAgdGhpcy5kYXRhYmFzZSA9IGRhdGFiYXNlDQogICAgdGhpcy5sb2dnZXIgPSBsb2dnZXINCiAgICB0aGlzLnByb2dyYW0gPSBwcm9ncmFtDQogICAgdGhpcy51dGlsaXR5ID0gdXRpbGl0eQ0KICB9DQoNCiAgLyoqDQogICAqIE1haW4gbWV0aG9kDQogICAqIEBwYXJhbQ0KICAgKiBAcmV0dXJuDQogICAqLw0KICBwdWJsaWMgdm9pZCBtYWluKCkgew0KDQogICAgaUNPTk8gPSBtaS5pbkRhdGEuZ2V0KCJDT05PIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJDT05PIikudG9TdHJpbmcoKS50cmltKCkgPT0gIiIgPyBwcm9ncmFtLkxEQVpELkNPTk8udG9TdHJpbmcoKSA6IG1pLmluRGF0YS5nZXQoIkNPTk8iKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlTVU5PID0gbWkuaW5EYXRhLmdldCgiU1VOTyIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlNVTk8iKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlJVE5PID0gbWkuaW5EYXRhLmdldCgiSVROTyIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiSVROTyIpLnRvU3RyaW5nKCkudHJpbSgpID09ICI/IiA/ICIiIDogbWkuaW5EYXRhLmdldCgiSVROTyIpLnRvU3RyaW5nKCkudHJpbSgpDQogICAgaVFUU1QgPSBtaS5pbkRhdGEuZ2V0KCJRVFNUIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJRVFNUIikudG9TdHJpbmcoKS50cmltKCkgPT0gIj8iID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJRVFNUIikudG9TdHJpbmcoKS50cmltKCkNCiAgICBpQkFOTyA9IG1pLmluRGF0YS5nZXQoIkJBTk8iKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIkJBTk8iKS50b1N0cmluZygpLnRyaW0oKSA9PSAiPyIgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkJBTk8iKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlUVFBFID0gbWkuaW5EYXRhLmdldCgiVFRQRSIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiVFRQRSIpLnRvU3RyaW5nKCkudHJpbSgpID09ICI/IiA/ICIiIDogbWkuaW5EYXRhLmdldCgiVFRQRSIpLnRvU3RyaW5nKCkudHJpbSgpDQogICAgaVNDU1QgPSBtaS5pbkRhdGEuZ2V0KCJTQ1NUIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJTQ1NUIikudG9TdHJpbmcoKS50cmltKCkgPT0gIj8iID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJTQ1NUIikudG9TdHJpbmcoKS50cmltKCkNCiAgICBpUUFQUiA9IG1pLmluRGF0YS5nZXQoIlFBUFIiKSA9PSBudWxsIHx8IG1pLmluRGF0YS5nZXQoIlFBUFIiKS50b1N0cmluZygpLnRyaW0oKSA9PSAiPyIgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlFBUFIiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlQVU5PID0gbWkuaW5EYXRhLmdldCgiUFVOTyIpID09IG51bGwgfHwgbWkuaW5EYXRhLmdldCgiUFVOTyIpLnRvU3RyaW5nKCkudHJpbSgpID09ICI/IiA/ICIiIDogbWkuaW5EYXRhLmdldCgiUFVOTyIpLnRvU3RyaW5nKCkudHJpbSgpDQogICAgaVNQRUMgPSBtaS5pbkRhdGEuZ2V0KCJTUEVDIikgPT0gbnVsbCB8fCBtaS5pbkRhdGEuZ2V0KCJTUEVDIikudG9TdHJpbmcoKS50cmltKCkgPT0gIj8iID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJTUEVDIikudG9TdHJpbmcoKS50cmltKCkNCg0KICAgIERCQWN0aW9uIGRiRVhUMjAxID0gZGF0YWJhc2UudGFibGUoIkVYVDIwMSIpLmluZGV4KCIwMCIpLnNlbGVjdEFsbEZpZWxkcygpLmJ1aWxkKCkNCiAgICBFWFQyMDEgPSBkYkVYVDIwMS5nZXRDb250YWluZXIoKQ0KDQogICAgREJBY3Rpb24gZGJFWFQyMDIgPSBkYXRhYmFzZS50YWJsZSgiRVhUMjAyIikuaW5kZXgoIjAwIikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKQ0KICAgIEVYVDIwMiA9IGRiRVhUMjAyLmdldENvbnRhaW5lcigpDQoNCiAgICBEQkFjdGlvbiBkYlFNU1JRSCA9IGRhdGFiYXNlLnRhYmxlKCJRTVNSUUgiKS5pbmRleCgiMDAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQogICAgUU1TUlFIID0gZGJRTVNSUUguZ2V0Q29udGFpbmVyKCkNCg0KICAgIERCQWN0aW9uIGRiUU1TUlFUID0gZGF0YWJhc2UudGFibGUoIlFNU1JRVCIpLmluZGV4KCIwMCIpLnNlbGVjdEFsbEZpZWxkcygpLmJ1aWxkKCkNCiAgICBRTVNSUVQgPSBkYlFNU1JRVC5nZXRDb250YWluZXIoKQ0KDQogICAgbG9nZ2VyLmRlYnVnKCJJbnB1dHM6IGlDT05POiAiICsgaUNPTk8udG9TdHJpbmcoKS50cmltKCkgKyAiIC0tIGlTVU5POiAiICsgaVNVTk8udG9TdHJpbmcoKS50cmltKCkgKyAiIC0tIGlJVE5POiAiICsgaUlUTk8udG9TdHJpbmcoKS50cmltKCkgKyAiIC0tIGlRVFNUOiAiICsgaVFUU1QudG9TdHJpbmcoKS50cmltKCkgKyAiIC0tIGlCQU5POiAiICsgaUJBTk8udG9TdHJpbmcoKS50cmltKCkgKyAiIC0tIGlUVFBFOiAiICsgaVRUUEUudG9TdHJpbmcoKS50cmltKCkgKyAiIC0taVNDU1Q6ICIgKyBpU0NTVC50b1N0cmluZygpLnRyaW0oKSArICIgLS0gaVFBUFI6ICIgKyBpUUFQUi50b1N0cmluZygpLnRyaW0oKSArICIgLS0gaVBVTk86ICIgKyBpUFVOTy50b1N0cmluZygpLnRyaW0oKSArICIgLS1pU1BFQzogIiArIGlTUEVDLnRvU3RyaW5nKCkudHJpbSgpKQ0KDQogICAgaWYgKHZhbGlkYXRlSW5wdXRzKGlDT05PLCBpSVROTywgaVNVTk8sIGlCQU5PLCBpVFRQRSkpIHsNCiAgICAgIGxvZ2dlci5kZWJ1ZygiSW5wdXRzIHZhbGlkIC0gQmFjayB0byBtYWluIikNCiAgICAgIGJhc2VRVFNUID0gZ2V0QmFzZVFUU1QoaVFUU1QudHJpbSgpKTsNCiAgICAgIGxvZ2dlci5kZWJ1ZygiQmFzZVFUU1QgLSAiICsgYmFzZVFUU1QpDQogICAgICBsb2dnZXIuZGVidWcoIk9uIHRvIFNhbXBsaW5nIEZyZXF1ZW5jeSB3aXRoIENZU1RBQl9TVEtZIC0gIiArIE1JVFZFUV9UT1NQLnRyaW0oKSkNCiAgICAgIGlmIChnZXRTYW1wbGluZ0ZyZXF1ZW5jeSgpKSB7DQogICAgICAgIGxvZ2dlci5kZWJ1ZygicmV0dXJuZWQgZnJvbSBTYW1wbGluZyBmcmVxdWVjeSAtIENTWVRBQl9QQVJNIC0gIiArIENTWVRBQl9QQVJNLnRyaW0oKSkNCiAgICAgICAgZmlyc3RUaW1lID0gY2hrSWZGaXJzdEl0ZW1TdXBwUmVjKCkNCiAgICAgICAgZ2V0UUFQUigpDQogICAgICAgIGxvZ2dlci5kZWJ1ZygiQ2hlY2tpbmcgaWYgRmlyc3QgVGltZTogIiArIGZpcnN0VGltZS50b1N0cmluZygpKQ0KICAgICAgICBpZiAoaVRUUEUudHJpbSgpID09ICJYIikgew0KICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiVFRQRTogWCAtIENhbGxpbmcgYWRkdXBkSXRTdVJlYyIpDQogICAgICAgICAgYWRkdXBkSXRTdVJlYygpDQogICAgICAgIH0NCiAgICAgICAgaWYgKGlUVFBFLnRyaW0oKSA9PSAiViIgfHwgaVRUUEUudHJpbSgpID09ICJIIikgew0KICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiVFRQRTogViBvciBIIC0gIiArIGlUVFBFKQ0KICAgICAgICAgIGlmIChmaXJzdFRpbWUgPT0gJzEnKSB7DQogICAgICAgICAgICBpZiAoaVFUU1QudHJpbSgpLmlzRW1wdHkoKSkgew0KICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoIkZpcnN0IHRpbWUgYW5kIFFUU1QgaXMgZW1wdHkgLSBzZXQgUUlUTCIpDQogICAgICAgICAgICAgIEVYVDIwMS5zZXQoIkVYUUlUTCIsIFN0cmluZy5mb3JtYXQoIiUyMDBzIiwgQ1NZVEFCX1BBUk0pLnN1YnN0cmluZygwLCAyKSkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgaWYgKCFpUVRTVC50cmltKCkuaXNFbXB0eSgpICYmIGlTQ1NULnRyaW0oKSA9PSAiTiIpIHsNCiAgICAgICAgICAgICAgRVhUMjAxLnNldCgiRVhRSVRMIiwgU3RyaW5nLmZvcm1hdCgiJTIwMHMiLCBDU1lUQUJfUEFSTSkuc3Vic3RyaW5nKDE1LCAxNykpDQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIFN0cmluZyBTUE5QMzQgPSBTdHJpbmcuZm9ybWF0KCIlMjAwcyIsIENTWVRBQl9QQVJNKS5zdWJzdHJpbmcoNCwgNikNCiAgICAgICAgbG9nZ2VyLmRlYnVnKCJTUE5QMzQgYXQgMTAwLSAiICsgU1BOUDM0KQ0KICAgICAgICBpZiAoKEludGVnZXIucGFyc2VJbnQoU1BOUDM0KSA+IDApICYmIEVYVDIwMS5nZXQoIkVYUVRTVCIpLnRvU3RyaW5nKCkuY29udGFpbnMoIi0iKSkgew0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJOQlRSIiwgU1BOUDM0LnRyaW0oKSkNCiAgICAgICAgICBsb2dnZXIuZGVidWcoIiAtLU5CVFI6ICIgKyBTUE5QMzQudHJpbSgpKQ0KICAgICAgICB9DQogICAgICAgIGlmIChpVFRQRS50cmltKCkgPT0gIkgiICYmICFpUVRTVC50cmltKCkuaXNFbXB0eSgpKSB7DQogICAgICAgICAgbG9nZ2VyLmRlYnVnKCJUVFBFIGlzIEggLSBHZXR0aW5nIEhpc3RvcnkiKQ0KICAgICAgICAgIGdldEhpc3RvcnkoKQ0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJQVU5PIiwgUU1TUlFILmdldCgiUkhST1JOIikudG9TdHJpbmcoKSkNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiUVJJRCIsIEVYVDIwMi5nZXQoIkVYUVJJRCIpLnRvU3RyaW5nKCkpDQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNQRUMiLCBFWFQyMDIuZ2V0KCJFWFNQRUMiKS50b1N0cmluZygpKQ0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJOQlRPIiwgRVhUMjAxLmdldCgiRVhRSVRMIikudG9TdHJpbmcoKSkNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiUVRTVCIsIEVYVDIwMi5nZXQoIkVYUVRTVCIpLnRvU3RyaW5nKCkpDQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlRTVFQiLCBFWFQyMDIuZ2V0KCJFWFRTVFQiKS50b1N0cmluZygpKQ0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJMVFNUIiwgRVhUMjAyLmdldCgiRVhMVFNUIikudG9TdHJpbmcoKSkNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiUVRSUyIsIEVYVDIwMi5nZXQoIkVYUVRSUyIpLnRvU3RyaW5nKCkpDQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIkxRVFIiLCBFWFQyMDIuZ2V0KCJFWExRVFIiKS50b1N0cmluZygpKQ0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJRTEMyIiwgRVhUMjAyLmdldCgiRVhRTEMyIikudG9TdHJpbmcoKSkNCiAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiTFFMQyIsIEVYVDIwMi5nZXQoIkVYTFFMQyIpLnRvU3RyaW5nKCkpDQogICAgICAgICAgbWkub3V0RGF0YS5wdXQoIkNISUQiLCBFWFQyMDIuZ2V0KCJFWENISUQiKS50b1N0cmluZygpKQ0KICAgICAgICAgIG1pLm91dERhdGEucHV0KCJMQ0hJIiwgRVhUMjAyLmdldCgiRVhMQ0hJIikudG9TdHJpbmcoKSkNCiAgICAgICAgfQ0KICAgICAgICBtaS5vdXREYXRhLnB1dCgiQ09ORiIsIGZpcnN0VGltZS50b1N0cmluZygpKQ0KICAgICAgICBtaS5vdXREYXRhLnB1dCgiVFJNTiIsIEVYVDIwMS5nZXQoIkVYUUlUTCIpLnRvU3RyaW5nKCkpDQogICAgICAgIG1pLm91dERhdGEucHV0KCJRQVBSIiwgRVhUMjAxLmdldCgiRVhRQVBSIikudG9TdHJpbmcoKSkNCiAgICAgICAgbWkud3JpdGUoKQ0KDQogICAgICAgIGxvZ2dlci5kZWJ1ZygiT3V0cHV0czogQ09ORjogIiArIGZpcnN0VGltZS50b1N0cmluZygpICsNCiAgICAgICAgICAiIC0tVFJNTjogIiArIEVYVDIwMS5nZXQoIkVYUUlUTCIpLnRvU3RyaW5nKCkgKw0KICAgICAgICAgICIgLS1RQVBSOiAiICsgRVhUMjAxLmdldCgiRVhRQVBSIikudG9TdHJpbmcoKSArDQogICAgICAgICAgIiAtLSBQVU5POiAiICsgUU1TUlFILmdldCgiUkhST1JOIikudG9TdHJpbmcoKSArDQogICAgICAgICAgIiAtLSBRUklEOiAiICsgRVhUMjAyLmdldCgiRVhRUklEIikudG9TdHJpbmcoKSArDQogICAgICAgICAgIiAtLSBTUEVDOiAiICsgRVhUMjAyLmdldCgiRVhTUEVDIikudG9TdHJpbmcoKSArDQogICAgICAgICAgIiAtLSBOQlRPOiAiICsgRVhUMjAxLmdldCgiRVhRSVRMIikudG9TdHJpbmcoKSArDQogICAgICAgICAgIiAtLSBRVFNUOiAiICsgRVhUMjAyLmdldCgiRVhRVFNUIikudG9TdHJpbmcoKSArDQogICAgICAgICAgIiAtLVRTVFQ6ICIgKyBFWFQyMDIuZ2V0KCJFWFRTVFQiKS50b1N0cmluZygpICsNCiAgICAgICAgICAiIC0tIExUU1Q6ICIgKyBFWFQyMDIuZ2V0KCJFWExUU1QiKS50b1N0cmluZygpICsNCiAgICAgICAgICAiIC0tIFFUUlM6ICIgKyBFWFQyMDIuZ2V0KCJFWFFUUlMiKS50b1N0cmluZygpICsNCiAgICAgICAgICAiIC0tTFFUUjogIiArIEVYVDIwMi5nZXQoIkVYTFFUUiIpLnRvU3RyaW5nKCkgKw0KICAgICAgICAgICIgLS1RTEMyOiAiICsgRVhUMjAyLmdldCgiRVhRTEMyIikudG9TdHJpbmcoKSArDQogICAgICAgICAgIiAtLUxRTEM6ICIgKyBFWFQyMDIuZ2V0KCJFWExRTEMiKS50b1N0cmluZygpICsNCiAgICAgICAgICAiIC0tQ0hJRDogIiArIEVYVDIwMi5nZXQoIkVYQ0hJRCIpLnRvU3RyaW5nKCkgKw0KICAgICAgICAgICIgLS1MQ0hJOiAiICsgRVhUMjAyLmdldCgiRVhMQ0hJIikudG9TdHJpbmcoKSkNCiAgICAgIH0NCiAgICB9DQogIH0NCi8qKg0KICoNCiAqIEBwYXJhbSBpbkNPTk8NCiAqIEBwYXJhbSBpbklUTk8NCiAqIEBwYXJhbSBpblNVTk8NCiAqIEBwYXJhbSBpbkJBTk8NCiAqIEBwYXJhbSBpblRUUEUNCiAqIEByZXR1cm4gdHJ1ZSBpZiBpbnB1dHMgYXJlIHZhbGlkDQogKi8NCiAgcHJpdmF0ZSBib29sZWFuIHZhbGlkYXRlSW5wdXRzKFN0cmluZyBpbkNPTk8sIFN0cmluZyBpbklUTk8sIFN0cmluZyBpblNVTk8sIFN0cmluZyBpbkJBTk8sIFN0cmluZyBpblRUUEUpIHsNCg0KICAgIGlmICghKGluVFRQRS50cmltKCkuZXF1YWxzKCJWIikgfHwgaW5UVFBFLnRyaW0oKS5lcXVhbHMoIlgiKSB8fCBpblRUUEUudHJpbSgpLmVxdWFscygiSCIpKSkgew0KICAgICAgbWkuZXJyb3IoIlRUUEU6QWxsb3dlZCB2YWx1ZXMgLSAnVicsJ1gnLCdIJyIpDQogICAgICByZXR1cm4gZmFsc2UNCiAgICB9IGVsc2Ugew0KICAgICAgREJBY3Rpb24gZGJNSVRNQVMgPSBkYXRhYmFzZS50YWJsZSgiTUlUTUFTIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJNTUNPTk8iLCAiTU1JVE5PIikuYnVpbGQoKQ0KICAgICAgTUlUTUFTID0gZGJNSVRNQVMuZ2V0Q29udGFpbmVyKCkNCiAgICAgIE1JVE1BUy5zZXQoIk1NQ09OTyIsIGluQ09OTy50b0ludGVnZXIoKSkNCiAgICAgIE1JVE1BUy5zZXQoIk1NSVROTyIsIGluSVROTykNCiAgICAgIGlmICghZGJNSVRNQVMucmVhZChNSVRNQVMpKSB7DQogICAgICAgIG1pLmVycm9yKCJJdGVtIGRvZXMgbm90IGV4aXN0IikNCiAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICB9IGVsc2Ugew0KICAgICAgICBEQkFjdGlvbiBkYk1JVFZFUSA9IGRhdGFiYXNlLnRhYmxlKCJNSVRWRVEiKS5pbmRleCgiMDAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQogICAgICAgIE1JVFZFUSA9IGRiTUlUVkVRLmdldENvbnRhaW5lcigpDQogICAgICAgIE1JVFZFUS5zZXQoIklGQ09OTyIsIGluQ09OTy50b0ludGVnZXIoKSkNCiAgICAgICAgTUlUVkVRLnNldCgiSUZJVE5PIiwgaW5JVE5PLnRyaW0oKSkNCiAgICAgICAgTUlUVkVRLnNldCgiSUZTVU5PIiwgaW5TVU5PLnRyaW0oKSkNCiAgICAgICAgLyoqDQogICAgICAgICAqIENsb3N1cmUgdG8gcmVhZCBNSVRWRVEqLw0KICAgICAgICBDbG9zdXJlPD8+IENhbGxCYWNrX01JVFZFUSA9IHsgREJDb250YWluZXIgcmVzdWx0Q29udGFpbmVyIC0+DQogICAgICAgICAgTUlUVkVRID0gcmVzdWx0Q29udGFpbmVyDQogICAgICAgICAgTUlUVkVRX1RPU1AgPSByZXN1bHRDb250YWluZXIuZ2V0KCJJRlRPU1AiKS50b1N0cmluZygpDQogICAgICAgICAgTUlUVkVRX0lUTk8gPSByZXN1bHRDb250YWluZXIuZ2V0KCJJRklUTk8iKS50b1N0cmluZygpDQogICAgICAgICAgTUlUVkVRX1NVTk8gPSByZXN1bHRDb250YWluZXIuZ2V0KCJJRlNVTk8iKS50b1N0cmluZygpDQogICAgICAgICAgbG9nZ2VyLmRlYnVnKCJJdGVtL1NVTk8gdmFsaWQgLSBHZXQgVE9TUCBmb3IgQ1lTVEFCIC0gIiArIE1JVFZFUV9UT1NQLnRyaW0oKSkNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWRiTUlUVkVRLnJlYWRBbGwoTUlUVkVRLDUsIDEsIENhbGxCYWNrX01JVFZFUSkpIHsNCiAgICAgICAgICBtaS5lcnJvcigiSXRlbS9TdXBwbGllciBkb2VzIG5vdCBleGlzdCIpDQogICAgICAgICAgcmV0dXJuIGZhbHNlDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgaWYgKCFpbkJBTk8udHJpbSgpLmlzRW1wdHkoKSkgew0KICAgICAgICAgICAgREJBY3Rpb24gZGJNSUxPTUEgPSBkYXRhYmFzZS50YWJsZSgiTUlMT01BIikuaW5kZXgoIjAwIikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKQ0KICAgICAgICAgICAgTUlMT01BID0gZGJNSUxPTUEuZ2V0Q29udGFpbmVyKCkNCiAgICAgICAgICAgIE1JTE9NQS5zZXQoIkxNQ09OTyIsIGluQ09OTy50b0ludGVnZXIoKSkNCiAgICAgICAgICAgIE1JTE9NQS5zZXQoIkxNSVROTyIsIGluSVROTykNCiAgICAgICAgICAgIE1JTE9NQS5zZXQoIkxNQkFOTyIsIGluQkFOTy50cmltKCkpDQogICAgICAgICAgICBpZiAoIWRiTUlMT01BLnJlYWQoTUlMT01BKSkgew0KICAgICAgICAgICAgICBtaS5lcnJvcigiSXRlbS9Mb3QgZG9lcyBub3QgZXhpc3QiKQ0KICAgICAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiB0cnVlDQogICAgICAgICAgfQ0KICAgICAgICAgIHJldHVybiB0cnVlDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0NCi8qKg0KICoNCiAqIEBwYXJhbSBpblFUU1QNCiAqIEByZXR1cm4gT3JpZ29uYWxRVFNUIC0gU3BsaXQgdmFsdWUNCiAqLw0KICBwcml2YXRlIFN0cmluZyBnZXRCYXNlUVRTVChTdHJpbmcgaW5RVFNUKSB7DQogICAgbG9nZ2VyLmRlYnVnKCJnZXRCYXNlUVRTVCAtICIgKyBpblFUU1QpDQogICAgU3RyaW5nIE9yaWdpbmFsUVRTVCA9IGluUVRTVC50cmltKCk7DQogICAgaWYgKGluUVRTVC5jb250YWlucygiLSIpKSB7DQogICAgICBpbnQgaW5kZXggPSBpblFUU1QuaW5kZXhPZigiLSIpDQogICAgICBPcmlnaW5hbFFUU1QgPSBpblFUU1Quc3Vic3RyaW5nKDAsIGluZGV4KSArICItMDAxIg0KICAgIH0NCiAgICByZXR1cm4gT3JpZ2luYWxRVFNUDQogIH0NCi8qKg0KICogR2V0IFBQUzM0MCBTZXR0aW5ncyAtIFNhbXBsaW5nIGZyZXF1ZW5jeQ0KICogQHJldHVybiB0cnVlIGlmIFNhbXBsaW5nIENyaXRlcmlhIGlzIGRlZmluZWQNCiAqLw0KICBwcml2YXRlIGJvb2xlYW4gZ2V0U2FtcGxpbmdGcmVxdWVuY3koKSB7DQogICAgbG9nZ2VyLmRlYnVnKCJnZXRTYW1wbGluZ0ZyZXF1ZW5jeSB3aXRoIC0gIiArIE1JVFZFUV9UT1NQLnRyaW0oKSkNCiAgICBEQkFjdGlvbiBkYkNTWVRBQiA9IGRhdGFiYXNlLnRhYmxlKCJDU1lUQUIiKS5pbmRleCgiMDAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQogICAgREJDb250YWluZXIgQ1NZVEFCID0gZGJDU1lUQUIuZ2V0Q29udGFpbmVyKCkNCiAgICBDU1lUQUIuc2V0KCJDVENPTk8iLCBpQ09OTy50b0ludGVnZXIoKSkNCiAgICBDU1lUQUIuc2V0KCJDVERJVkkiLCAiIikNCiAgICBDU1lUQUIuc2V0KCJDVFNUQ08iLCAiVE9TUCIpDQogICAgQ1NZVEFCLnNldCgiQ1RTVEtZIiwgTUlUVkVRLmdldCgiSUZUT1NQIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgQ1NZVEFCLnNldCgiQ1RMTkNEIiwgIiIpDQogICAgaWYgKCFkYkNTWVRBQi5yZWFkKENTWVRBQikpIHsNCiAgICAgIG1pLmVycm9yKCJQUFMwNDAgU2FtcGxpbmcgQ3JpdGVyaWEgbm90IGRlZmluZWQhIikNCiAgICAgIHJldHVybiBmYWxzZQ0KICAgIH0NCiAgICBDU1lUQUJfUEFSTSA9IENTWVRBQi5nZXQoIkNUUEFSTSIpLnRvU3RyaW5nKCkNCiAgICBtaS5vdXREYXRhLnB1dCgiQ09ORiIsICIwIikNCiAgICByZXR1cm4gdHJ1ZQ0KICB9DQovKioNCiAqDQogKiBAcGFyYW0gaW5DT05PDQogKiBAcGFyYW0gaW5JVE5PDQogKiBAcGFyYW0gaW5TVU5PDQogKiBAcGFyYW0gaW5CQU5PDQogKiBAcGFyYW0gaW5RVFNUDQogKiBAcmV0dXJuIENoZWNrIGlmIEZpcnN0IExvdCBmb3IgU3VwcGxpZXIvSXRlbQ0KICovDQogIHByaXZhdGUgaW50IGNoa0lmRmlyc3RJdGVtU3VwcFJlYygpIHsNCiAgICBEQkFjdGlvbiBkYkVYVDIwMSA9IGRhdGFiYXNlLnRhYmxlKCJFWFQyMDEiKS5pbmRleCgiMDAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQogICAgRVhUMjAxID0gZGJFWFQyMDEuZ2V0Q29udGFpbmVyKCkNCiAgICBFWFQyMDEuc2V0KCJFWENPTk8iLCBpQ09OTy50b0ludGVnZXIoKSkNCiAgICBFWFQyMDEuc2V0KCJFWElUTk8iLCBpSVROTykNCiAgICBFWFQyMDEuc2V0KCJFWFNVTk8iLCBpU1VOTykNCg0KICAgIENsb3N1cmU8Pz4gcmVhZEFsbFJlY29yZHNFWFQyMDEgPSB7IERCQ29udGFpbmVyIHJlc3VsdENvbnRhaW5lciAtPg0KICAgICAgRVhUMjAxID0gcmVzdWx0Q29udGFpbmVyDQogICAgICBFWFQyMDFfUVRTVCA9IHJlc3VsdENvbnRhaW5lci5nZXQoIkVYUVRTVCIpLnRvU3RyaW5nKCkNCiAgICAgIGxvZ2dlci5kZWJ1ZygiUUFQUl9PdXQ6ICIgKyByZXN1bHRDb250YWluZXIuZ2V0KCJFWFFBUFIiKS50b1N0cmluZygpKQ0KICAgICAgRVhUMjAxX1FBUFIgPSByZXN1bHRDb250YWluZXIuZ2V0KCJFWFFBUFIiKS50b1N0cmluZygpDQogICAgfQ0KICAgIGlmIChkYkVYVDIwMS5yZWFkQWxsKEVYVDIwMSwzLDEscmVhZEFsbFJlY29yZHNFWFQyMDEpKSB7DQogICAgICBsb2dnZXIuZGVidWcoImNoa0lmRmlyc3RJdGVtU3VwcFJlYyAtIHJlY29yZCBmb3VuZCBpbiBFWFQyMDEgLSBOb3QgZmlyc3QgdGltZSIpDQogICAgICByZXR1cm4gMA0KICAgIH0gZWxzZSB7DQogICAgICBsb2dnZXIuZGVidWcoImNoa0lmRmlyc3RJdGVtU3VwcFJlYyAtIHJlY29yZCBub3QgZm91bmQgaW4gRVhUMjAxIC0gZmlyc3QgdGltZSIpDQogICAgICByZXR1cm4gMQ0KICAgIH0NCiAgfQ0KICAvKioNCiAgICogZ2V0UUFQUg0KICAgKi8NCiAgcHJpdmF0ZSB2b2lkIGdldFFBUFIoKSB7DQogICAgREJBY3Rpb24gZGJFWFQyMDEgPSBkYXRhYmFzZS50YWJsZSgiRVhUMjAxIikuaW5kZXgoIjAwIikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKQ0KICAgIEVYVDIwMSA9IGRiRVhUMjAxLmdldENvbnRhaW5lcigpDQogICAgRVhUMjAxLnNldCgiRVhDT05PIiwgaUNPTk8udG9JbnRlZ2VyKCkpDQogICAgRVhUMjAxLnNldCgiRVhJVE5PIiwgaUlUTk8pDQogICAgRVhUMjAxLnNldCgiRVhTVU5PIiwgaVNVTk8pDQogICAgRVhUMjAxLnNldCgiRVhRVFNUIiwgaVFUU1QpDQogICAgaWYgKGlRVFNULnRyaW0oKS5pc0VtcHR5KCkpIHsNCiAgICAgIEVYVDIwMS5zZXQoIkVYQkFOTyIsIGlCQU5PKQ0KICAgIH0NCiAgICBpZiAoZGJFWFQyMDEucmVhZChFWFQyMDEpKSB7DQogICAgICBsb2dnZXIuZGVidWcoImdldFFBUFIgLSByZWNvcmQgZm91bmQgaW4gRVhUMjAxIikNCiAgICB9IGVsc2Ugew0KICAgICAgbG9nZ2VyLmRlYnVnKCJnZXRRQVBSIC0gcmVjb3JkIGZvdW5kIG5vdCBpbiBFWFQyMDEiKQ0KICAgIH0NCiAgfQ0KLyoqDQogKiBhZGR1cGRJdFN1UmVjIC0gQWRkL1VwZGF0ZSBJdGVtL1N1cHBsaWVyIHNwZWNpZmljIHJlY29yZA0KICogQHJldHVybg0KICovDQogIHByaXZhdGUgYm9vbGVhbiBhZGR1cGRJdFN1UmVjKCkgew0KDQogICAgbG9nZ2VyLmRlYnVnKCJFbnRlcmVkIGFkZHVwZEl0U3VSZWMiKQ0KICAgIGxvZ2dlci5kZWJ1ZygiUmVhZGluZyBFWFQyMDEgd2l0aCBhbGwga2V5cyAtIFFUU1QgPSBiYXNlUVRTVDogIiArIGJhc2VRVFNUKQ0KDQogICAgREJBY3Rpb24gZGJFWFQyMDEgPSBkYXRhYmFzZS50YWJsZSgiRVhUMjAxIikuaW5kZXgoIjAwIikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKQ0KICAgIEVYVDIwMSA9IGRiRVhUMjAxLmdldENvbnRhaW5lcigpDQoNCiAgICBFWFQyMDEuc2V0KCJFWENPTk8iLCBpQ09OTy50b0ludGVnZXIoKSkNCiAgICBFWFQyMDEuc2V0KCJFWElUTk8iLCBpSVROTy50b1N0cmluZygpKQ0KICAgIEVYVDIwMS5zZXQoIkVYU1VOTyIsIGlTVU5PLnRvU3RyaW5nKCkpDQogICAgRVhUMjAxLnNldCgiRVhRVFNUIiwgYmFzZVFUU1QpDQoNCiAgICBpZiAoaVFUU1QudHJpbSgpLmlzRW1wdHkoKSkgew0KICAgICAgRVhUMjAxLnNldCgiRVhCQU5PIiwgaUJBTk8pDQogICAgfQ0KDQogICAgTGlzdDxMb2NrZWRSZXN1bHQ+IGxvY2tlZFJlc3VsdHNfRVhUMjAxID0gbmV3IEFycmF5TGlzdDxMb2NrZWRSZXN1bHQ+KCkNCiAgICBDbG9zdXJlPD8+IHVwZGF0ZUNhbGxCYWNrID0gew0KICAgICAgTG9ja2VkUmVzdWx0IGxvY2tlZFJlc3VsdCAtPg0KDQogICAgICAgIGxvY2tlZFJlc3VsdC5hbGxDb2x1bW5zLmVhY2ggew0KICAgICAgICAgIFN0cmluZyBjb2x1bW4gLT4NCiAgICAgICAgICAgIEVYVDIwMS5zZXQoY29sdW1uLCBsb2NrZWRSZXN1bHQuZ2V0KGNvbHVtbikpDQogICAgICAgIH0NCg0KICAgICAgICBsb2NrZWRSZXN1bHRzX0VYVDIwMS5hZGQobG9ja2VkUmVzdWx0KQ0KICAgICAgICBsb2dnZXIuZGVidWcoInJlYWRpbmcgRVhUMjAxIHJlY29yZHMiKQ0KICAgIH0NCiAgICBpZiAoZGJFWFQyMDEucmVhZExvY2soRVhUMjAxLCB1cGRhdGVDYWxsQmFjaykpIHsNCg0KICAgICAgTG9ja2VkUmVzdWx0IGxvY2tlZFJlc3VsdEVYVDIwMSA9IGxvY2tlZFJlc3VsdHNfRVhUMjAxWzBdDQogICAgICAvL1NldCBRQSBTdGF0dXMgZm9yIEl0ZW0gLyBTdXBwbGllciAvIExvdCAoRmlyc3QgUmVjZWlwdCkNCiAgICAgIGlmIChpQkFOTy50cmltKCkuaXNFbXB0eSgpIHx8ICFpUVRTVC50cmltKCkuaXNFbXB0eSgpKSB7DQoNCiAgICAgICAgbG9nZ2VyLmRlYnVnKCJ1cGRhdGluZyBRSVRMIikNCiAgICAgICAgbG9nZ2VyLmRlYnVnKCJpUVRTVCAtICIgKyBpUVRTVCArICItLS0tLSBpU0NTVCAtICIgKyBpU0NTVCArICIgRVhRSVRMIC0gIiArIGxvY2tlZFJlc3VsdEVYVDIwMS5nZXQoIkVYUUlUTCIpLnRvU3RyaW5nKCkpDQoNCiAgICAgICAgLy9CYXNlIFJlY29yZA0KICAgICAgICBpZiAoaVFUU1QudHJpbSgpLmlzRW1wdHkoKSAmJiBpU0NTVC50cmltKCkgPT0gIlkiICYmIChsb2NrZWRSZXN1bHRFWFQyMDEuZ2V0KCJFWFFJVEwiKS50b1N0cmluZygpLnRvSW50ZWdlcigpID4gMCkpIHsNCiAgICAgICAgICBFWFQyMDEuc2V0KCJFWFFJVEwiLCBsb2NrZWRSZXN1bHRFWFQyMDEuZ2V0KCJFWFFJVEwiKS50b1N0cmluZygpLnRvSW50ZWdlcigpIC0gMSkNCiAgICAgICAgICBsb2NrZWRSZXN1bHRFWFQyMDEuc2V0KCJFWFFJVEwiLCBsb2NrZWRSZXN1bHRFWFQyMDEuZ2V0KCJFWFFJVEwiKS50b1N0cmluZygpLnRvSW50ZWdlcigpIC0gMSkNCiAgICAgICAgfQ0KDQogICAgICAgIGlmIChpUVRTVC50cmltKCkuaXNFbXB0eSgpICYmIGlTQ1NULnRyaW0oKSA9PSAiWSIgJiYgKGxvY2tlZFJlc3VsdEVYVDIwMS5nZXQoIkVYUUlUTCIpLnRvU3RyaW5nKCkudG9JbnRlZ2VyKCkgPT0gMCkpIHsNCiAgICAgICAgICBFWFQyMDEuc2V0KCJFWFFJVEwiLCBJbnRlZ2VyLnBhcnNlSW50KFN0cmluZy5mb3JtYXQoIiUyMDBzIiwgQ1NZVEFCX1BBUk0pLnN1YnN0cmluZygyLCA0KSkgKiAtMSBhcyBpbnQpDQogICAgICAgICAgbG9ja2VkUmVzdWx0RVhUMjAxLnNldCgiRVhRSVRMIiwgSW50ZWdlci5wYXJzZUludChTdHJpbmcuZm9ybWF0KCIlMjAwcyIsIENTWVRBQl9QQVJNKS5zdWJzdHJpbmcoMiwgNCkpICogLTEgYXMgaW50KQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKGlRVFNULnRyaW0oKS5pc0VtcHR5KCkgJiYgaVNDU1QudHJpbSgpID09ICJZIiAmJiAobG9ja2VkUmVzdWx0RVhUMjAxLmdldCgiRVhRSVRMIikudG9TdHJpbmcoKS50b0ludGVnZXIoKSA8IDApKSB7DQogICAgICAgICAgRVhUMjAxLnNldCgiRVhRSVRMIiwgbG9ja2VkUmVzdWx0RVhUMjAxLmdldCgiRVhRSVRMIikudG9TdHJpbmcoKS50b0ludGVnZXIoKSArIDEpDQogICAgICAgICAgbG9ja2VkUmVzdWx0RVhUMjAxLnNldCgiRVhRSVRMIiwgbG9ja2VkUmVzdWx0RVhUMjAxLmdldCgiRVhRSVRMIikudG9TdHJpbmcoKS50b0ludGVnZXIoKSArIDEpDQogICAgICAgIH0NCg0KICAgICAgICAvL1Rlc3QgUmVjb3JkDQogICAgICAgIGlmICghaVFUU1QudHJpbSgpLmlzRW1wdHkoKSAmJiBpUVRTVC50cmltKCkgPT0gYmFzZVFUU1QudHJpbSgpICYmIGlTQ1NULnRyaW0oKSA9PSAiWSIgJiYgKGxvY2tlZFJlc3VsdEVYVDIwMS5nZXQoIkVYUUlUTCIpLnRvU3RyaW5nKCkudG9JbnRlZ2VyKCkgPiAwKSkgew0KICAgICAgICAgIEVYVDIwMS5zZXQoIkVYUUlUTCIsIGxvY2tlZFJlc3VsdEVYVDIwMS5nZXQoIkVYUUlUTCIpLnRvU3RyaW5nKCkudG9JbnRlZ2VyKCkgLSAxKQ0KICAgICAgICAgIGxvY2tlZFJlc3VsdEVYVDIwMS5zZXQoIkVYUUlUTCIsIGxvY2tlZFJlc3VsdEVYVDIwMS5nZXQoIkVYUUlUTCIpLnRvU3RyaW5nKCkudG9JbnRlZ2VyKCkgLSAxKQ0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCFpUVRTVC50cmltKCkuaXNFbXB0eSgpICYmIGlTQ1NULnRyaW0oKSA9PSAiTiIpIHsNCiAgICAgICAgICBFWFQyMDEuc2V0KCJFWFFJVEwiLCAoU3RyaW5nLmZvcm1hdCgiJTIwMHMiLCBDU1lUQUJfUEFSTSkuc3Vic3RyaW5nKDE1LCAxNykpIGFzIGludCkNCiAgICAgICAgICBsb2NrZWRSZXN1bHRFWFQyMDEuc2V0KCJFWFFJVEwiLCAoU3RyaW5nLmZvcm1hdCgiJTIwMHMiLCBDU1lUQUJfUEFSTSkuc3Vic3RyaW5nKDE1LCAxNykpIGFzIGludCkNCiAgICAgICAgfQ0KDQogICAgICAgIGludCBjaGFuZ2VOdW1iZXIgPSBsb2NrZWRSZXN1bHRFWFQyMDEuZ2V0SW50KCJFWENITk8iKQ0KICAgICAgICBpbnQgbmV3Q2hhbmdlTnVtYmVyID0gY2hhbmdlTnVtYmVyICsgMQ0KICAgICAgICAvLyBVcGRhdGUgY2hhbmdlZCBpbmZvcm1hdGlvbg0KICAgICAgICBsb2NrZWRSZXN1bHRFWFQyMDEuc2V0KCJFWExNRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpDQogICAgICAgIGxvY2tlZFJlc3VsdEVYVDIwMS5zZXQoIkVYQ0hOTyIsIG5ld0NoYW5nZU51bWJlcikNCiAgICAgICAgbG9ja2VkUmVzdWx0RVhUMjAxLnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpDQogICAgICB9IGVsc2Ugew0KICAgICAgICBpZiAoIWlRQVBSLnRyaW0oKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgICBsb2NrZWRSZXN1bHRFWFQyMDEuc2V0KCJFWFFBUFIiLCBpUUFQUi50b1N0cmluZygpLnRvSW50ZWdlcigpKQ0KICAgICAgICAgIEVYVDIwMV9RQVBSID0gaVFBUFIudG9TdHJpbmcoKQ0KICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiU2V0IFFBUFIgdG86ICIgKyBpUUFQUi50b1N0cmluZygpKQ0KICAgICAgICAgIGlmICghaVBVTk8udHJpbSgpLmlzRW1wdHkoKSkgew0KICAgICAgICAgICAgbG9ja2VkUmVzdWx0RVhUMjAxLnNldCgiRVhQVU5PIiwgaVBVTk8udHJpbSgpKQ0KICAgICAgICAgIH0NCiAgICAgICAgICBpbnQgY2hhbmdlTnVtYmVyID0gbG9ja2VkUmVzdWx0RVhUMjAxLmdldCgiRVhDSE5PIikNCiAgICAgICAgICBpbnQgbmV3Q2hhbmdlTnVtYmVyID0gY2hhbmdlTnVtYmVyICsgMQ0KICAgICAgICAgIC8vIFVwZGF0ZSBjaGFuZ2VkIGluZm9ybWF0aW9uDQogICAgICAgICAgbG9ja2VkUmVzdWx0RVhUMjAxLnNldCgiRVhMTURUIiwgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpKQ0KICAgICAgICAgIGxvY2tlZFJlc3VsdEVYVDIwMS5zZXQoIkVYQ0hOTyIsIG5ld0NoYW5nZU51bWJlcikNCiAgICAgICAgICBsb2NrZWRSZXN1bHRFWFQyMDEuc2V0KCJFWENISUQiLCBwcm9ncmFtLmdldFVzZXIoKSkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgbG9nZ2VyLmRlYnVnKCJhZGR1cGRJdFN1UmVjIC0gVXBkYXRpbmcgRVhUMjAxIikNCiAgICAgIGxvY2tlZFJlc3VsdEVYVDIwMS51cGRhdGUoKQ0KICAgICAgbG9ja2VkUmVzdWx0RVhUMjAxLmFsbENvbHVtbnMuZWFjaCB7DQogICAgICAgIFN0cmluZyBjb2x1bW4gLT4NCiAgICAgICAgICBFWFQyMDEuc2V0KGNvbHVtbiwgbG9ja2VkUmVzdWx0RVhUMjAxLmdldChjb2x1bW4pKQ0KICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAvL09ubHkgc2V0IGZvciBCYXNlIFJlY29yZA0KICAgICAgaWYgKGlCQU5PLnRyaW0oKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgaWYgKGlRVFNULnRyaW0oKS5pc0VtcHR5KCkpIHsNCiAgICAgICAgICBFWFQyMDEuc2V0KCJFWFFJVEwiLCAoU3RyaW5nLmZvcm1hdCgiJTIwMHMiLCBDU1lUQUJfUEFSTSkuc3Vic3RyaW5nKDAsIDIpKSBhcyBpbnQpIC8vT25seSBzZXQgZm9yIEJhc2UgUmVjb3JkDQogICAgICAgIH0NCiAgICAgICAgaWYgKCFpUVRTVC50cmltKCkuaXNFbXB0eSgpICYmIGlTQ1NULnRyaW0oKSA9PSAiTiIpIHsNCiAgICAgICAgICBFWFQyMDEuc2V0KCJFWFFJVEwiLCAoU3RyaW5nLmZvcm1hdCgiJTIwMHMiLCBDU1lUQUJfUEFSTSkuc3Vic3RyaW5nKDE1LCAxNykpIGFzIGludCkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgRVhUMjAxLnNldCgiRVhMTURUIiwgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpKQ0KICAgICAgRVhUMjAxLnNldCgiRVhDSE5PIiwgMCkNCiAgICAgIEVYVDIwMS5zZXQoIkVYQ0hJRCIsIHByb2dyYW0uZ2V0VXNlcigpKQ0KICAgICAgbG9nZ2VyLmRlYnVnKCJhZGR1cGRJdFN1UmVjIC0gSW5zZXJ0aW5nIHJlY29yZHMgRVhUMjAxIikNCiAgICAgIGRiRVhUMjAxLmluc2VydChFWFQyMDEpDQoNCiAgICB9DQogICAgaWYgKCFpUVRTVC50cmltKCkuaXNFbXB0eSgpKSB7DQogICAgICBsb2dnZXIuZGVidWcoImFkZHVwZEl0U3VSZWMgLSBpUVRTVCBub3QgaXNlbXB0eSIpDQogICAgICBEQkFjdGlvbiBkYlFNU1JRSCA9IGRhdGFiYXNlLnRhYmxlKCJRTVNSUUgiKS5pbmRleCgiMzAiKS5zZWxlY3RBbGxGaWVsZHMoKS5yZXZlcnNlKCkuYnVpbGQoKQ0KICAgICAgUU1TUlFIID0gZGJRTVNSUUguZ2V0Q29udGFpbmVyKCkNCiAgICAgIFFNU1JRSC5zZXQoIlJIQ09OTyIsIGlDT05PLnRvSW50ZWdlcigpKQ0KICAgICAgUU1TUlFILnNldCgiUkhJVE5PIiwgaUlUTk8pDQogICAgICBRTVNSUUguc2V0KCJSSEJBTk8iLCBpQkFOTykNCg0KICAgICAgLy9SZWFkIHByZXZpb3VzIHJlY29yZA0KICAgICAgTGlzdDxEQkNvbnRhaW5lcj4gYXJyYXlPZkNvbnRhaW5lcnMgPSBuZXcgQXJyYXlMaXN0PERCQ29udGFpbmVyPigpDQogICAgICBDbG9zdXJlPD8+IHJlYWRBbGxSZWNvcmRzUU1TUlFIID0geyBEQkNvbnRhaW5lciByZXN1bHRDb250YWluZXIgLT4NCiAgICAgICAgYXJyYXlPZkNvbnRhaW5lcnMuYWRkKHJlc3VsdENvbnRhaW5lcikNCiAgICAgICAgUU1TUlFIID0gcmVzdWx0Q29udGFpbmVyDQogICAgICB9DQoNCiAgICAgIGlmIChkYlFNU1JRSC5yZWFkQWxsKFFNU1JRSCwgMywgMSwgcmVhZEFsbFJlY29yZHNRTVNSUUgpKSB7DQogICAgICAgIGludCBzaXplID0gYXJyYXlPZkNvbnRhaW5lcnMuc2l6ZSgpDQoNCiAgICAgICAgaWYgKHNpemUgPj0gMSkgew0KLy8gICAgICAgICAgREJDb250YWluZXIgcmVzdWx0Q29udGFpbmVyID0gYXJyYXlPZkNvbnRhaW5lcnNbc2l6ZSAtIDFdDQoNCiAgICAgICAgICBEQkFjdGlvbiBkYlFNU1JRVCA9IGRhdGFiYXNlLnRhYmxlKCJRTVNSUVQiKS5pbmRleCgiMTAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQogICAgICAgICAgUU1TUlFUID0gZGJRTVNSUVQuZ2V0Q29udGFpbmVyKCkNCiAgICAgICAgICBRTVNSUVQuc2V0KCJSVENPTk8iLCBpQ09OTy50b0ludGVnZXIoKSkNCiAgICAgICAgICBRTVNSUVQuc2V0KCJSVEZBQ0kiLCBRTVNSUUguZ2V0KCJSSEZBQ0kiKS50b1N0cmluZygpKQ0KICAgICAgICAgIFFNU1JRVC5zZXQoIlJUUVJJRCIsIFFNU1JRSC5nZXQoIlJIUVJJRCIpLnRvU3RyaW5nKCkpDQogICAgICAgICAgUU1TUlFULnNldCgiUlRRVFNUIiwgaVFUU1QudHJpbSgpKQ0KICAgICAgICAgIENsb3N1cmU8Pz4gcmVhZFFNU1JRVCA9IHsgREJDb250YWluZXIgZGF0YSAtPg0KICAgICAgICAgICAgUU1TUlFUID0gZGF0YQ0KICAgICAgICAgICAgaWYgKChkYXRhLmdldCgiUlRTUEVDIikudG9TdHJpbmcoKS50cmltKCkgPT0gaVNQRUMudHJpbSgpIHx8IGlTUEVDLnRyaW0oKS5pc0VtcHR5KCkpICYmIChkYXRhLmdldCgiUlRUU1RUIikudG9TdHJpbmcoKS50b0ludGVnZXIoKSkgPiAwKSB7DQogICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiYWRkdXBkSXRTdVJlYyAtIFFNU1JRVCByZXR1cm5lZCByZWNvcmQiKQ0KICAgICAgICAgICAgICAvL1pRUE9RSSA9IEVYVDIwMg0KICAgICAgICAgICAgICBEQkFjdGlvbiBkYkVYVDIwMiA9IGRhdGFiYXNlLnRhYmxlKCJFWFQyMDIiKS5pbmRleCgiMDAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQogICAgICAgICAgICAgIEVYVDIwMiA9IGRiRVhUMjAyLmdldENvbnRhaW5lcigpDQogICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYQ09OTyIsIGlDT05PLnRvSW50ZWdlcigpKQ0KICAgICAgICAgICAgICBFWFQyMDIuc2V0KCJFWElUTk8iLCBpSVROTykNCiAgICAgICAgICAgICAgRVhUMjAyLnNldCgiRVhTVU5PIiwgaVNVTk8pDQogICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYUVRTVCIsIGlRVFNUKQ0KICAgICAgICAgICAgICBFWFQyMDIuc2V0KCJFWEJBTk8iLCBpQkFOTykNCiAgICAgICAgICAgICAgRVhUMjAyLnNldCgiRVhRUklEIiwgUU1TUlFILmdldCgiUkhRUklEIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYU1BFQyIsIGRhdGEuZ2V0KCJSVFNQRUMiKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgICAgICAgQ2xvc3VyZTw/PiB1cGRhdGVDYWxsQmFja0VYVDIwMiA9IHsgTG9ja2VkUmVzdWx0IGxvY2tlZFJlc3VsdEVYVDIwMiAtPg0KICAgICAgICAgICAgICAgIGxvY2tlZFJlc3VsdEVYVDIwMi5hbGxDb2x1bW5zLmVhY2ggew0KICAgICAgICAgICAgICAgICAgU3RyaW5nIGNvbHVtbiAtPg0KICAgICAgICAgICAgICAgICAgICBFWFQyMDIuc2V0KGNvbHVtbiwgbG9ja2VkUmVzdWx0RVhUMjAyLmdldChjb2x1bW4pKQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoImFkZHVwZEl0U3VSZWMgLSBRTVNSUVQgcmV0dXJuZWQgcmVjb3JkIC0gUmVhZGluZyBFWFQyMDIiKQ0KICAgICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYTFFJVCIsIEVYVDIwMS5nZXQoIkVYUUlUTCIpLnRvU3RyaW5nKCkgYXMgaW50KQ0KICAgICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYTFRTVCIsIGRhdGEuZ2V0KCJSVFRTVFQiKS50b1N0cmluZygpLnRyaW0oKSBhcyBpbnQpDQogICAgICAgICAgICAgICAgRVhUMjAyLnNldCgiRVhMUVRSIiwgZGF0YS5nZXQoIlJUUVRSUyIpLnRvU3RyaW5nKCkudHJpbSgpIGFzIGRvdWJsZSkNCiAgICAgICAgICAgICAgICBFWFQyMDIuc2V0KCJFWExRTEMiLCBkYXRhLmdldCgiUlRRTEMyIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgICAgICAgRVhUMjAyLnNldCgiRVhMTURUIiwgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpKQ0KICAgICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYQ0hOTyIsIDApDQogICAgICAgICAgICAgICAgRVhUMjAyLnNldCgiRVhMQ0hJIiwgcHJvZ3JhbS5nZXRVc2VyKCkpDQogICAgICAgICAgICAgICAgRVhUMjAyLnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpDQoNCiAgICAgICAgICAgICAgICBsb2NrZWRSZXN1bHRFWFQyMDIuc2V0KCJFWExRSVQiLCBFWFQyMDEuZ2V0KCJFWFFJVEwiKS50b1N0cmluZygpIGFzIGludCkNCiAgICAgICAgICAgICAgICBsb2NrZWRSZXN1bHRFWFQyMDIuc2V0KCJFWExUU1QiLCBkYXRhLmdldCgiUlRUU1RUIikudG9TdHJpbmcoKS50cmltKCkgYXMgaW50KQ0KICAgICAgICAgICAgICAgIGxvY2tlZFJlc3VsdEVYVDIwMi5zZXQoIkVYTFFUUiIsIGRhdGEuZ2V0KCJSVFFUUlMiKS50b1N0cmluZygpLnRyaW0oKSBhcyBkb3VibGUpDQogICAgICAgICAgICAgICAgbG9ja2VkUmVzdWx0RVhUMjAyLnNldCgiRVhMUUxDIiwgZGF0YS5nZXQoIlJUUUxDMiIpLnRvU3RyaW5nKCkudHJpbSgpKQ0KICAgICAgICAgICAgICAgIGxvY2tlZFJlc3VsdEVYVDIwMi5zZXQoIkVYTE1EVCIsIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKS50b0ludGVnZXIoKSkNCiAgICAgICAgICAgICAgICBsb2NrZWRSZXN1bHRFWFQyMDIuc2V0KCJFWENITk8iLCAwKQ0KICAgICAgICAgICAgICAgIGxvY2tlZFJlc3VsdEVYVDIwMi5zZXQoIkVYQ0hJRCIsIHByb2dyYW0uZ2V0VXNlcigpKQ0KICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiYWRkdXBkSXRTdVJlYyAtIHVwZGF0aW5nIEVYVDIwMiIpDQogICAgICAgICAgICAgICAgbG9ja2VkUmVzdWx0RVhUMjAyLnVwZGF0ZSgpDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgaWYgKCFkYkVYVDIwMi5yZWFkTG9jayhFWFQyMDIsIHVwZGF0ZUNhbGxCYWNrRVhUMjAyKSkgew0KICAgICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYTFFJVCIsIEVYVDIwMS5nZXQoIkVYUUlUTCIpLnRvU3RyaW5nKCkgYXMgaW50KQ0KICAgICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYTFRTVCIsIGRhdGEuZ2V0KCJSVFRTVFQiKS50b1N0cmluZygpLnRyaW0oKSBhcyBpbnQpDQogICAgICAgICAgICAgICAgRVhUMjAyLnNldCgiRVhMUVRSIiwgZGF0YS5nZXQoIlJUUVRSUyIpLnRvU3RyaW5nKCkudHJpbSgpIGFzIGRvdWJsZSkNCiAgICAgICAgICAgICAgICBFWFQyMDIuc2V0KCJFWExRTEMiLCBkYXRhLmdldCgiUlRRTEMyIikudG9TdHJpbmcoKS50cmltKCkpDQogICAgICAgICAgICAgICAgRVhUMjAyLnNldCgiRVhRSVRMIiwgRVhUMjAxLmdldCgiRVhRSVRMIikudG9TdHJpbmcoKS50b0ludGVnZXIoKSkNCiAgICAgICAgICAgICAgICBFWFQyMDIuc2V0KCJFWFRTVFQiLCBkYXRhLmdldCgiUlRUU1RUIikudG9TdHJpbmcoKS50cmltKCkgYXMgaW50KQ0KICAgICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYUVRSUyIsIGRhdGEuZ2V0KCJSVFFUUlMiKS50b1N0cmluZygpLnRyaW0oKSBhcyBkb3VibGUpDQogICAgICAgICAgICAgICAgRVhUMjAyLnNldCgiRVhRTEMyIiwgZGF0YS5nZXQoIlJUUUxDMiIpLnRvU3RyaW5nKCkudHJpbSgpKQ0KICAgICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYTE1EVCIsIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKS50b0ludGVnZXIoKSkNCiAgICAgICAgICAgICAgICBFWFQyMDIuc2V0KCJFWENITk8iLCAwKQ0KICAgICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYTENISSIsIHByb2dyYW0uZ2V0VXNlcigpKQ0KICAgICAgICAgICAgICAgIEVYVDIwMi5zZXQoIkVYQ0hJRCIsIHByb2dyYW0uZ2V0VXNlcigpKQ0KICAgICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiYWRkdXBkSXRTdVJlYyAtIEluc2VydCBFWFQyMDIiKQ0KICAgICAgICAgICAgICAgIGRiRVhUMjAyLmluc2VydChFWFQyMDIpDQogICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgaWYgKCFkYlFNU1JRVC5yZWFkQWxsKFFNU1JRVCwgNCwgcmVhZFFNU1JRVCkpIHsNCiAgICAgICAgICAgIC8vbm8gZWxzZQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KLyoqDQogKiBnZXRJdFN1UmVjX0hpc3RvcnkgLSBBZGQvVXBkYXRlIEl0ZW0vU3VwcGxpZXIgc3BlY2lmaWMgcmVjb3JkDQogKiovDQogIHByaXZhdGUgdm9pZCBnZXRIaXN0b3J5KCkgew0KICAgIGxvZ2dlci5kZWJ1ZygiRW50ZXJlZCBnZXRIaXN0b3J5IikNCiAgICBpbnQgbm9PZktleXMgPSA0DQogICAgREJBY3Rpb24gZGJFWFQyMDEgPSBkYXRhYmFzZS50YWJsZSgiRVhUMjAxIikuaW5kZXgoIjAwIikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKQ0KICAgIEVYVDIwMSA9IGRiRVhUMjAxLmdldENvbnRhaW5lcigpDQogICAgRVhUMjAxLnNldCgiRVhDT05PIiwgaUNPTk8udG9JbnRlZ2VyKCkpDQogICAgRVhUMjAxLnNldCgiRVhJVE5PIiwgaUlUTk8pDQogICAgRVhUMjAxLnNldCgiRVhTVU5PIiwgaVNVTk8pDQogICAgRVhUMjAxLnNldCgiRVhRVFNUIiwgaVFUU1QpDQogICAgaWYgKGlRVFNULnRyaW0oKS5pc0VtcHR5KCkpIHsNCiAgICAgIEVYVDIwMS5zZXQoIkVYQkFOTyIsIGlCQU5PKQ0KICAgICAgbm9PZktleXMgPSA1DQogICAgfQ0KICAgIENsb3N1cmU8Pz4gcmVhZEFsbFJlY29yZHNFWFQyMDEgPSB7IERCQ29udGFpbmVyIHJlc3VsdENvbnRhaW5lciAtPg0KICAgICAgRVhUMjAxID0gcmVzdWx0Q29udGFpbmVyDQogICAgICBsb2dnZXIuZGVidWcoIkVudGVyZWQgZ2V0SGlzdG9yeSAtIHJlY29yZCBmb3VuZCBpbiBFWFQyMDEiKQ0KICAgICAgRVhUMjAxX1FJVEwgPSByZXN1bHRDb250YWluZXIuZ2V0KCJFWFFJVEwiKS50b1N0cmluZygpDQogICAgICBFWFQyMDFfUUFQUiA9IHJlc3VsdENvbnRhaW5lci5nZXQoIkVYUUFQUiIpLnRvU3RyaW5nKCkNCiAgICAgIEVYVDIwMV9RVFNUID0gcmVzdWx0Q29udGFpbmVyLmdldCgiRVhRVFNUIikudG9TdHJpbmcoKQ0KICAgIH0NCiAgICBpZiAoZGJFWFQyMDEucmVhZEFsbChFWFQyMDEsIG5vT2ZLZXlzLCAxLCByZWFkQWxsUmVjb3Jkc0VYVDIwMSkpIHsNCiAgICAgIC8vDQogICAgfQ0KICAgIC8vR2V0IGxhdGVzdCBRSSBSZXF1ZXN0IGZvciBJdGVtL0xvdA0KICAgIERCQWN0aW9uIGRiUU1TUlFIID0gZGF0YWJhc2UudGFibGUoIlFNU1JRSCIpLmluZGV4KCIzMCIpLnNlbGVjdEFsbEZpZWxkcygpLnJldmVyc2UoKS5idWlsZCgpDQogICAgUU1TUlFIID0gZGJRTVNSUUguZ2V0Q29udGFpbmVyKCkNCiAgICBRTVNSUUguc2V0KCJSSENPTk8iLCBpQ09OTy50b0ludGVnZXIoKSkNCiAgICBRTVNSUUguc2V0KCJSSElUTk8iLCBpSVROTykNCiAgICBRTVNSUUguc2V0KCJSSEJBTk8iLCBpQkFOTykNCiAgICAvL1JlYWQgbGFzdCByZWNvcmQNCiAgICBDbG9zdXJlPD8+IHJlYWRBbGxSZWNvcmRzUU1TUlFIID0geyBEQkNvbnRhaW5lciByZXN1bHRDb250YWluZXIgLT4NCiAgICAgIFFNU1JRSCA9IHJlc3VsdENvbnRhaW5lcg0KICAgICAgUU1TUlFIX1JPUk4gPSByZXN1bHRDb250YWluZXIuZ2V0KCJSSFJPUk4iKS50b1N0cmluZygpDQogICAgICBRTVNSUUhfUVJJRCA9IHJlc3VsdENvbnRhaW5lci5nZXQoIlJIUVJJRCIpLnRvU3RyaW5nKCkNCiAgICB9DQogICAgaWYgKGRiUU1TUlFILnJlYWRBbGwoUU1TUlFILCAzLCAxLCByZWFkQWxsUmVjb3Jkc1FNU1JRSCkpIHsNCiAgICAgIC8vIFFSSUQgaXMgbm90IGluIGlucHV0IC0gU2hvdWxkIGl0IGJlIGFkZGVkPz8NCiAgICB9IGVsc2Ugew0KICAgICAgbG9nZ2VyLmRlYnVnKCJGYWlsZWQgdG8gcmVhZCByZWNvcmRzIGluIFFNU1JRSCIpDQogICAgICByZXR1cm4NCiAgICB9DQoNCiAgICBEQkFjdGlvbiBkYkVYVDIwMiA9IGRhdGFiYXNlLnRhYmxlKCJFWFQyMDIiKS5pbmRleCgiMDAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQogICAgRVhUMjAyID0gZGJFWFQyMDIuZ2V0Q29udGFpbmVyKCkNCiAgICBFWFQyMDIuc2V0KCJFWENPTk8iLCBpQ09OTy50b0ludGVnZXIoKSkNCiAgICBFWFQyMDIuc2V0KCJFWElUTk8iLCBpSVROTykNCiAgICBFWFQyMDIuc2V0KCJFWFNVTk8iLCBpU1VOTykNCiAgICBFWFQyMDIuc2V0KCJFWFFUU1QiLCBpUVRTVCkNCiAgICBFWFQyMDIuc2V0KCJFWEJBTk8iLCBpQkFOTykNCiAgICBFWFQyMDIuc2V0KCJFWFFSSUQiLCBRTVNSUUhfUVJJRCkNCiAgICAvL1JlYWQgbGFzdCByZWNvcmQNCiAgICBDbG9zdXJlPD8+IHJlYWRBbGxSZWNvcmRzRVhUMjAyID0geyBEQkNvbnRhaW5lciByZXN1bHRDb250YWluZXIgLT4NCiAgICAgIEVYVDIwMiA9IHJlc3VsdENvbnRhaW5lcg0KICAgICAgbG9nZ2VyLmRlYnVnKCJSZWFkaW5nIEVYVDIwMiByZWNvcmRzIikNCiAgICAgIGxvZ2dlci5kZWJ1ZygiRVhUMjAyX1FSSUQ6ICIgKyBFWFQyMDIuZ2V0KCJFWFFSSUQiKS50b1N0cmluZygpKQ0KICAgIH0NCiAgICBpZiAoaVNQRUMuaXNCbGFuaygpKSB7DQogICAgICBpZiAoIWRiRVhUMjAyLnJlYWRBbGwoRVhUMjAyLCA2LCAxLCByZWFkQWxsUmVjb3Jkc0VYVDIwMikpIHsNCiAgICAgICAgbG9nZ2VyLmRlYnVnKCJGYWlsZWQgdG8gcmVhZCByZWNvcmRzIGluIEVYVDIwMiIpDQogICAgICB9DQogICAgfSBlbHNlIHsNCiAgICAgIGlmICghZGJFWFQyMDIucmVhZEFsbChFWFQyMDIsIDcsIDEsIHJlYWRBbGxSZWNvcmRzRVhUMjAyKSkgew0KICAgICAgICBsb2dnZXIuZGVidWcoIkZhaWxlZCB0byByZWFkIHJlY29yZHMgaW4gRVhUMjAyIikNCiAgICAgIH0NCiAgICB9DQogIH0NCn0NCg=="}}}