{"programModules":{"EXT130MI":{"program":"EXT130MI","triggers":{},"transactions":{"PrtTag":{"sourceUuid":"219e0208-e5a3-4f7e-9c21-90d8421f9d68","name":"PrtTag","program":"EXT130MI","description":"Print Tag(s)","active":true,"multi":false,"modified":1711053503916,"modifiedBy":"020964","outputFields":[],"inputFields":[{"name":"WHLO","description":"Warehouse","length":3,"mandatory":true,"type":"A"},{"name":"ITNO","description":"Item number","length":15,"mandatory":true,"type":"A"},{"name":"SBAN","description":"Sub-Lot Number","length":20,"mandatory":true,"type":"A"},{"name":"CAMU","description":"Container number","length":20,"mandatory":true,"type":"A"},{"name":"WHSL","description":"Location","length":10,"mandatory":true,"type":"A"},{"name":"TAGN","description":"Tag Number","length":3,"mandatory":false,"type":"N"},{"name":"TAGI","description":"Tag manual ID","length":20,"mandatory":false,"type":"A"},{"name":"TAGT","description":"Tag Type","length":4,"mandatory":false,"type":"A"},{"name":"NOTG","description":"Number of Tags","length":3,"mandatory":false,"type":"N"},{"name":"DEV0","description":"Output Device","length":10,"mandatory":false,"type":"A"},{"name":"BASE","description":"Lot Type(Y=BASE)","length":1,"mandatory":false,"type":"A"},{"name":"RORC","description":"Reference Order Category","length":1,"mandatory":false,"type":"N"},{"name":"RORN","description":"Reference Order","length":10,"mandatory":false,"type":"A"},{"name":"RORL","description":"Reference Order Line","length":5,"mandatory":false,"type":"N"}],"utilities":[],"market":"ALL"}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"219e0208-e5a3-4f7e-9c21-90d8421f9d68":{"uuid":"219e0208-e5a3-4f7e-9c21-90d8421f9d68","updated":1709754961007,"updatedBy":"900107","created":1711053495045,"createdBy":"020964","apiVersion":"UNKNOWN","beVersion":"16.0.0.20240116163623.6","language":"GROOVY","codeHash":"A20BC97742DD02496CFF718FEFA952D63DEE0C2CEEF413617571F35803E347EF","code":"aW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGUNCmltcG9ydCBqYXZhLnRpbWUuTG9jYWxEYXRlVGltZQ0KaW1wb3J0IGphdmEudGltZS5mb3JtYXQuRGF0ZVRpbWVGb3JtYXR0ZXINCg0KLyoqDQogKiBSRUFETUUNCiAqIFByaW50IFRhZyhzKQ0KICoNCiAqIE5hbWU6IEVYVDEzME1JLlZmeUZyZXFJdFN1DQogKiBEZXNjcmlwdGlvbjogUHJpbnQgVGFnKHMpDQogKiBEYXRlCSAgICAgIENoYW5nZWQgQnkgICAgRGVzY3JpcHRpb24NCiAqIDIwMjIxMjIyCSAgVklEVkVOICAgICAgICBQcmludCBUYWcocykNCiAqIDIwMjMwNzExICAgVklEVkVOICAgICAgICBVcGRhdGVkIFRyYXkgZGV0YWlscw0KICogMjAyNDAyMjYgICBWSURWRU4gICAgICAgIFVwZGF0ZWQgdXNlck5hbWUgJiBQcmludGVyIHRyYXkgc2V0dXAgLSBJbmNsdWRlZCBlc2NhcGVYTUxjaGFyKCkNCiAqKi8NCg0KcHVibGljIGNsYXNzIFBydFRhZyBleHRlbmRzIEV4dGVuZE0zVHJhbnNhY3Rpb24gew0KICBwcml2YXRlIGZpbmFsIE1JQVBJIG1pDQogIHByaXZhdGUgZmluYWwgRGF0YWJhc2VBUEkgZGF0YWJhc2UNCiAgcHJpdmF0ZSBmaW5hbCBMb2dnZXJBUEkgbG9nZ2VyDQogIHByaXZhdGUgZmluYWwgUHJvZ3JhbUFQSSBwcm9ncmFtDQogIHByaXZhdGUgZmluYWwgVXRpbGl0eUFQSSB1dGlsaXR5DQogIHByaXZhdGUgZmluYWwgSW9uQVBJIGlvbg0KDQogIC8vSW5wdXQgZmllbGRzDQogIHByaXZhdGUgaW50IENPTk8NCiAgcHJpdmF0ZSBTdHJpbmcgaVdITE8NCiAgcHJpdmF0ZSBTdHJpbmcgaUlUTk8NCiAgcHJpdmF0ZSBTdHJpbmcgaVNCQU4NCiAgcHJpdmF0ZSBTdHJpbmcgaUNBTVUNCiAgcHJpdmF0ZSBTdHJpbmcgaVdIU0wNCiAgcHJpdmF0ZSBTdHJpbmcgaVRBR04NCiAgcHJpdmF0ZSBTdHJpbmcgaVRBR0kNCiAgcHJpdmF0ZSBTdHJpbmcgaVRBR1QNCiAgcHJpdmF0ZSBTdHJpbmcgaU5PVEcNCiAgcHJpdmF0ZSBTdHJpbmcgaURFVjANCiAgcHJpdmF0ZSBTdHJpbmcgaUJBU0UNCiAgcHJpdmF0ZSBTdHJpbmcgaVJPUkMNCiAgcHJpdmF0ZSBTdHJpbmcgaVJPUk4NCiAgcHJpdmF0ZSBTdHJpbmcgaVJPUkwNCiAgcHJpdmF0ZSBTdHJpbmcgb3JpZ2luYWxXSExPDQogIHByaXZhdGUgU3RyaW5nIG9yaWdpbmFsU0JBTg0KICBwcml2YXRlIFN0cmluZyBvcmlnaW5hbENBTVUNCiAgcHJpdmF0ZSBTdHJpbmcgb3JpZ2luYWxXSFNMDQogIHByaXZhdGUgU3RyaW5nIENTWVBSVF9QcmludGVySUQNCiAgcHJpdmF0ZSBTdHJpbmcgQ1NZUFJUX01BSUxJRA0KICBwcml2YXRlIFN0cmluZyBNSVRUUkFfVFJRVA0KICBwcml2YXRlIFN0cmluZyBNSVRNQVNfVU5NUw0KICBwcml2YXRlIFN0cmluZyBNSVRNQVNfSVREUw0KICBwcml2YXRlIFN0cmluZyBNSVRMT0NfTE1EVA0KICBwcml2YXRlIGludCBub09mQ29waWVzDQogIHByaXZhdGUgYm9vbGVhbiBoYXNQcmludGVyU2V0dXANCiAgcHJpdmF0ZSBTdHJpbmcgcHJpbnRlclRyYXkNCiAgcHJpdmF0ZSBTdHJpbmcgdHJheUhvbGQgPSAidHJheTEiDQogIHByaXZhdGUgU3RyaW5nIHRyYXlEaXNwID0gInRyYXkyIg0KICBwcml2YXRlIFN0cmluZyB0YWdOdW1iZXINCiAgcHJpdmF0ZSBTdHJpbmcgdGFnVGV4dCA9ICIiDQogIHByaXZhdGUgU3RyaW5nIHVzZXJOYW1lDQogIHByaXZhdGUgZmluYWwgVGV4dEZpbGVzQVBJIHRleHRGaWxlczsNCg0KICBwdWJsaWMgUHJ0VGFnKElvbkFQSSBpb24sIE1JQVBJIG1pLCBEYXRhYmFzZUFQSSBkYXRhYmFzZSwgVGV4dEZpbGVzQVBJIHRleHRGaWxlcywgTG9nZ2VyQVBJIGxvZ2dlciwgUHJvZ3JhbUFQSSBwcm9ncmFtLCBVdGlsaXR5QVBJIHV0aWxpdHkpIHsNCiAgICB0aGlzLm1pID0gbWkNCiAgICB0aGlzLmRhdGFiYXNlID0gZGF0YWJhc2UNCiAgICB0aGlzLmxvZ2dlciA9IGxvZ2dlcg0KICAgIHRoaXMucHJvZ3JhbSA9IHByb2dyYW0NCiAgICB0aGlzLnV0aWxpdHkgPSB1dGlsaXR5DQogICAgdGhpcy5pb24gPSBpb24NCiAgICB0aGlzLnRleHRGaWxlcyA9IHRleHRGaWxlcw0KICB9DQoNCiAgLyoqDQogICAqIE1haW4gbWV0aG9kDQogICAqIEBwYXJhbQ0KICAgKiBAcmV0dXJuDQogICAqLw0KICBwdWJsaWMgdm9pZCBtYWluKCkgew0KICAgIGlXSExPID0gbWkuaW5EYXRhLmdldCgiV0hMTyIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIldITE8iKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlJVE5PID0gbWkuaW5EYXRhLmdldCgiSVROTyIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIklUTk8iKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlTQkFOID0gbWkuaW5EYXRhLmdldCgiU0JBTiIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlNCQU4iKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlDQU1VID0gbWkuaW5EYXRhLmdldCgiQ0FNVSIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkNBTVUiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlXSFNMID0gbWkuaW5EYXRhLmdldCgiV0hTTCIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIldIU0wiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlUQUdOID0gbWkuaW5EYXRhLmdldCgiVEFHTiIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlRBR04iKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlUQUdJID0gbWkuaW5EYXRhLmdldCgiVEFHSSIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlRBR0kiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlUQUdUID0gbWkuaW5EYXRhLmdldCgiVEFHVCIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlRBR1QiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlOT1RHID0gbWkuaW5EYXRhLmdldCgiTk9URyIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIk5PVEciKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlERVYwID0gbWkuaW5EYXRhLmdldCgiREVWMCIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkRFVjAiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlCQVNFID0gbWkuaW5EYXRhLmdldCgiQkFTRSIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkJBU0UiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlST1JDID0gbWkuaW5EYXRhLmdldCgiUk9SQyIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlJPUkMiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlST1JOID0gbWkuaW5EYXRhLmdldCgiUk9STiIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlJPUk4iKS50b1N0cmluZygpLnRyaW0oKQ0KICAgIGlST1JMID0gbWkuaW5EYXRhLmdldCgiUk9STCIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlJPUkwiKS50b1N0cmluZygpLnRyaW0oKQ0KDQogICAgbG9nZ2VyLmRlYnVnKCJJbnB1dHM6IGlXSExPOiAiICsgaVdITE8udG9TdHJpbmcoKS50cmltKCkgKyAiIC0tIGlJVE5POiAiICsgaUlUTk8udG9TdHJpbmcoKS50cmltKCkgKyAiIC0tIGlTQkFOOiAiICsgaVNCQU4udG9TdHJpbmcoKS50cmltKCkgKyAiIC0tIGlDQU1VOiAiICsgaUNBTVUudG9TdHJpbmcoKS50cmltKCkgKyAiIC0tIGlXSFNMOiAiICsgaVdIU0wudG9TdHJpbmcoKS50cmltKCkgKyAiIC0tIGlUQUdOOiAiICsgaVRBR04udG9TdHJpbmcoKS50cmltKCkgKyAiIC0taVRBR0k6ICIgKyBpVEFHSS50b1N0cmluZygpLnRyaW0oKSArICIgLS0gaVRBR1Q6ICIgKyBpVEFHVC50b1N0cmluZygpLnRyaW0oKSArICIgLS0gaU5PVEc6ICIgKyBpTk9URy50b1N0cmluZygpLnRyaW0oKSArICIgLS1pQkFTRTogIiArIGlCQVNFLnRvU3RyaW5nKCkudHJpbSgpICsgIiAtLWlST1JDOiAiICsgaVJPUkMudG9TdHJpbmcoKS50cmltKCkgKyAiIC0taVJPUk46ICIgKyBpUk9STi50b1N0cmluZygpLnRyaW0oKSArICIgLS1pUk9STDogIiArIGlST1JMLnRvU3RyaW5nKCkudHJpbSgpKQ0KDQogICAgQ09OTyA9IHByb2dyYW0uTERBWkQuQ09OTy50b1N0cmluZygpLnRvSW50ZWdlcigpDQoNCiAgICBvcmlnaW5hbFdITE8gPSBpV0hMTy50cmltKCkNCiAgICBvcmlnaW5hbFNCQU4gPSBpU0JBTi50cmltKCkNCiAgICBvcmlnaW5hbENBTVUgPSBpQ0FNVS50cmltKCkNCiAgICBvcmlnaW5hbFdIU0wgPSBpV0hTTC50cmltKCkNCiAgICBpZiAoSW50ZWdlci5wYXJzZUludChpTk9URy50cmltKCkpID4gMCkgew0KICAgICAgbm9PZkNvcGllcyA9IEludGVnZXIucGFyc2VJbnQoaU5PVEcudHJpbSgpKQ0KICAgIH0gZWxzZSB7DQogICAgICBub09mQ29waWVzID0gMQ0KICAgIH0NCiAgICBpZiAoaVRBR04gPT0gbnVsbCB8fCBpVEFHTi5pc0VtcHR5KCkpIHsNCiAgICAgIGlUQUdOID0gdGFnTnVtYmVyID0gIjAiDQogICAgfQ0KDQogICAgLy9HZXQgdXNlcnMgcHJpbnRlcg0KICAgIERCQWN0aW9uIGRiQ1NGREVGID0gZGF0YWJhc2UudGFibGUoIkNTRkRFRiIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiU0ZDT05PIiwiU0ZESVZJIiwiU0ZQUlRGIiwiU0ZVU0lEIiwiU0ZERVZEIiwiU0ZTRVFOIiwiU0ZERVYiKS5idWlsZCgpDQogICAgREJDb250YWluZXIgQ1NGREVGID0gZGJDU0ZERUYuZ2V0Q29udGFpbmVyKCkNCiAgICBDU0ZERUYuc2V0KCJTRkNPTk8iLCBDT05PKQ0KICAgIENTRkRFRi5zZXQoIlNGRElWSSIsICJSRlAiKQ0KICAgIENTRkRFRi5zZXQoIlNGUFJURiIsICJRTVo0NTBQRiIpDQogICAgQ1NGREVGLnNldCgiU0ZVU0lEIiwgcHJvZ3JhbS5nZXRVc2VyKCkudG9TdHJpbmcoKS50cmltKCkpDQogICAgQ1NGREVGLnNldCgiU0ZERVZEIiwgIiIpDQogICAgQ1NGREVGLnNldCgiU0ZNRURDIiwgIipQUlQiKQ0KICAgIENTRkRFRi5zZXQoIlNGU0VRTiIsIDEgYXMgaW50KQ0KICAgIGlmIChkYkNTRkRFRi5yZWFkKENTRkRFRikpIHsNCiAgICAgIGhhc1ByaW50ZXJTZXR1cCA9IHRydWUNCiAgICAgIGlERVYwID0gQ1NGREVGLmdldCgiU0ZERVYiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgICAgbG9nZ2VyLmRlYnVnKCJVc2VyIGhhcyBhbiBhc3NpZ25lZCBwcmludGVyIGZvciBRTVo0NTBQRjoiICsgaURFVjApDQoNCiAgICAgIC8vR2V0IHByaW50ZXIgdHJheSBkZXRhaWxzDQogICAgICBEQkFjdGlvbiBkYk1CTVRSRCA9IGRhdGFiYXNlLnRhYmxlKCJNQk1UUkQiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIlREQ09OTyIsIlRERElWSSIsIlRESURUUiIsIlRETVZYUCIsIlRERVhUUCIsIlRETVZYRCIsIlRETUJNRCIpLmJ1aWxkKCkNCiAgICAgIERCQ29udGFpbmVyIE1CTVRSRCA9IGRiTUJNVFJELmdldENvbnRhaW5lcigpDQogICAgICBNQk1UUkQuc2V0KCJURENPTk8iLCBDT05PKQ0KICAgICAgTUJNVFJELnNldCgiVERESVZJIiwgIlJGUCIpDQogICAgICBNQk1UUkQuc2V0KCJURElEVFIiLCAiMTUyMCIudG9JbnRlZ2VyKCkpDQogICAgICBNQk1UUkQuc2V0KCJURE1WWFAiLCAiIikNCiAgICAgIE1CTVRSRC5zZXQoIlRERVhUUCIsIGlERVYwLnRyaW0oKSkNCiAgICAgIA0KICAgICAgLyoqDQogICAgICAgICAqIENsb3N1cmUgdG8gcmVhZCBNQk1UUkQqLw0KICAgICAgICBDbG9zdXJlIDwgPyA+IENhbGxCYWNrX01CTVRSRCA9IHsNCiAgICAgICAgICBEQkNvbnRhaW5lciByZXN1bHRDb250YWluZXIgLT4NCiAgICAgICAgICB0cmF5SG9sZCA9IHJlc3VsdENvbnRhaW5lci5nZXQoIlRETVZYRCIpLnRvU3RyaW5nKCkudHJpbSgpDQogICAgICAgICAgdHJheURpc3AgPSByZXN1bHRDb250YWluZXIuZ2V0KCJURE1CTUQiKS50b1N0cmluZygpLnRyaW0oKQ0KICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiVHJheSBkZXRhaWxzIGZvdW5kIGluIENSUzg4MSBmb3IgcHJpbnRlcjogIiArIGlERVYwLnRyaW0oKSArICIgYXMgSE9MRCAtICIgKyB0cmF5SG9sZC50cmltKCkgKyAiIGFuZCBESVNQIC0gIiArIHRyYXlEaXNwLnRyaW0oKSkNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWRiTUJNVFJELnJlYWRBbGwoTUJNVFJELCA1LCAxLCBDYWxsQmFja19NQk1UUkQpKSB7DQogICAgICAgICBsb2dnZXIuZGVidWcoIlRyYXkgZGV0YWlscyBub3QgZm91bmQgaW4gQ1JTODgxIGZvciBwcmludGVyOiAiICsgaURFVjAudHJpbSgpICsgIi0gRGVmYXVsdCB0cmF5cyAodHJheTEgJiB0cmF5Mikgc2VsZWN0ZWQiKQ0KICAgICAgICB9DQogICAgICANCiAgICB9IGVsc2Ugew0KICAgICAgaGFzUHJpbnRlclNldHVwID0gZmFsc2UNCiAgICAgIGxvZ2dlci5kZWJ1ZygiVXNlciBub3QgYXNzaWduZWQgd2l0aCBhIHByaW50ZXIgZm9yIFFNWjQ1MFBGIC0gVXNlciB0aGUgZW1haWwgaW5zdGVhZCIpDQogICAgICBEQkFjdGlvbiBkYkNTRkRFRl9NQUlMID0gZGF0YWJhc2UudGFibGUoIkNTRkRFRiIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiU0ZDT05PIiwiU0ZESVZJIiwiU0ZQUlRGIiwiU0ZVU0lEIiwiU0ZERVZEIiwiU0ZTRVFOIiwiU0ZUT01BIikuYnVpbGQoKQ0KICAgICAgREJDb250YWluZXIgQ1NGREVGX01BSUwgPSBkYkNTRkRFRl9NQUlMLmdldENvbnRhaW5lcigpDQogICAgICBDU0ZERUZfTUFJTC5zZXQoIlNGQ09OTyIsIENPTk8pDQogICAgICBDU0ZERUZfTUFJTC5zZXQoIlNGRElWSSIsICJSRlAiKQ0KICAgICAgQ1NGREVGX01BSUwuc2V0KCJTRlVTSUQiLCBwcm9ncmFtLmdldFVzZXIoKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgIENTRkRFRl9NQUlMLnNldCgiU0ZQUlRGIiwgIlFNWjQ1MFBGIikNCiAgICAgIENTRkRFRl9NQUlMLnNldCgiU0ZERVZEIiwgIiIpDQogICAgICBDU0ZERUZfTUFJTC5zZXQoIlNGTUVEQyIsICIqTUFJTCIpDQogICAgICBDU0ZERUZfTUFJTC5zZXQoIlNGU0VRTiIsIDEgYXMgaW50KQ0KICAgICAgaWYgKGRiQ1NGREVGX01BSUwucmVhZChDU0ZERUZfTUFJTCkpIHsNCiAgICAgICAgQ1NZUFJUX01BSUxJRCA9IENTRkRFRl9NQUlMLmdldCgiU0ZUT01BIikudG9TdHJpbmcoKS50cmltKCkNCiAgICAgICAgbG9nZ2VyLmRlYnVnKCJVc2VyIGVtYWlsOiIgKyBDU1lQUlRfTUFJTElEKQ0KICAgICAgfQ0KICAgIH0NCg0KICAgIGlmIChpVEFHVCA9PSAiSE9MRCIpIHsNCiAgICAgIHByaW50ZXJUcmF5ID0gdHJheUhvbGQNCiAgICB9IGVsc2Ugew0KICAgICAgcHJpbnRlclRyYXkgPSB0cmF5RGlzcA0KICAgIH0NCg0KICAgIGlmICh2YWxpZGF0ZUlucHV0cyhDT05PLCBpSVROTywgb3JpZ2luYWxXSExPLCBvcmlnaW5hbFNCQU4sIG9yaWdpbmFsQ0FNVSwgb3JpZ2luYWxXSFNMLCBpVEFHVCwgaUJBU0UpKSB7DQogICAgICBsb2dnZXIuZGVidWcoIklucHV0cyBhcmUgdmFsaWQgLSBwcm9jZXNzaW5nIikNCiAgICAgIGlmICghaURFVjAudHJpbSgpLmlzRW1wdHkoKSkgew0KICAgICAgICAvL0NoZWNrIGlmIFByaW50ZXIgaWRlbnRpdHkgZXhpc3RzDQogICAgICAgIC8vR2V0IHByaW50ZXIgSUQgZm9yIHByaW50aW5nIHRhZw0KICAgICAgICBEQkFjdGlvbiBkYkNTWVBSVCA9IGRhdGFiYXNlLnRhYmxlKCJDU1lQUlQiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIkNTQ09OTyIsIkNTUFJJVCIsIkNTSURQUiIpLmJ1aWxkKCkNCiAgICAgICAgREJDb250YWluZXIgQ1NZUFJUID0gZGJDU1lQUlQuZ2V0Q29udGFpbmVyKCkNCiAgICAgICAgQ1NZUFJULnNldCgiQ1NDT05PIiwgQ09OTykNCiAgICAgICAgQ1NZUFJULnNldCgiQ1NQUklUIiwgaURFVjApDQogICAgICAgIGlmIChkYkNTWVBSVC5yZWFkKENTWVBSVCkpIHsNCiAgICAgICAgICBDU1lQUlRfUHJpbnRlcklEID0gQ1NZUFJULmdldCgiQ1NJRFBSIikudG9TdHJpbmcoKQ0KICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiUHJpbnRlciBJRCBJZGVudGlmaWVkOiAiICsgQ1NZUFJUX1ByaW50ZXJJRCkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBtaS5lcnJvcigiUHJpbnRlciAiICsgaURFVjAudHJpbSgpICsgIiBkb2VzIG5vdCBleGlzdCIpDQogICAgICAgICAgcmV0dXJuDQogICAgICAgIH0NCiAgICAgICAgDQogICAgICAgIERCQWN0aW9uIGRiQ01OVVNSID0gZGF0YWJhc2UudGFibGUoIkNNTlVTUiIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiSlVDT05PIiwiSlVESVZJIiwiSlVVU0lEIiwiSlVUWDQwIikuYnVpbGQoKQ0KICAgICAgICBEQkNvbnRhaW5lciBDTU5VU1IgPSBkYkNNTlVTUi5nZXRDb250YWluZXIoKQ0KICAgICAgICBDTU5VU1Iuc2V0KCJKVUNPTk8iLCAiMCIudG9JbnRlZ2VyKCkpDQogICAgICAgIENNTlVTUi5zZXQoIkpVRElWSSIsICIiKQ0KICAgICAgICBDTU5VU1Iuc2V0KCJKVVVTSUQiLCBwcm9ncmFtLmdldFVzZXIoKS50b1N0cmluZygpLnRyaW0oKSkNCiAgICAgICAgaWYgKGRiQ01OVVNSLnJlYWQoQ01OVVNSKSkgew0KICAgICAgICAgIHVzZXJOYW1lID0gQ01OVVNSLmdldCgiSlVUWDQwIikudG9TdHJpbmcoKQ0KICAgICAgICB9DQogICAgICB9DQogICAgICAvL01JVFRSQSBaNCBpbmRleA0KICAgICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwcmVzc2lvbiA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJNSVRUUkEiKQ0KICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uZXEoIk1UQ0FNVSIsIGlDQU1VKS5hbmQoZXhwcmVzc2lvbi5lcSgiTVRXSFNMIiwgaVdIU0wpKQ0KDQogICAgICBEQkFjdGlvbiBkYk1JVFRSQSA9IGRhdGFiYXNlLnRhYmxlKCJNSVRUUkEiKS5pbmRleCgiOTAiKS5tYXRjaGluZyhleHByZXNzaW9uKS5zZWxlY3Rpb24oIk1UQ09OTyIsIk1UV0hMTyIsIk1USVROTyIsIk1UQkFOTyIsIk1UVFJRVCIpLmJ1aWxkKCkNCiAgICAgIERCQ29udGFpbmVyIE1JVFRSQSA9IGRiTUlUVFJBLmdldENvbnRhaW5lcigpDQogICAgICBNSVRUUkEuc2V0KCJNVENPTk8iLCBDT05PKQ0KICAgICAgTUlUVFJBLnNldCgiTVRXSExPIiwgaVdITE8udHJpbSgpKQ0KICAgICAgTUlUVFJBLnNldCgiTVRJVE5PIiwgaUlUTk8udHJpbSgpKQ0KICAgICAgTUlUVFJBLnNldCgiTVRCQU5PIiwgaVNCQU4udHJpbSgpKQ0KICAgICAgQ2xvc3VyZSA8ID8gPiByZWFkQWxsUmVjb3Jkc01JVFRSQSA9IHsNCiAgICAgICAgREJDb250YWluZXIgcmVzdWx0Q29udGFpbmVyIC0+DQogICAgICAgIGxvZ2dlci5kZWJ1ZygiRW50ZXJlZCBNSVRUUkE5MCIpDQogICAgICAgIE1JVFRSQV9UUlFUID0gcmVzdWx0Q29udGFpbmVyLmdldCgiTVRUUlFUIikudG9TdHJpbmcoKQ0KICAgICAgICBsb2dnZXIuZGVidWcoIk1JVFRSQV9UUlFUOiAiICsgTUlUVFJBX1RSUVQpDQogICAgICAgIC8vQ2hlY2sgWlRBR0xHIC0gRVhUNDAyDQogICAgICAgIEV4cHJlc3Npb25GYWN0b3J5IGV4cHJlc3Npb25fRVhUNDAyID0gZGF0YWJhc2UuZ2V0RXhwcmVzc2lvbkZhY3RvcnkoIkVYVDQwMiIpDQogICAgICAgIGV4cHJlc3Npb25fRVhUNDAyID0gZXhwcmVzc2lvbl9FWFQ0MDIuZXEoIkVYVEFHVCIsIGlUQUdULnRyaW0oKSkNCiAgICAgICAgREJBY3Rpb24gZGJFWFQ0MDIgPSBkYXRhYmFzZS50YWJsZSgiRVhUNDAyIikuaW5kZXgoIjAwIikubWF0Y2hpbmcoZXhwcmVzc2lvbl9FWFQ0MDIpLnNlbGVjdGlvbigiRVhDT05PIiwiRVhJVE5PIiwiRVhTQkFOIiwiRVhDQU1VIiwiRVhUQUdOIiwiRVhDSE5PIiwiRVhMTURUIiwiRVhDSElEIikuYnVpbGQoKQ0KICAgICAgICBEQkNvbnRhaW5lciBFWFQ0MDIgPSBkYkVYVDQwMi5nZXRDb250YWluZXIoKQ0KICAgICAgICBFWFQ0MDIuc2V0KCJFWENPTk8iLCBDT05PKQ0KICAgICAgICBFWFQ0MDIuc2V0KCJFWElUTk8iLCBpSVROTy50cmltKCkpDQogICAgICAgIEVYVDQwMi5zZXQoIkVYU0JBTiIsIG9yaWdpbmFsU0JBTi50cmltKCkpDQogICAgICAgIEVYVDQwMi5zZXQoIkVYQ0FNVSIsIG9yaWdpbmFsQ0FNVS50cmltKCkpDQogICAgICAgIGxvZ2dlci5kZWJ1ZygiVEFHSSBoZXJlOiAiICsgaVRBR0kpDQogICAgICAgIGlmIChJbnRlZ2VyLnBhcnNlSW50KGlUQUdOLnRyaW0oKSkgPiAwKSB7DQogICAgICAgICAgbG9nZ2VyLmRlYnVnKCJFbnRlcmVkIGlUQUdOID4gMCIpDQogICAgICAgICAgRVhUNDAyLnNldCgiRVhUQUdOIiwgaVRBR04udHJpbSgpIGFzIGludCkNCiAgICAgICAgICB0YWdOdW1iZXIgPSBpVEFHTi50cmltKCkNCiAgICAgICAgICAvKioNCiAgICAgICAgICAgKiBDbG9zdXJlIHRvIHVwZGF0ZSBFWFQ0MDIqLw0KICAgICAgICAgIENsb3N1cmUgPCA/ID4gdXBkYXRlQ2FsbEJhY2tfRVhUNDAyID0gew0KICAgICAgICAgICAgTG9ja2VkUmVzdWx0IGxvY2tlZFJlc3VsdEVYVDQwMiAtPg0KICAgICAgICAgICAgaW50IGNoYW5nZU51bWJlciA9IGxvY2tlZFJlc3VsdEVYVDQwMi5nZXRJbnQoIkVYQ0hOTyIpDQogICAgICAgICAgICBpbnQgbmV3Q2hhbmdlTnVtYmVyID0gY2hhbmdlTnVtYmVyICsgMQ0KICAgICAgICAgICAgRVhUNDAyLnNldCgiRVhUQUdOIiwgaVRBR04gYXMgaW50KQ0KICAgICAgICAgICAgRVhUNDAyLnNldCgiRVhMTURUIiwgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpKQ0KICAgICAgICAgICAgRVhUNDAyLnNldCgiRVhDSE5PIiwgbmV3Q2hhbmdlTnVtYmVyKQ0KICAgICAgICAgICAgRVhUNDAyLnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpDQogICAgICAgICAgICBsb2NrZWRSZXN1bHRFWFQ0MDIudXBkYXRlKCkNCiAgICAgICAgICB9DQogICAgICAgICAgaWYgKCFkYkVYVDQwMi5yZWFkQWxsTG9jayhFWFQ0MDIsIDUsIHVwZGF0ZUNhbGxCYWNrX0VYVDQwMikpIHsNCiAgICAgICAgICAgIG1pLmVycm9yKCJUYWcgaXMgbWlzc2luZyEiKQ0KICAgICAgICAgICAgcmV0dXJuDQogICAgICAgICAgfQ0KICAgICAgICB9IC8vd2hlbiBUQUdOICE+IDANCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgaWYgKCFpVEFHSS5pc0VtcHR5KCkpIHsNCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiVEFHSSBpcyBOT1QgRW1wdHkgLSBmaW5kaW5nIEVYVDQwMiByZWNvcmQiKQ0KICAgICAgICAgICAgRXhwcmVzc2lvbkZhY3RvcnkgZXhwcmVzc2lvbl9FWFQ0MDJfMSA9IGRhdGFiYXNlLmdldEV4cHJlc3Npb25GYWN0b3J5KCJFWFQ0MDIiKQ0KICAgICAgICAgICAgZXhwcmVzc2lvbl9FWFQ0MDJfMSA9IGV4cHJlc3Npb25fRVhUNDAyXzEuZXEoIkVYVEFHVCIsIGlUQUdULnRyaW0oKSkNCiAgICAgICAgICAgIERCQWN0aW9uIGRiRVhUNDAyX3VwZGF0ZSA9IGRhdGFiYXNlLnRhYmxlKCJFWFQ0MDIiKS5pbmRleCgiMDAiKS5tYXRjaGluZyhleHByZXNzaW9uX0VYVDQwMl8xKS5zZWxlY3Rpb24oIkVYQ09OTyIsIkVYSVROTyIsIkVYU0JBTiIsIkVYQ0FNVSIsIkVYVEFHTiIsIkVYVEFHSSIsIkVYQ0hOTyIsIkVYTE1EVCIsIkVYQ0hJRCIpLmJ1aWxkKCkNCiAgICAgICAgICAgIERCQ29udGFpbmVyIEVYVDQwMl91cGRhdGUgPSBkYkVYVDQwMl91cGRhdGUuZ2V0Q29udGFpbmVyKCkNCiAgICAgICAgICAgIEVYVDQwMl91cGRhdGUuc2V0KCJFWENPTk8iLCBDT05PKQ0KICAgICAgICAgICAgRVhUNDAyX3VwZGF0ZS5zZXQoIkVYSVROTyIsIGlJVE5PLnRyaW0oKSkNCiAgICAgICAgICAgIEVYVDQwMl91cGRhdGUuc2V0KCJFWFNCQU4iLCBvcmlnaW5hbFNCQU4udHJpbSgpKQ0KICAgICAgICAgICAgRVhUNDAyX3VwZGF0ZS5zZXQoIkVYQ0FNVSIsIG9yaWdpbmFsQ0FNVS50cmltKCkpDQogICAgICAgICAgICBFWFQ0MDJfdXBkYXRlLnNldCgiRVhUQUdOIiwgJzAnDQogICAgICAgICAgICAgIGFzIGludCkNCiAgICAgICAgICAgIEVYVDQwMl91cGRhdGUuc2V0KCJFWFRBR0kiLCBpVEFHSS50cmltKCkpDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIENsb3N1cmUgdG8gdXBkYXRlIEVYVDQwMiovDQogICAgICAgICAgICBDbG9zdXJlIDwgPyA+IHVwZGF0ZUNhbGxCYWNrX0VYVDQwMiA9IHsNCiAgICAgICAgICAgICAgTG9ja2VkUmVzdWx0IGxvY2tlZFJlc3VsdEVYVDQwMiAtPg0KICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoIlRBR0kgaXMgTk9UIEVtcHR5IHJlY29yZCBmb3VuZCAtIHVwZGF0aW5nIEVYVDQwMiByZWNvcmQiKQ0KICAgICAgICAgICAgICBFWFQ0MDJfdXBkYXRlLnNldCgiRVhUQUdOIiwgMSkNCiAgICAgICAgICAgICAgdGFnTnVtYmVyID0gIjEiDQogICAgICAgICAgICAgIEVYVDQwMl91cGRhdGUuc2V0KCJFWFRBR0kiLCBpVEFHSS50cmltKCkpDQogICAgICAgICAgICAgIGludCBjaGFuZ2VOdW1iZXIgPSBsb2NrZWRSZXN1bHRFWFQ0MDIuZ2V0KCJFWENITk8iKS50b1N0cmluZygpLnRvSW50ZWdlcigpDQogICAgICAgICAgICAgIGludCBuZXdDaGFuZ2VOdW1iZXIgPSBjaGFuZ2VOdW1iZXIgKyAxDQogICAgICAgICAgICAgIEVYVDQwMl91cGRhdGUuc2V0KCJFWExNRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkudG9JbnRlZ2VyKCkpDQogICAgICAgICAgICAgIEVYVDQwMl91cGRhdGUuc2V0KCJFWENITk8iLCBuZXdDaGFuZ2VOdW1iZXIpDQogICAgICAgICAgICAgIEVYVDQwMl91cGRhdGUuc2V0KCJFWENISUQiLCBwcm9ncmFtLmdldFVzZXIoKSkNCiAgICAgICAgICAgICAgbG9ja2VkUmVzdWx0RVhUNDAyLnVwZGF0ZSgpDQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIWRiRVhUNDAyX3VwZGF0ZS5yZWFkQWxsTG9jayhFWFQ0MDJfdXBkYXRlLCA2LCB1cGRhdGVDYWxsQmFja19FWFQ0MDIpKSB7DQogICAgICAgICAgICAgIC8vDQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICAgIGlmIChpVEFHSS5pc0VtcHR5KCkpIHsNCiAgICAgICAgICAgIC8vUmVhZCBwcmV2aW91cyByZWNvcmQNCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiVEFHSSBpcyBFbXB0eSAtIHRyeWluZyB0byBmaW5kIEVYVDQwMiByZWNvcmQgYWdhaW4iKQ0KICAgICAgICAgICAgREJBY3Rpb24gYWN0aW9uRVhUNDAyX0luc2VydCA9IGRhdGFiYXNlLnRhYmxlKCJFWFQ0MDIiKS5pbmRleCgiMDAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQogICAgICAgICAgICBEQkNvbnRhaW5lciBjb250YWluZXJFWFQ0MDJfSW5zZXJ0ID0gYWN0aW9uRVhUNDAyX0luc2VydC5nZXRDb250YWluZXIoKQ0KDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDJfSW5zZXJ0LnNldCgiRVhDT05PIiwgQ09OTykNCiAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMl9JbnNlcnQuc2V0KCJFWElUTk8iLCBpSVROTy50cmltKCkpDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDJfSW5zZXJ0LnNldCgiRVhTQkFOIiwgb3JpZ2luYWxTQkFOLnRyaW0oKSkNCiAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMl9JbnNlcnQuc2V0KCJFWENBTVUiLCBvcmlnaW5hbENBTVUudHJpbSgpKQ0KDQogICAgICAgICAgICAvKioNCiAgICAgICAgICAgICAqIENsb3N1cmUgZm9yIEVYVDQwMiBVcGRhdGUqLw0KICAgICAgICAgICAgQ2xvc3VyZSA8ID8gPiB1cGRhdGVDYWxsQmFjayA9IHsNCiAgICAgICAgICAgICAgTG9ja2VkUmVzdWx0IGxvY2tlZFJlc3VsdCAtPg0KICAgICAgICAgICAgICBsb2dnZXIuZGVidWcoIlRBR0kgaXMgRW1wdHkgIC0gZm91bmQgRVhUNDAyIHJlY29yZCAtIHRyeWluZyB0byB1cGRhdGUgRVhUNDAyIHJlY29yZCIpDQogICAgICAgICAgICAgIGludCBjaGFuZ2VOdW1iZXIgPSBsb2NrZWRSZXN1bHQuZ2V0KCJFWENITk8iKS50b1N0cmluZygpIGFzIGludA0KICAgICAgICAgICAgICBpbnQgbmV3Q2hhbmdlTnVtYmVyID0gY2hhbmdlTnVtYmVyICsgMQ0KICAgICAgICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWFRBR04iLCAoSW50ZWdlci5wYXJzZUludChsb2NrZWRSZXN1bHQuZ2V0KCJFWFRBR04iKS50b1N0cmluZygpKSArIDEpKQ0KICAgICAgICAgICAgICB0YWdOdW1iZXIgPSBTdHJpbmcudmFsdWVPZihJbnRlZ2VyLnBhcnNlSW50KGxvY2tlZFJlc3VsdC5nZXQoIkVYVEFHTiIpLnRvU3RyaW5nKCkpICsgMSkNCiAgICAgICAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhUQUdJIiwgIiIpDQogICAgICAgICAgICAgIC8vIFVwZGF0ZSBjaGFuZ2VkIGluZm9ybWF0aW9uDQogICAgICAgICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYTE1EVCIsIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJ5eXl5TU1kZCIpKSBhcyBpbnQpDQogICAgICAgICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQ0hOTyIsIG5ld0NoYW5nZU51bWJlcikNCiAgICAgICAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpDQogICAgICAgICAgICAgIGxvY2tlZFJlc3VsdC51cGRhdGUoKQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoIWFjdGlvbkVYVDQwMl9JbnNlcnQucmVhZExvY2soY29udGFpbmVyRVhUNDAyX0luc2VydCwgdXBkYXRlQ2FsbEJhY2spKSB7DQogICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiVEFHSSBpcyBFbXB0eSAgLXJlY29yZCBub3QgZm91bmQgaW4gRVhUNDAyIC0gaW5zdGVydGluZyByZWNvcmQiKQ0KICAgICAgICAgICAgICBTdHJpbmcgc2V0QkFOTyA9IG9yaWdpbmFsU0JBTg0KICAgICAgICAgICAgICBpZiAob3JpZ2luYWxTQkFOLmNvbnRhaW5zKCJ8IikpIHsNCiAgICAgICAgICAgICAgICBzZXRCQU5PID0gb3JpZ2luYWxTQkFOLnN1YnN0cmluZygwLCBvcmlnaW5hbFNCQU4ubGFzdEluZGV4T2YoInwiKSkNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBjb250YWluZXJFWFQ0MDJfSW5zZXJ0LnNldCgiRVhJVE5PIiwgaUlUTk8udHJpbSgpKQ0KICAgICAgICAgICAgICBjb250YWluZXJFWFQ0MDJfSW5zZXJ0LnNldCgiRVhTQkFOIiwgb3JpZ2luYWxTQkFOLnRyaW0oKSkNCiAgICAgICAgICAgICAgY29udGFpbmVyRVhUNDAyX0luc2VydC5zZXQoIkVYQ0FNVSIsIG9yaWdpbmFsQ0FNVSkNCiAgICAgICAgICAgICAgY29udGFpbmVyRVhUNDAyX0luc2VydC5zZXQoIkVYVEFHTiIsICcxJw0KICAgICAgICAgICAgICAgIGFzIGludCkNCiAgICAgICAgICAgICAgdGFnTnVtYmVyID0gIjEiDQogICAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMl9JbnNlcnQuc2V0KCJFWFRBR0kiLCBpVEFHSS50cmltKCkpDQogICAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMl9JbnNlcnQuc2V0KCJFWEJBTk8iLCBzZXRCQU5PLnRyaW0oKSkNCiAgICAgICAgICAgICAgaWYgKCFpUk9SQy5pc0VtcHR5KCkpIGNvbnRhaW5lckVYVDQwMl9JbnNlcnQuc2V0KCJFWFJPUkMiLCAoSW50ZWdlci5wYXJzZUludChpUk9SQy50cmltKCkpKSkNCiAgICAgICAgICAgICAgaWYgKCFpUk9STi5pc0VtcHR5KCkpIGNvbnRhaW5lckVYVDQwMl9JbnNlcnQuc2V0KCJFWFJPUk4iLCBpUk9STi50cmltKCkpOw0KICAgICAgICAgICAgICBpZiAoIWlST1JMLmlzRW1wdHkoKSkgY29udGFpbmVyRVhUNDAyX0luc2VydC5zZXQoIkVYUk9STCIsIChJbnRlZ2VyLnBhcnNlSW50KGlST1JMLnRyaW0oKSkpKQ0KICAgICAgICAgICAgICBjb250YWluZXJFWFQ0MDJfSW5zZXJ0LnNldCgiRVhQUkRUIiwgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oInl5eXlNTWRkIikpLnRvSW50ZWdlcigpKQ0KICAgICAgICAgICAgICBjb250YWluZXJFWFQ0MDJfSW5zZXJ0LnNldCgiRVhQUlRNIiwgTG9jYWxEYXRlVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkudG9JbnRlZ2VyKCkpDQogICAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMl9JbnNlcnQuc2V0KCJFWFRBR1QiLCBpVEFHVC50cmltKCkpDQogICAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMl9JbnNlcnQuc2V0KCJFWE5PVEciLCBub09mQ29waWVzKQ0KICAgICAgICAgICAgICBjb250YWluZXJFWFQ0MDJfSW5zZXJ0LnNldCgiRVhSRVNQIiwgcHJvZ3JhbS5nZXRVc2VyKCkpDQogICAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMl9JbnNlcnQuc2V0KCJFWENPTkYiLCAnMCcNCiAgICAgICAgICAgICAgICBhcyBpbnQpDQogICAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMl9JbnNlcnQuc2V0KCJFWExNRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigieXl5eU1NZGQiKSkgYXMgaW50KQ0KICAgICAgICAgICAgICBjb250YWluZXJFWFQ0MDJfSW5zZXJ0LnNldCgiRVhDSE5PIiwgMCkNCiAgICAgICAgICAgICAgY29udGFpbmVyRVhUNDAyX0luc2VydC5zZXQoIkVYQ0hJRCIsIHByb2dyYW0uZ2V0VXNlcigpKQ0KDQogICAgICAgICAgICAgIGFjdGlvbkVYVDQwMl9JbnNlcnQuaW5zZXJ0KGNvbnRhaW5lckVYVDQwMl9JbnNlcnQpDQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICBtaS5lcnJvcigiRmFpbGVkIHRvIGluc2VydCByZWNvcmQiKQ0KICAgICAgICAgICAgICByZXR1cm4NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGlmICghZGJNSVRUUkEucmVhZEFsbChNSVRUUkEsIDQsIDEsIHJlYWRBbGxSZWNvcmRzTUlUVFJBKSkgew0KICAgICAgICBsb2dnZXIuZGVidWcoIkZhaWxlZCB0byByZWFkIE1JVFRSQSIpDQogICAgICB9DQoNCiAgICAgIC8vR2V0IHRleHQNCiAgICAgIERCQWN0aW9uIGFjdGlvbk1JTE9NQSA9IGRhdGFiYXNlLnRhYmxlKCJNSUxPTUEiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIkxNQ09OTyIsIkxNSVROTyIsIkxNQkFOTyIsIkxNVFhJRCIpLmJ1aWxkKCkNCiAgICAgIERCQ29udGFpbmVyIGNvbnRhaW5lck1JTE9NQSA9IGFjdGlvbk1JTE9NQS5nZXRDb250YWluZXIoKQ0KICAgICAgY29udGFpbmVyTUlMT01BLnNldCgiTE1DT05PIiwgQ09OTyBhcyBpbnQpDQogICAgICBjb250YWluZXJNSUxPTUEuc2V0KCJMTUlUTk8iLCBpSVROTy50cmltKCkpDQogICAgICBjb250YWluZXJNSUxPTUEuc2V0KCJMTUJBTk8iLCBpU0JBTi50cmltKCkpDQogICAgICBpZiAoYWN0aW9uTUlMT01BLnJlYWQoY29udGFpbmVyTUlMT01BKSkgew0KICAgICAgICBEQkFjdGlvbiBhY3Rpb25NU1lUWEwgPSBkYXRhYmFzZS50YWJsZSgiTVNZVFhMIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJUTENPTk8iLCJUTERJVkkiLCJUTFRYSUQiLCJUTFRYVlIiLCJUTFRYNjAiKS5idWlsZCgpDQogICAgICAgIERCQ29udGFpbmVyIGNvbnRhaW5lck1TWVRYTCA9IGFjdGlvbk1TWVRYTC5nZXRDb250YWluZXIoKQ0KICAgICAgICBjb250YWluZXJNU1lUWEwuc2V0KCJUTENPTk8iLCBDT05PIGFzIGludCkNCiAgICAgICAgY29udGFpbmVyTVNZVFhMLnNldCgiVExESVZJIiwgIiIpDQogICAgICAgIGNvbnRhaW5lck1TWVRYTC5zZXQoIlRMVFhJRCIsIGNvbnRhaW5lck1JTE9NQS5nZXRMb25nKCJMTVRYSUQiKSkNCiAgICAgICAgY29udGFpbmVyTVNZVFhMLnNldCgiVExUWFZSIiwgaVRBR1QudHJpbSgpKQ0KICAgICAgICBDbG9zdXJlIDwgPyA+IHJlYWRBbGxSZWNvcmRzTVNZVFhMID0gew0KICAgICAgICAgIERCQ29udGFpbmVyIHJlc3VsdENvbnRhaW5lciAtPiB0YWdUZXh0ID0gdGFnVGV4dCArIHJlc3VsdENvbnRhaW5lci5nZXQoIlRMVFg2MCIpLnRvU3RyaW5nKCkudHJpbSgpDQogICAgICAgIH0NCiAgICAgICAgaWYgKCFhY3Rpb25NU1lUWEwucmVhZEFsbChjb250YWluZXJNU1lUWEwsIDQsIHJlYWRBbGxSZWNvcmRzTVNZVFhMKSkgew0KICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiTm8gdGV4dCBmb3VuZCBpbiBNU1lUWEwiKQ0KICAgICAgICB9DQogICAgICB9DQoNCiAgICAgIHRhZ1RleHQgPSBlc2NhcGVYTUxjaGFyKHRhZ1RleHQudHJpbSgpKTsNCg0KICAgICAgLy9CdWlsZCB0aGUgc3RyaW5nDQogICAgICBTdHJpbmcgY3VycmVudERhdGUgPSBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigiZGRNTXl5IikpDQogICAgICBTdHJpbmcgeG1sU3RyaW5nID0gJzw/eG1sIHZlcnNpb249IjEuMCIgZW5jb2Rpbmc9IlVURi04Ij8+Jw0KICAgICAgeG1sU3RyaW5nICs9ICc8TTNPdXREb2N1bWVudD4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgPE1ldGFkYXRhPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgIDxaWkNPTk8gTGFiZWw9IkNvbXBhbnkiPjAwMTwvWlpDT05PPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgIDxaWkRJVkkgTGFiZWw9IlVzZXIgZGl2aXNpb24iPlJGUDwvWlpESVZJPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgIDxaWkRBVEUgTGFiZWw9IlN0YXJ0IGRhdGUiPjIwMjItMTItMTM8L1paREFURT4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICA8WlpUSU1FIExhYmVsPSJTdGFydCB0aW1lIj4yMDo0NzoxNTwvWlpUSU1FPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgIDxaWlVTRVIgTGFiZWw9IlVzZXIiPjkwMDA0ODwvWlpVU0VSPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgIDxaWkJKTk8gTGFiZWw9IkpvYiBubyI+MjAyMjEyMTMxMzAwMDA8L1paQkpOTz4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICA8WlpQUlRGIExhYmVsPSJQcmludGVyIGZpbGUiPlFNWjQ1MFBGPC9aWlBSVEY+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgPFpaRklMRSBMYWJlbD0iRmlsZSBuYW1lIj4yMDIyMTIxMzEzMDAwMFFNWjQ1MFBGXzA8L1paRklMRT4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICA8WlpTSUlEIExhYmVsPSJTZXJ2aWNlIElEIj5YVEVORE0zPC9aWlNJSUQ+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgIDwvTWV0YWRhdGE+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgIDxEYXRhQXJlYT4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICA8RG9jdW1lbnQ+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICA8WlpQUlRGIExhYmVsPSJQcmludGVyIGZpbGUiPlFNU1RBRzwvWlpQUlRGPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgPFpaWE1MVCBMYWJlbD0iVmFyaWFudCI+MDE8L1paWE1MVD4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgIDxaWlhNTEQgTGFiZWw9IlhNTCB2YXJpYW50IGRlcyI+UU1TIEhvbGQgVGFnPC9aWlhNTEQ+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICA8WlpDU1ZOIExhYmVsPSJDb3VudHJ5IHZlcnNpb24iPlVTPC9aWkNTVk4+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICA8Rm9ybWF0dGluZz4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgICAgPE0zU3RhbmRhcmRGb3JtYXRWZXJzaW9uPjE8L00zU3RhbmRhcmRGb3JtYXRWZXJzaW9uPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8UmVwb3J0TGF5b3V0Pk0zX1NURF8wMS0wMTwvUmVwb3J0TGF5b3V0PicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8U3RydWN0dXJlPk0zX1NURF8wMS0wMTwvU3RydWN0dXJlPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8UGFwZXJTaXplPjwvUGFwZXJTaXplPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8V2F0ZXJtYXJrPlJaX1RTVDwvV2F0ZXJtYXJrPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8TG9jYWxpemF0aW9uPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICAgIDxEb2N1bWVudERpdmlzaW9uPlJGUDwvRG9jdW1lbnREaXZpc2lvbj4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgICAgICA8Q291bnRyeVZlcnNpb24+VVM8L0NvdW50cnlWZXJzaW9uPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICAgIDxCYXNlQ291bnRyeT5VUzwvQmFzZUNvdW50cnk+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgICAgPEZyb21Ub0NvdW50cnk+VVM8L0Zyb21Ub0NvdW50cnk+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgICAgPERvY3VtZW50TGFuZ3VhZ2U+R0I8L0RvY3VtZW50TGFuZ3VhZ2U+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgICAgPExvY2FsZT5lbi1VUzwvTG9jYWxlPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICAgIDxEYXRlRm9ybWF0Pk1NLURELVlZPC9EYXRlRm9ybWF0PicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICAgIDxEZWNpbWFsRm9ybWF0Pi48L0RlY2ltYWxGb3JtYXQ+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgICAgPFRob3VzYW5kU2VwYXJhdG9yPiw8L1Rob3VzYW5kU2VwYXJhdG9yPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8L0xvY2FsaXphdGlvbj4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgICAgPERvY3VtZW50SW5mb3JtYXRpb24+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgICAgPERlYml0Q3JlZGl0Q29kZVVzZWQ+ZmFsc2U8L0RlYml0Q3JlZGl0Q29kZVVzZWQ+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgIDwvRG9jdW1lbnRJbmZvcm1hdGlvbj4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgIDwvRm9ybWF0dGluZz4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgIDxIZWFkZXIgTGFiZWw9IkhlYWRlciI+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgICAnDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgIDwvSGVhZGVyPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgPERvY3VtZW50SGVhZGVyIExhYmVsPSJEb2N1bWVudCBoZWFkZXIiPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8VkZDT1BZIExhYmVsPSIvLyBDT1BZIC8vIj50cnVlPC9WRkNPUFk+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgIDxWRlBSRVYgTGFiZWw9IlByZXZpZXciPmZhbHNlPC9WRlBSRVY+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgIDxWRlJFTk0gTGFiZWw9Ik5hbWUiPjwvVkZSRU5NPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICAgJw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICA8L0RvY3VtZW50SGVhZGVyPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgPFN1YmRvY3VtZW50IExhYmVsPSJTdWJkb2N1bWVudCI+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgIDxNTUlUTk8gTGFiZWw9IklURU0gIyI+JyArIGlJVE5PLnRyaW0oKSArICc8L01NSVROTz4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgICAgPFdXU0JBTiBMYWJlbD0iSU5DSURFTlQgSE9MRCAjIj4nICsgb3JpZ2luYWxTQkFOLnRyaW0oKSArICc8L1dXU0JBTj4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgICAgPFdXTk9URyBMYWJlbD0iVU5ERUZJTkVEIj4nICsgbm9PZkNvcGllcy50b1N0cmluZygpICsgJzwvV1dOT1RHPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8V1dUQUdOIExhYmVsPSJUYWcgIyI+JyArIHRhZ051bWJlciArICc8L1dXVEFHTj4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgICAgPFdXVVNSTiBMYWJlbD0iUFJJTlQgQlkiPicgKyB1c2VyTmFtZS50cmltKCkgKyAnPC9XV1VTUk4+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgIDxXV1NUUVQgTGFiZWw9IlFVQU5USVRZIj4nICsgTUlUVFJBX1RSUVQgKyAnPC9XV1NUUVQ+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgIDxXV1VOTVMgTGFiZWw9IlVNIj4nICsgTUlUTUFTX1VOTVMgKyAnPC9XV1VOTVM+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgIDxXV1JHRFQgTGFiZWw9IkRBVEUiPicgKyBjdXJyZW50RGF0ZSArICc8L1dXUkdEVD4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgICAgPE1NSVREUyBMYWJlbD0iTkFNRSI+JyArIE1JVE1BU19JVERTLnRyaW0oKSArICc8L01NSVREUz4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgICAgPFdXQkFOTyBMYWJlbD0iTE9UICMiPicgKyBpU0JBTi50cmltKCkgKyAnPC9XV0JBTk8+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgIDxXV0NBTVUgTGFiZWw9IkNPTlRBSU5FUiAjIj4nICsgb3JpZ2luYWxDQU1VICsgJzwvV1dDQU1VPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8V1dUQUdUIExhYmVsPSJUWVBFIj4nICsgaVRBR1QgKyAnPC9XV1RBR1Q+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgIDxXV1JPUkMgTGFiZWw9IlJFRiBPUkQgQ0FUIj4nICsgaVJPUkMgKyAnPC9XV1JPUkM+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgICAgICAgIDxXV1JPUkwgTGFiZWw9IlJFRiBPUkQgTElORSI+JyArIGlST1JMICsgJzwvV1dST1JMPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8V1dMTURUIExhYmVsPSJDSEFOR0UgREFURSI+JyArIE1JVExPQ19MTURUICsgJzwvV1dMTURUPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgPC9TdWJkb2N1bWVudD4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgIDxUZXh0QmxvY2sgTGFiZWw9IlJFQVNPTiIgVHlwZT0iR2VuZXJhbFRleHQiPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgICAgICA8WlpURVhUPicgKyB0YWdUZXh0LnRyaW0oKSArICc8L1paVEVYVD4nDQogICAgICB4bWxTdHJpbmcgKz0gJyAgICAgIDwvVGV4dEJsb2NrPicNCiAgICAgIHhtbFN0cmluZyArPSAnICAgIDwvRG9jdW1lbnQ+Jw0KICAgICAgeG1sU3RyaW5nICs9ICcgIDwvRGF0YUFyZWE+Jw0KICAgICAgeG1sU3RyaW5nICs9ICc8L00zT3V0RG9jdW1lbnQ+Jw0KDQogICAgICAvL2VuY29kZSB0aGUgc3RyaW5nIHRvIEJhc2U2NA0KICAgICAgU3RyaW5nIGJhc2U2NGVuY29kZWRTdHJpbmcgPSBCYXNlNjQuZ2V0RW5jb2RlcigpLmVuY29kZVRvU3RyaW5nKHhtbFN0cmluZy5nZXRCeXRlcygidXRmLTgiKSk7DQoNCiAgICAgICAvL3NldHVwIHRhcmdldCBtZWRpYQ0KICAgICAgU3RyaW5nIFRhcmdldCA9ICcnJ3sidHlwZSI6ICJwcmludCIsInByaW50ZXJJZCI6ICInJycgKyBDU1lQUlRfUHJpbnRlcklEICsgJycnIiwibm9PZkNvcGllcyI6ICInJycgKyBub09mQ29waWVzLnRvU3RyaW5nKCkgKyAnJyciLCJwcmludGVyVHJheSI6IicnJyArIHByaW50ZXJUcmF5ICsgJycnIn0nJycNCiAgICAgIGlmICghaGFzUHJpbnRlclNldHVwKSB7DQogICAgICAgIFRhcmdldCA9ICcnJ3sidHlwZSI6ICJlbWFpbCIsInRvIjogIicnJyArIENTWVBSVF9NQUlMSUQudHJpbSgpICsgJycnIiwic3ViamVjdCI6ICJRTVo0NTBQRiIsImJvZHkiOiAiUUEgdGFnIGF0dGFjaGVkIC0gWW91IGFyZSByZWNlaXZpbmcgdGhlIFRhZyBpbiB5b3VyIGVtYWlsIGFzIHRoZSBQcmludGVyIGlzIG5vdCBjb25maWd1cmVkIGZvciB5b3VyIHVzZXIgLSBQbGVhc2UgY29udGFjdCBhZG1pbnN0cmF0b3IifScnJw0KICAgICAgfQ0KDQogICAgICAvL2J1aWxkIHRoZSBqc29uIGZvciBCb2R5DQogICAgICBTdHJpbmcganNvblN0cmluZyA9ICcnJ3siaW5wdXQiOiBbeyJ0eXBlIjogImdlbmVyYXRlIiwiZmlsZW5hbWUiOiAiUU1aNDUwUEYucGRmIiwiZGF0YSI6IHsidHlwZSI6ICJkYXRhIiwiZmlsZW5hbWUiOiAiUU1aNDUwUEYueG1sIiwNCiAgICAgICAgICAgICAgICAiYmFzZTY0IjogIicnJyArIGJhc2U2NGVuY29kZWRTdHJpbmcgKyAnJycifSwidGVtcGxhdGUiOiB7InR5cGUiOiAicHJpb3JpdHkiLCJwcmlvcml0eSI6IFt7InR5cGUiOiAieHF1ZXJ5IiwieHF1ZXJ5IjogIi9NM19MYXlvdXRbQE0zX1ByaW50ZXJfRmlsZSA9IFxcIlFNWjQ1MFBGXFwiXSINCiAgICAgICAgICAgICAgICAgfV19fV0sInRhcmdldHMiOiBbJycnICsgVGFyZ2V0ICsgJycnXSwibGFyZ2VKb2IiOiBmYWxzZSwiYmF0Y2hJZCI6IjhkN2I3NzlkLTM0ZDYtNDRlNC05MWQ3LTI2Njc3ZDllODkyZiJ9JycnDQogICAgICAgICAgICAgICAgIA0KLy9JT04gQVBJIENBTEwNCg0KU3RyaW5nICBlbmRwb2ludCA9ICIvSURNL2FwaS9kaXN0cmlidXRpb24vdjEvc3VibWl0Ig0KTWFwPFN0cmluZywgU3RyaW5nPiBoZWFkZXJzID0gWyJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIsICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiJdDQpNYXA8U3RyaW5nLCBTdHJpbmc+IHF1ZXJ5UGFyYW1ldGVycyA9IChNYXA8U3RyaW5nLCBTdHJpbmc+KSBudWxsDQovLyBkZWZpbmUgYXMgbWFwIGlmIHRoZXJlIGFyZSBhbnkgcXVlcnkgcGFyYW1ldGVycyBlLmcuIFsibmFtZTEiOiAidmFsdWUxIiwgIm5hbWUyIjogInZhbHVlMiJdDQpTdHJpbmcgZm9ybVBhcmFtZXRlcnMgPSBqc29uU3RyaW5nDQpsb2dnZXIuZGVidWcoImpzb25TdHJpbmcgLSBTdGFydHMgaGVyZTogIiArIGpzb25TdHJpbmcpDQpJb25SZXNwb25zZSByZXNwb25zZSA9IGlvbi5wb3N0KGVuZHBvaW50LCBoZWFkZXJzLCBxdWVyeVBhcmFtZXRlcnMsIGZvcm1QYXJhbWV0ZXJzKQ0KaWYgKHJlc3BvbnNlLmdldEVycm9yKCkpIHsNCiAgbG9nZ2VyLmRlYnVnKCJGYWlsZWQgY2FsbGluZyBJT04gQVBJLCBkZXRhaWxlZCBlcnJvciBtZXNzYWdlOiAke3Jlc3BvbnNlLmdldEVycm9yTWVzc2FnZSgpfSIpDQogIHJldHVybg0KfQ0KbG9nZ2VyLmRlYnVnKCJEaWQgaXQgcHJpbnQ/PyAiICsgcmVzcG9uc2UuZ2V0U3RhdHVzQ29kZSgpKQ0KaWYgKHJlc3BvbnNlLmdldFN0YXR1c0NvZGUoKSAhPSAyMDApIHsNCiAgbG9nZ2VyLmRlYnVnKCJFeHBlY3RlZCBzdGF0dXMgMjAwIGJ1dCBnb3QgJHtyZXNwb25zZS5nZXRTdGF0dXNDb2RlKCl9IGluc3RlYWQiKQ0KICByZXR1cm4NCn0NCg0KU3RyaW5nIGNvbnRlbnQgPSByZXNwb25zZS5nZXRDb250ZW50KCkNCmlmIChjb250ZW50ICE9IG51bGwpIHsNCiAgbG9nZ2VyLmRlYnVnKCJFeHBlY3RlZCBjb250ZW50IGZyb20gdGhlIHJlcXVlc3QgYnV0IGdvdCBubyBjb250ZW50IikNCiAgcmV0dXJuDQp9DQp9DQp9DQovKioNCiAqIFZhbGlkYXRlIGlucHV0cw0KICoqLw0KcHJpdmF0ZSBib29sZWFuIHZhbGlkYXRlSW5wdXRzKGludCBDT05PLCBTdHJpbmcgaW5JVE5PLCBTdHJpbmcgaW5XSExPLCBTdHJpbmcgaW5TQkFOLCBTdHJpbmcgaW5DQU1VLCBTdHJpbmcgaW5XSFNMLCBTdHJpbmcgaW5UQUdULCBTdHJpbmcgaW5CQVNFKSB7DQogIERCQWN0aW9uIGRiTUlUTUFTID0gZGF0YWJhc2UudGFibGUoIk1JVE1BUyIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiTU1DT05PIiwiTU1JVE5PIiwiTU1VTk1TIiwiTU1JVERTIikuYnVpbGQoKQ0KICBEQkNvbnRhaW5lciBNSVRNQVMgPSBkYk1JVE1BUy5nZXRDb250YWluZXIoKQ0KICBNSVRNQVMuc2V0KCJNTUNPTk8iLCBDT05PKQ0KICBNSVRNQVMuc2V0KCJNTUlUTk8iLCBpbklUTk8pDQogIGlmICghZGJNSVRNQVMucmVhZChNSVRNQVMpKSB7DQogICAgbWkuZXJyb3IoIkl0ZW0gZG9lcyBub3QgZXhpc3QiKQ0KICAgIHJldHVybiBmYWxzZQ0KICB9IGVsc2Ugew0KICAgIE1JVE1BU19VTk1TID0gTUlUTUFTLmdldCgiTU1VTk1TIikudG9TdHJpbmcoKQ0KICAgIE1JVE1BU19JVERTID0gTUlUTUFTLmdldCgiTU1JVERTIikudG9TdHJpbmcoKQ0KICAgIE1JVE1BU19JVERTID0gZXNjYXBlWE1MY2hhcihNSVRNQVNfSVREUy50cmltKCkpOw0KICAgIGlmICghKGluVEFHVC50cmltKCkgPT0gIkhPTEQiIHx8IGluVEFHVC50cmltKCkgPT0gIkRJU1AiKSkgew0KICAgICAgbWkuZXJyb3IoIlRhZ1R5cGUgaGFzIHRvIGJlIEhPTEQvRElTUCIpDQogICAgICByZXR1cm4gZmFsc2UNCiAgICB9IGVsc2Ugew0KICAgICAgaWYgKGluQkFTRS50cmltKCkuZXF1YWxzKCJZIikpIHsNCiAgICAgICAgLy9DaGVjayBNSVRMT0MNCiAgICAgICAgREJBY3Rpb24gZGJNSVRMT0MgPSBkYXRhYmFzZS50YWJsZSgiTUlUTE9DIikuaW5kZXgoIjAwIikuc2VsZWN0aW9uKCJNTENPTk8iLCJNTFdITE8iLCJNTElUTk8iLCJNTFdIU0wiLCJNTEJBTk8iLCJNTENBTVUiLCJNTExNRFQiKS5idWlsZCgpDQogICAgICAgIERCQ29udGFpbmVyIE1JVExPQyA9IGRiTUlUTE9DLmdldENvbnRhaW5lcigpDQogICAgICAgIE1JVExPQy5zZXQoIk1MQ09OTyIsIENPTk8pDQogICAgICAgIE1JVExPQy5zZXQoIk1MV0hMTyIsIGluV0hMTy50cmltKCkpDQogICAgICAgIE1JVExPQy5zZXQoIk1MSVROTyIsIGluSVROTy50cmltKCkpDQogICAgICAgIE1JVExPQy5zZXQoIk1MV0hTTCIsIGluV0hTTC50cmltKCkpDQogICAgICAgIE1JVExPQy5zZXQoIk1MQkFOTyIsIGluU0JBTi50cmltKCkpDQogICAgICAgIE1JVExPQy5zZXQoIk1MQ0FNVSIsIGluQ0FNVS50cmltKCkpDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDbG9zdXJlIHRvIHJlYWQgTUlUTE9DKi8NCiAgICAgICAgQ2xvc3VyZSA8ID8gPiBDYWxsQmFjayA9IHsNCiAgICAgICAgICBEQkNvbnRhaW5lciByZXN1bHRDb250YWluZXIgLT4NCiAgICAgICAgICBNSVRMT0NfTE1EVCA9IE1JVExPQy5nZXQoIk1MTE1EVCIpLnRvU3RyaW5nKCkNCiAgICAgICAgICByZXR1cm4gdHJ1ZQ0KICAgICAgICB9DQogICAgICAgIGlmICghZGJNSVRMT0MucmVhZEFsbChNSVRMT0MsIDYsIDEsIENhbGxCYWNrKSkgew0KICAgICAgICAgIG1pLmVycm9yKCJSZWNvcmQgZG9lcyBub3QgZXhpc3QgaW4gTUlUTE9DIikNCiAgICAgICAgICByZXR1cm4gZmFsc2UNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gdHJ1ZQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgLy9DaGVjayBaUkNMRlcgLSBFWFQ0MDENCiAgICAgICAgREJBY3Rpb24gZGJFWFQ0MDEgPSBkYXRhYmFzZS50YWJsZSgiRVhUNDAxIikuaW5kZXgoIjIwIikuc2VsZWN0aW9uKCJFWENPTk8iLCJFWElUTk8iLCJFWFNCQU4iLCJFWENBTVUiLCJFWExXSEwiLCJFWExXSFMiKS5idWlsZCgpDQogICAgICAgIERCQ29udGFpbmVyIEVYVDQwMSA9IGRiRVhUNDAxLmdldENvbnRhaW5lcigpDQogICAgICAgIEVYVDQwMS5zZXQoIkVYQ09OTyIsIENPTk8pDQogICAgICAgIEVYVDQwMS5zZXQoIkVYSVROTyIsIGluSVROTy50cmltKCkpDQogICAgICAgIEVYVDQwMS5zZXQoIkVYU0JBTiIsIGluU0JBTi50cmltKCkpDQogICAgICAgIEVYVDQwMS5zZXQoIkVYQ0FNVSIsIGluQ0FNVS50cmltKCkpDQogICAgICAgIEVYVDQwMS5zZXQoIkVYTFdITCIsIGluV0hMTy50cmltKCkpDQogICAgICAgIEVYVDQwMS5zZXQoIkVYTFdIUyIsIGluV0hTTC50cmltKCkpDQogICAgICAgIC8qKg0KICAgICAgICAgKiBDbG9zdXJlIHRvIHJlYWQgRVhUNDAxKi8NCiAgICAgICAgQ2xvc3VyZSA8ID8gPiBDYWxsQmFja19FWFQ0MDEgPSB7DQogICAgICAgICAgREJDb250YWluZXIgcmVzdWx0Q29udGFpbmVyIC0+DQogICAgICAgICAgcmV0dXJuIHRydWUNCiAgICAgICAgfQ0KICAgICAgICBpZiAoIWRiRVhUNDAxLnJlYWRBbGwoRVhUNDAxLCA2LCAxLCBDYWxsQmFja19FWFQ0MDEpKSB7DQogICAgICAgICAgbWkuZXJyb3IoIlJlY29yZCBkb2VzIG5vdCBleGlzdCBpbiBFWFQ0MDEiKQ0KICAgICAgICAgIHJldHVybiBmYWxzZQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0cnVlDQogICAgICB9DQogICAgfQ0KICB9DQp9DQovKioNCiAqIGVzY2FwZSBYTUwgY2hhcmFjdGVycyBpbiBhIHN0cmluZw0KICoqLw0KcHJpdmF0ZSBTdHJpbmcgZXNjYXBlWE1MY2hhcihTdHJpbmcgc3RyKSB7DQogIHN0ciA9IHN0ci5yZXBsYWNlKCImIiwgIiZhbXA7IikNCiAgc3RyID0gc3RyLnJlcGxhY2UoIlwiIiwgIiZxdW90OyIpDQogIHN0ciA9IHN0ci5yZXBsYWNlKCInIiwgIiZhcG9zOyIpDQogIHN0ciA9IHN0ci5yZXBsYWNlKCI8IiwgIiZsdDsiKQ0KICBzdHIgPSBzdHIucmVwbGFjZSgiPiIsICImZ3Q7IikNCiAgcmV0dXJuIHN0cg0KfQ0KfQ=="}}}