{"programModules":{"EXT130MI":{"program":"EXT130MI","triggers":{},"transactions":{"SplBalance":{"sourceUuid":"81b5443c-df2a-4917-b104-72337b5195d5","name":"SplBalance","program":"EXT130MI","description":"Split Balance for existing Partial Move on Sub-Lot","active":true,"multi":false,"modified":1697885999774,"modifiedBy":"900107","outputFields":[{"name":"CONO","description":"Company","length":3,"mandatory":false,"type":"N"},{"name":"WHLO","description":"Warehouse","length":3,"mandatory":false,"type":"A"},{"name":"ITNO","description":"Item Number","length":15,"mandatory":false,"type":"A"},{"name":"SBAN","description":"Sub Lot Number","length":20,"mandatory":false,"type":"A"},{"name":"CAMU","description":"Container","length":20,"mandatory":false,"type":"A"},{"name":"WHSL","description":"Location","length":10,"mandatory":false,"type":"A"}],"inputFields":[{"name":"CONO","description":"Company","length":3,"mandatory":false,"type":"N"},{"name":"WHLO","description":"Warehouse","length":3,"mandatory":true,"type":"A"},{"name":"ITNO","description":"Item Number","length":15,"mandatory":true,"type":"A"},{"name":"SBAN","description":"Sub Lot Number","length":20,"mandatory":true,"type":"A"},{"name":"CAMU","description":"Container","length":20,"mandatory":true,"type":"A"},{"name":"WHSL","description":"Location","length":10,"mandatory":true,"type":"A"},{"name":"TTYP","description":"Transaction Type","length":2,"mandatory":false,"type":"N"},{"name":"LMTS","description":"Timestamp","length":18,"mandatory":false,"type":"A"},{"name":"RGDT","description":"entry date","length":8,"mandatory":true,"type":"A"},{"name":"RGTM","description":"entry time","length":6,"mandatory":true,"type":"A"},{"name":"TMSX","description":"time suffix","length":3,"mandatory":true,"type":"A"}],"utilities":["DateUtil"],"market":"ALL"}},"batches":{},"advancedPrograms":{}}},"utilities":{},"sources":{"81b5443c-df2a-4917-b104-72337b5195d5":{"uuid":"81b5443c-df2a-4917-b104-72337b5195d5","updated":1697563234853,"updatedBy":"900107","created":1697877400354,"createdBy":"900107","apiVersion":"UNKNOWN","beVersion":"16.0.0.20230822184312.7","language":"GROOVY","codeHash":"CF1546F4630443387F4F3400A1DB09A6951872E95961136A01C284EBF45F79EC","code":"aW1wb3J0IGphdmEudGltZS5Mb2NhbERhdGUNCmltcG9ydCBqYXZhLnRpbWUuTG9jYWxUaW1lDQppbXBvcnQgamF2YS50aW1lLmZvcm1hdC5EYXRlVGltZUZvcm1hdHRlcg0KDQovKioNCiAqIFJFQURNRQ0KICogU3BsaXQgQmFsYW5jZQ0KICoNCiAqIE5hbWU6IEVYVDEzME1JLlNwbEJhbGFuY2UNCiAqIERlc2NyaXB0aW9uOiBTcGxpdCBCYWxhbmNlDQogKiBEYXRlCSAgICAgIENoYW5nZWQgQnkgICAgICAgICAgICBEZXNjcmlwdGlvbg0KICogMjAyMjEyMjYJICBBSkFZWSAgICAgICAgCVNwbGl0IEJhbGFuY2UNCiAqIDIwMjMwNzAxICAgQUpBWVkgICAgICAgICAgVXBkYXRlZCB0aGUgbG9naWMgdG8gcmVhZCBkYXRhIGZyb20gTUlUVFJBIGFuZCBzb21lIG90aGVyIGJ1c2luZXNzIGZ1bmN0aW9uYWxpdHkNCiAqIDIwMjMxMDE3ICAgQWpheSAgICAgICAgICAgIENvZGUgQ2xlYW51cA0KICovDQoNCnB1YmxpYyBjbGFzcyBTcGxCYWxhbmNlIGV4dGVuZHMgRXh0ZW5kTTNUcmFuc2FjdGlvbiB7DQogIHByaXZhdGUgZmluYWwgTUlBUEkgbWkNCiAgcHJpdmF0ZSBmaW5hbCBEYXRhYmFzZUFQSSBkYXRhYmFzZQ0KICBwcml2YXRlIGZpbmFsIExvZ2dlckFQSSBsb2dnZXINCiAgcHJpdmF0ZSBmaW5hbCBQcm9ncmFtQVBJIHByb2dyYW0NCiAgcHJpdmF0ZSBmaW5hbCBVdGlsaXR5QVBJIHV0aWxpdHkNCg0KICAvL0lucHV0IGZpZWxkcw0KICBTdHJpbmcgaVdITE8NCiAgU3RyaW5nIGlTQkFODQogIFN0cmluZyBpQ0FNVQ0KICBTdHJpbmcgaVdIU0wNCiAgU3RyaW5nIGlUVFlQDQogIFN0cmluZyBpSVROTw0KICBTdHJpbmcgaUxNVFMNCiAgU3RyaW5nIGlSR0RUDQogIFN0cmluZyBpUkdUTQ0KICBTdHJpbmcgaVRNU1gNCg0KICBTdHJpbmcgb3JpZ1dITE8NCiAgU3RyaW5nIG9yaWdCQU5PDQogIFN0cmluZyBvcmlnQ0FNVQ0KICBTdHJpbmcgb3JpZ1dIU0wNCiAgU3RyaW5nIGZyb21XSExPDQogIFN0cmluZyBmcm9tV0hTTA0KICBTdHJpbmcgZnJvbUNBTVUNCiAgU3RyaW5nIHRvV0hMTw0KICBTdHJpbmcgdG9XSFNMDQogIFN0cmluZyB0b0NBTVUNCg0KICBkb3VibGUgVFJRVA0KDQogIERCQ29udGFpbmVyIGNvbnRhaW5lck1JVFRSQSwgY29udGFpbmVyRVhUNDAxLCBjb250YWluZXJNSVRMT0MNCg0KICBwdWJsaWMgU3BsQmFsYW5jZShNSUFQSSBtaSwgRGF0YWJhc2VBUEkgZGF0YWJhc2UsIExvZ2dlckFQSSBsb2dnZXIsIFByb2dyYW1BUEkgcHJvZ3JhbSwgVXRpbGl0eUFQSSB1dGlsaXR5KSB7DQogICAgdGhpcy5taSA9IG1pDQogICAgdGhpcy5kYXRhYmFzZSA9IGRhdGFiYXNlDQogICAgdGhpcy5sb2dnZXIgPSBsb2dnZXINCiAgICB0aGlzLnByb2dyYW0gPSBwcm9ncmFtDQogICAgdGhpcy51dGlsaXR5ID0gdXRpbGl0eQ0KICB9DQoNCiAgLyoqDQogICAqIE1haW4gbWV0aG9kDQogICAqIEBwYXJhbQ0KICAgKiBAcmV0dXJuDQogICAqLw0KICBwdWJsaWMgdm9pZCBtYWluKCkgew0KICAgIGlXSExPID0gbWkuaW5EYXRhLmdldCgiV0hMTyIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIldITE8iKS50cmltKCkNCiAgICBpU0JBTiA9IG1pLmluRGF0YS5nZXQoIlNCQU4iKSA9PSBudWxsID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJTQkFOIikudHJpbSgpDQogICAgaUNBTVUgPSBtaS5pbkRhdGEuZ2V0KCJDQU1VIikgPT0gbnVsbCA/ICIiIDogbWkuaW5EYXRhLmdldCgiQ0FNVSIpLnRyaW0oKQ0KICAgIGlXSFNMID0gbWkuaW5EYXRhLmdldCgiV0hTTCIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIldIU0wiKS50cmltKCkNCiAgICBpVFRZUCA9IG1pLmluRGF0YS5nZXQoIlRUWVAiKSA9PSBudWxsID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJUVFlQIikudHJpbSgpDQogICAgaUlUTk8gPSBtaS5pbkRhdGEuZ2V0KCJJVE5PIikgPT0gbnVsbCA/ICIiIDogbWkuaW5EYXRhLmdldCgiSVROTyIpLnRyaW0oKQ0KICAgIGlMTVRTID0gbWkuaW5EYXRhLmdldCgiTE1UUyIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIkxNVFMiKS50cmltKCkNCiAgICBpUkdEVCA9IG1pLmluRGF0YS5nZXQoIlJHRFQiKSA9PSBudWxsID8gIiIgOiBtaS5pbkRhdGEuZ2V0KCJSR0RUIikudHJpbSgpDQogICAgaVJHVE0gPSBtaS5pbkRhdGEuZ2V0KCJSR1RNIikgPT0gbnVsbCA/ICIiIDogbWkuaW5EYXRhLmdldCgiUkdUTSIpLnRyaW0oKQ0KICAgIGlUTVNYID0gbWkuaW5EYXRhLmdldCgiVE1TWCIpID09IG51bGwgPyAiIiA6IG1pLmluRGF0YS5nZXQoIlRNU1giKS50cmltKCkNCg0KICAgIGxvZ2dlci5kZWJ1ZygibWkgaW5wdXRzOiAiICsgbWkuaW4udG9TdHJpbmcoKSkNCg0KICAgIG9yaWdCQU5PID0gaVNCQU4NCiAgICBvcmlnV0hMTyA9IGlXSExPDQogICAgb3JpZ1dIU0wgPSBpV0hTTA0KICAgIG9yaWdDQU1VID0gaUNBTVUNCg0KICAgIGlmIChpVFRZUC5pc0VtcHR5KCkpIHsNCiAgICAgIGlUVFlQID0gIjkyIg0KICAgIH0NCg0KICAgIGludCBDT05PID0gcHJvZ3JhbS5MREFaRC5DT05PLnRvU3RyaW5nKCkudG9JbnRlZ2VyKCkNCg0KICAgIERCQWN0aW9uIGFjdGlvbkNTWVRBQiA9IGRhdGFiYXNlLnRhYmxlKCJDU1lUQUIiKS5pbmRleCgiMDAiKS5zZWxlY3Rpb24oIkNUQ09OTyIsICJDVERJVkkiLCAiQ1RMTkNEIiwgIkNUU1RDTyIsICJDVFNUS1kiKS5idWlsZCgpDQogICAgREJDb250YWluZXIgY29udGFpbmVyQ1NZVEFCID0gYWN0aW9uQ1NZVEFCLmdldENvbnRhaW5lcigpDQoNCiAgICBjb250YWluZXJDU1lUQUIuc2V0KCJDVENPTk8iLCBDT05PKQ0KICAgIGNvbnRhaW5lckNTWVRBQi5zZXQoIkNURElWSSIsICIiKQ0KICAgIGNvbnRhaW5lckNTWVRBQi5zZXQoIkNUTE5DRCIsICIiKQ0KICAgIGNvbnRhaW5lckNTWVRBQi5zZXQoIkNUU1RDTyIsICJUVFlQIikNCiAgICBjb250YWluZXJDU1lUQUIuc2V0KCJDVFNUS1kiLCBpVFRZUCkNCg0KICAgIGlmICghYWN0aW9uQ1NZVEFCLnJlYWQoY29udGFpbmVyQ1NZVEFCKSkgew0KICAgICAgbWkuZXJyb3IoIlRyYW5zYWN0aW9uIFR5cGUgZG9lcyBub3QgZXhpc3QiKQ0KICAgICAgcmV0dXJuDQogICAgfQ0KDQogICAgREJBY3Rpb24gYWN0aW9uTUlUVFJBID0gZGF0YWJhc2UudGFibGUoIk1JVFRSQSIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiTVRDT05PIiwgIk1UV0hMTyIsICJNVFdIU0wiLCAiTVRJVE5PIiwgIk1UQ0FNVSIsICJNVFJHRFQiLCAiTVRSR1RNIiwgIk1UVE1TWCIsICJNVFJGVFgiLCAiTVRUVFlQIiwgIk1UVFJRVCIpLmJ1aWxkKCkNCiAgICBEQkNvbnRhaW5lciBjb250YWluZXJNSVRUUkEgPSBhY3Rpb25NSVRUUkEuZ2V0Q29udGFpbmVyKCkNCg0KICAgIGNvbnRhaW5lck1JVFRSQS5zZXQoIk1UQ09OTyIsIHByb2dyYW0uTERBWkQuQ09OTyBhcyBpbnQpDQogICAgY29udGFpbmVyTUlUVFJBLnNldCgiTVRXSExPIiwgaVdITE8pDQogICAgY29udGFpbmVyTUlUVFJBLnNldCgiTVRJVE5PIiwgaUlUTk8pDQogICAgY29udGFpbmVyTUlUVFJBLnNldCgiTVRSR0RUIiwgaVJHRFQgYXMgaW50KQ0KICAgIGNvbnRhaW5lck1JVFRSQS5zZXQoIk1UUkdUTSIsIGlSR1RNIGFzIGludCkNCiAgICBjb250YWluZXJNSVRUUkEuc2V0KCJNVFRNU1giLCBpVE1TWCBhcyBpbnQpDQoNCiAgICBpZiAoIWFjdGlvbk1JVFRSQS5yZWFkKGNvbnRhaW5lck1JVFRSQSkpIHsNCiAgICAgIG1pLmVycm9yKCJUcmFuc2FjdGlvbiBub3QgZm91bmQiKQ0KICAgICAgcmV0dXJuDQogICAgfQ0KDQogICAgbG9nZ2VyLmRlYnVnKGNvbnRhaW5lck1JVFRSQS50b1N0cmluZygpKQ0KDQogICAgU3RyaW5nIHJlZmVyZW5jZVRleHQgPSBjb250YWluZXJNSVRUUkEuZ2V0U3RyaW5nKCJNVFJGVFgiKQ0KICAgIGludCB0cmFuc2FjdGlvblR5cGUgPSBjb250YWluZXJNSVRUUkEuZ2V0SW50KCJNVFRUWVAiKQ0KICAgIGlmICh0cmFuc2FjdGlvblR5cGUgPT0gOTMpIHsNCiAgICAgIGlmIChjb250YWluZXJNSVRUUkEuZ2V0RG91YmxlKCJNVFRSUVQiKSA+IDApIHsNCg0KICAgICAgICBmcm9tV0hMTyA9IGNvbnRhaW5lck1JVFRSQS5nZXRTdHJpbmcoIk1UV0hMTyIpDQogICAgICAgIGZyb21XSFNMID0gcmVmZXJlbmNlVGV4dC5zdWJzdHJpbmcoMCwgMTEpLnRyaW0oKQ0KICAgICAgICBmcm9tQ0FNVSA9IHJlZmVyZW5jZVRleHQuc3Vic3RyaW5nKDExKS50cmltKCkNCg0KICAgICAgICB0b1dITE8gPSBjb250YWluZXJNSVRUUkEuZ2V0U3RyaW5nKCJNVFdITE8iKQ0KICAgICAgICB0b1dIU0wgPSBjb250YWluZXJNSVRUUkEuZ2V0U3RyaW5nKCJNVFdIU0wiKQ0KICAgICAgICB0b0NBTVUgPSBjb250YWluZXJNSVRUUkEuZ2V0U3RyaW5nKCJNVENBTVUiKQ0KDQogICAgICAgIFRSUVQgPSBjb250YWluZXJNSVRUUkEuZ2V0RG91YmxlKCJNVFRSUVQiKQ0KICAgICAgfQ0KICAgIH0NCg0KICAgIGxvZ2dlci5kZWJ1ZygiZnJvbVdITE86ICIgKyBmcm9tV0hMTykNCiAgICBsb2dnZXIuZGVidWcoImZyb21XSFNMOiAiICsgZnJvbVdIU0wpDQogICAgbG9nZ2VyLmRlYnVnKCJmcm9tQ0FNVTogIiArIGZyb21DQU1VKQ0KICAgIGxvZ2dlci5kZWJ1ZygidG9XSExPOiAiICsgdG9XSExPKQ0KICAgIGxvZ2dlci5kZWJ1ZygidG9XSFNMOiAiICsgdG9XSFNMKQ0KICAgIGxvZ2dlci5kZWJ1ZygidG9DQU1VOiAiICsgdG9DQU1VKQ0KDQogICAgaWYgKGZyb21XSExPLnRyaW0oKS5pc0VtcHR5KCkgfHwgdG9XSExPLnRyaW0oKS5pc0VtcHR5KCkpIHsNCiAgICAgIG1pLmVycm9yKCJUcmFuc2FjdGlvbiBub3QgZm91bmQiKQ0KICAgICAgcmV0dXJuDQogICAgfQ0KDQogICAgREJBY3Rpb24gYWN0aW9uRVhUNDAxID0gZGF0YWJhc2UudGFibGUoIkVYVDQwMSIpLmluZGV4KCIyMCIpLnNlbGVjdEFsbEZpZWxkcygpLmJ1aWxkKCkNCiAgICBjb250YWluZXJFWFQ0MDEgPSBhY3Rpb25FWFQ0MDEuZ2V0Q29udGFpbmVyKCkNCg0KICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ09OTyIsIENPTk8pDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hMIiwgZnJvbVdITE8pDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhJVE5PIiwgaUlUTk8pDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhTQkFOIiwgaVNCQU4pDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDQU1VIiwgZnJvbUNBTVUpDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hTIiwgZnJvbVdIU0wpDQoNCiAgICBDbG9zdXJlIDwgPyA+IHJlYWRBbGxSZWNvcmRzRVhUNDAxID0gew0KICAgICAgREJDb250YWluZXIgcmVzdWx0Q29udGFpbmVyIC0+DQogICAgICBjb250YWluZXJFWFQ0MDEgPSByZXN1bHRDb250YWluZXINCiAgICB9DQoNCiAgICBpZiAoYWN0aW9uRVhUNDAxLnJlYWRBbGwoY29udGFpbmVyRVhUNDAxLCA2LCByZWFkQWxsUmVjb3Jkc0VYVDQwMSkpIHsNCg0KICAgICAgREJBY3Rpb24gYWN0aW9uTUlUTE9DID0gZGF0YWJhc2UudGFibGUoIk1JVExPQyIpLmluZGV4KCIwMCIpLnNlbGVjdGlvbigiTUxDT05PIiwgIk1MV0hMTyIsICJNTFdIU0wiLCAiTUxJVE5PIiwgIk1MQkFOTyIsICJNTENBTVUiLCAiTUxTVEFTIiwgIk1MU1RRVCIpLmJ1aWxkKCkNCiAgICAgIGNvbnRhaW5lck1JVExPQyA9IGFjdGlvbk1JVExPQy5nZXRDb250YWluZXIoKQ0KDQogICAgICBjb250YWluZXJNSVRMT0Muc2V0KCJNTENPTk8iLCBwcm9ncmFtLkxEQVpELkNPTk8udG9TdHJpbmcoKS50b0ludGVnZXIoKSkNCiAgICAgIGNvbnRhaW5lck1JVExPQy5zZXQoIk1MV0hMTyIsIGZyb21XSExPKQ0KICAgICAgY29udGFpbmVyTUlUTE9DLnNldCgiTUxJVE5PIiwgaUlUTk8pDQogICAgICBjb250YWluZXJNSVRMT0Muc2V0KCJNTFdIU0wiLCBmcm9tV0hTTCkNCiAgICAgIGNvbnRhaW5lck1JVExPQy5zZXQoIk1MQkFOTyIsIGlTQkFOKQ0KICAgICAgY29udGFpbmVyTUlUTE9DLnNldCgiTUxDQU1VIiwgZnJvbUNBTVUpDQoNCiAgICAgIENsb3N1cmUgPCA/ID4gcmVhZEFsbFJlY29yZE1JVExPQyA9IHsNCiAgICAgICAgREJDb250YWluZXIgcmVzdWx0Q29udGFpbmVyIC0+DQogICAgICAgIGNvbnRhaW5lck1JVExPQyA9IHJlc3VsdENvbnRhaW5lcg0KICAgICAgfQ0KDQogICAgICBpZiAoYWN0aW9uTUlUTE9DLnJlYWRBbGwoY29udGFpbmVyTUlUTE9DLCA2LCAxLCByZWFkQWxsUmVjb3JkTUlUTE9DKSAmJiBjb250YWluZXJNSVRMT0MuZ2V0RG91YmxlKCJNTFNUUVQiKSA+IDApIHsNCiAgICAgICAgYWN0aW9uRVhUNDAxID0gZGF0YWJhc2UudGFibGUoIkVYVDQwMSIpLmluZGV4KCIyMCIpLnNlbGVjdEFsbEZpZWxkcygpLmJ1aWxkKCkNCg0KICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWENPTk8iLCBwcm9ncmFtLkxEQVpELkNPTk8udG9TdHJpbmcoKS50b0ludGVnZXIoKSkNCiAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hMIiwgZnJvbVdITE8pDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYSVROTyIsIGlJVE5PKQ0KICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWFNCQU4iLCBpU0JBTikNCiAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDQU1VIiwgZnJvbUNBTVUpDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdIUyIsIGZyb21XSFNMKQ0KDQogICAgICAgIExpc3QgPCBMb2NrZWRSZXN1bHQgPiBsb2NrZWRSZXN1bHRzID0gbmV3IEFycmF5TGlzdCA8IExvY2tlZFJlc3VsdCA+ICgpDQogICAgICAgIENsb3N1cmUgPCA/ID4gdXBkYXRlRVhUNDAxID0gew0KICAgICAgICAgIExvY2tlZFJlc3VsdCBsb2NrZWRSZXN1bHQgLT4NCiAgICAgICAgICBsb2NrZWRSZXN1bHRzLmFkZChsb2NrZWRSZXN1bHQpDQogICAgICAgIH0NCg0KICAgICAgICBpZiAoYWN0aW9uRVhUNDAxLnJlYWRBbGxMb2NrKGNvbnRhaW5lckVYVDQwMSwgNiwgdXBkYXRlRVhUNDAxKSkgew0KICAgICAgICAgIExvY2tlZFJlc3VsdCBsb2NrZWRSZXN1bHQgPSBsb2NrZWRSZXN1bHRzWzBdDQoNCiAgICAgICAgICBsb2dnZXIuZGVidWcoImxvY2tlZFJlc3VsdDogIiArIGxvY2tlZFJlc3VsdC50b1N0cmluZygpKQ0KDQogICAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhMU1RRIiwgY29udGFpbmVyTUlUTE9DLmdldERvdWJsZSgiTUxTVFFUIikpDQogICAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhMTURUIiwgdXRpbGl0eS5jYWxsKCJEYXRlVXRpbCIsICJjdXJyZW50RGF0ZVk4QXNJbnQiKSkNCiAgICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWENISUQiLCBwcm9ncmFtLmdldFVzZXIoKSkNCiAgICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWENITk8iLCBsb2NrZWRSZXN1bHQuZ2V0SW50KCJFWENITk8iKSArIDEpDQoNCiAgICAgICAgICBsb2NrZWRSZXN1bHQudXBkYXRlKCkNCg0KICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdITCIsIHRvV0hMTykNCiAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSFMiLCB0b1dIU0wpDQogICAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDQU1VIiwgdG9DQU1VKQ0KDQogICAgICAgICAgbG9ja2VkUmVzdWx0cyA9IG5ldyBBcnJheUxpc3QgPCBMb2NrZWRSZXN1bHQgPiAoKQ0KICAgICAgICAgIGlmIChhY3Rpb25FWFQ0MDEucmVhZEFsbExvY2soY29udGFpbmVyRVhUNDAxLCA2LCB1cGRhdGVFWFQ0MDEpKSB7DQogICAgICAgICAgICBsb2NrZWRSZXN1bHQgPSBsb2NrZWRSZXN1bHRzWzBdDQoNCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygibG9ja2VkUmVzdWx0OiAiICsgbG9ja2VkUmVzdWx0LnRvU3RyaW5nKCkpDQoNCiAgICAgICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYTFNUUSIsIGxvY2tlZFJlc3VsdC5nZXREb3VibGUoIkVYTFNUUSIpICsgTWF0aC5hYnMoY29udGFpbmVyTUlUVFJBLmdldERvdWJsZSgiTVRUUlFUIikpKQ0KICAgICAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhMTURUIiwgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oIllZWVlNTWRkIikpLnRvSW50ZWdlcigpKQ0KICAgICAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpDQogICAgICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWENITk8iLCBsb2NrZWRSZXN1bHQuZ2V0SW50KCJFWENITk8iKSArIDEpDQoNCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygibG9ja2VkUmVzdWx0OiAiICsgbG9ja2VkUmVzdWx0LnRvU3RyaW5nKCkpDQoNCiAgICAgICAgICAgIGxvY2tlZFJlc3VsdC51cGRhdGUoKQ0KDQogICAgICAgICAgICB1cGRhdGVBbGxMZXZlbHModG9XSExPLCB0b1dIU0wsIHRvQ0FNVSwgbG9ja2VkUmVzdWx0LmdldERvdWJsZSgiRVhMU1RRIikpDQogICAgICAgICAgICB1cGRhdGVBbGxMZXZlbHMoZnJvbVdITE8sIGZyb21XSFNMLCBmcm9tQ0FNVSwgY29udGFpbmVyTUlUTE9DLmdldERvdWJsZSgiTUxTVFFUIikpDQoNCiAgICAgICAgICB9IGVsc2Ugew0KDQogICAgICAgICAgICBsb2dnZXIuZGVidWcoIlJlY29yZCBub3QgZm91bmQiKQ0KDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWFdITE8iLCB0b1dITE8pDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWFdIU0wiLCB0b1dIU0wpDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWENBTVUiLCB0b0NBTVUpDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSEwiLCB0b1dITE8pDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSFMiLCB0b1dIU0wpDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWENXSEwiLCB0b1dITE8pDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWENXSFMiLCB0b1dIU0wpDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExTVFEiLCBNYXRoLmFicyhUUlFUKSkNCiAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYUkdEVCIsIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJZWVlZTU1kZCIpKS50b0ludGVnZXIoKSkNCiAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYUkdUTSIsIExvY2FsVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkudG9JbnRlZ2VyKCkpDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExNRFQiLCBMb2NhbERhdGUubm93KCkuZm9ybWF0KERhdGVUaW1lRm9ybWF0dGVyLm9mUGF0dGVybigiWVlZWU1NZGQiKSkudG9JbnRlZ2VyKCkpDQogICAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWENISUQiLCBwcm9ncmFtLmdldFVzZXIoKSkNCiAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ0hOTyIsIDApDQoNCiAgICAgICAgICAgIGFjdGlvbkVYVDQwMSA9IGRhdGFiYXNlLnRhYmxlKCJFWFQ0MDEiKS5pbmRleCgiMDAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQoNCiAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZygiY29udGFpbmVyRVhUNDAxOiAiICsgY29udGFpbmVyRVhUNDAxLnRvU3RyaW5nKCkpDQoNCiAgICAgICAgICAgIGlmIChhY3Rpb25FWFQ0MDEuaW5zZXJ0KGNvbnRhaW5lckVYVDQwMSkpIHsNCiAgICAgICAgICAgICAgbWkub3V0RGF0YS5wdXQoIkNPTk8iLCBjb250YWluZXJFWFQ0MDEuZ2V0KCJFWENPTk8iKS50b1N0cmluZygpKQ0KICAgICAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiV0hMTyIsIGNvbnRhaW5lckVYVDQwMS5nZXQoIkVYV0hMTyIpLnRvU3RyaW5nKCkpDQogICAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJJVE5PIiwgY29udGFpbmVyRVhUNDAxLmdldCgiRVhJVE5PIikudG9TdHJpbmcoKSkNCiAgICAgICAgICAgICAgbWkub3V0RGF0YS5wdXQoIlNCQU4iLCBjb250YWluZXJFWFQ0MDEuZ2V0KCJFWFNCQU4iKS50b1N0cmluZygpKQ0KICAgICAgICAgICAgICBtaS5vdXREYXRhLnB1dCgiQ0FNVSIsIGNvbnRhaW5lckVYVDQwMS5nZXQoIkVYQ0FNVSIpLnRvU3RyaW5nKCkpDQogICAgICAgICAgICAgIG1pLm91dERhdGEucHV0KCJXSFNMIiwgY29udGFpbmVyRVhUNDAxLmdldCgiRVhXSFNMIikudG9TdHJpbmcoKSkNCg0KICAgICAgICAgICAgICBzcGxpdEFsbExldmVscyh0b1dITE8sIHRvV0hTTCwgdG9DQU1VKQ0KDQogICAgICAgICAgICAgIG1pLndyaXRlKCkNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgfSBlbHNlIHsNCiAgICAgIG1pLmVycm9yKCJTdWItTG90IHJlY29yZCBub3QgZm91bmQhIikNCiAgICAgIHJldHVybg0KICAgIH0NCiAgfQ0KDQogIHB1YmxpYyB2b2lkIHVwZGF0ZUFsbExldmVscyhTdHJpbmcgbmV3V0hMTywgU3RyaW5nIG5ld1dIU0wsIFN0cmluZyBuZXdDQU1VLCBkb3VibGUgbmV3TFNUUSkgew0KICAgIGxvZ2dlci5kZWJ1ZygiU3RhcnRlZCB1cGRhdGVBbGxMZXZlbHMiKQ0KICAgIERCQWN0aW9uIGFjdGlvbkVYVDQwMSA9IGRhdGFiYXNlLnRhYmxlKCJFWFQ0MDEiKS5pbmRleCgiMjAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQoNCiAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWENPTk8iLCBwcm9ncmFtLkxEQVpELkNPTk8udG9TdHJpbmcoKS50b0ludGVnZXIoKSkNCiAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSEwiLCBuZXdXSExPKQ0KICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYU0JBTiIsIG9yaWdCQU5PKQ0KICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdIUyIsIG5ld1dIU0wpDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDQU1VIiwgbmV3Q0FNVSkNCg0KICAgIENsb3N1cmUgPCA/ID4gcmVhZEFsbFJlY29yZHNFWFQ0MDEgPSB7DQogICAgICBEQkNvbnRhaW5lciByZXN1bHRDb250YWluZXIgLT4NCiAgICAgIGNvbnRhaW5lckVYVDQwMSA9IHJlc3VsdENvbnRhaW5lcg0KICAgIH0NCg0KICAgIGlmIChhY3Rpb25FWFQ0MDEucmVhZEFsbChjb250YWluZXJFWFQ0MDEsIDYsIDEsIHJlYWRBbGxSZWNvcmRzRVhUNDAxKSkgew0KICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hMIiwgbmV3V0hMTykNCiAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYU0JBTiIsIGNvbnRhaW5lckVYVDQwMS5nZXRTdHJpbmcoIkVYUEJBTiIpKQ0KICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hTIiwgbmV3V0hTTCkNCiAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ0FNVSIsIG5ld0NBTVUpDQoNCiAgICAgIGFjdGlvbkVYVDQwMSA9IGRhdGFiYXNlLnRhYmxlKCJFWFQ0MDEiKS5pbmRleCgiMjAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQoNCiAgICAgIENsb3N1cmUgPCA/ID4gdXBkYXRlQWxsUmVjb3JkcyA9IHsNCiAgICAgICAgTG9ja2VkUmVzdWx0IGxvY2tlZFJlc3VsdCAtPg0KDQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYTFNUUSIsIG5ld0xTVFEpDQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYTE1EVCIsIHV0aWxpdHkuY2FsbCgiRGF0ZVV0aWwiLCAiY3VycmVudERhdGVZOEFzSW50IikpDQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQ0hJRCIsIHByb2dyYW0uZ2V0VXNlcigpKQ0KICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWENITk8iLCBsb2NrZWRSZXN1bHQuZ2V0SW50KCJFWENITk8iKSArIDEpDQoNCiAgICAgICAgbG9ja2VkUmVzdWx0LnVwZGF0ZSgpDQoNCiAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hMIiwgbmV3V0hMTykNCiAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhTQkFOIiwgbG9ja2VkUmVzdWx0LmdldFN0cmluZygiRVhQQkFOIikpDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdIUyIsIG5ld1dIU0wpDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ0FNVSIsIG5ld0NBTVUpDQogICAgICB9DQoNCiAgICAgIHdoaWxlIChhY3Rpb25FWFQ0MDEucmVhZEFsbExvY2soY29udGFpbmVyRVhUNDAxLCA2LCB1cGRhdGVBbGxSZWNvcmRzKSkgew0KICAgICAgICAvLw0KICAgICAgfQ0KICAgIH0NCg0KICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ09OTyIsIHByb2dyYW0uTERBWkQuQ09OTy50b1N0cmluZygpLnRvSW50ZWdlcigpKQ0KICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdITCIsIG5ld1dITE8pDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhTQkFOIiwgb3JpZ0JBTk8pDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hTIiwgbmV3V0hTTCkNCiAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWENBTVUiLCBuZXdDQU1VKQ0KDQogICAgYWN0aW9uRVhUNDAxID0gZGF0YWJhc2UudGFibGUoIkVYVDQwMSIpLmluZGV4KCIyMCIpLnNlbGVjdEFsbEZpZWxkcygpLmJ1aWxkKCkNCg0KICAgIGlmIChhY3Rpb25FWFQ0MDEucmVhZEFsbChjb250YWluZXJFWFQ0MDEsIDYsIHJlYWRBbGxSZWNvcmRzRVhUNDAxKSkgew0KDQogICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSEwiLCBuZXdXSExPKQ0KICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhQQkFOIiwgY29udGFpbmVyRVhUNDAxLmdldFN0cmluZygiRVhTQkFOIikpDQogICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSFMiLCBuZXdXSFNMKQ0KICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDQU1VIiwgbmV3Q0FNVSkNCg0KICAgICAgYWN0aW9uRVhUNDAxID0gZGF0YWJhc2UudGFibGUoIkVYVDQwMSIpLmluZGV4KCIxMCIpLnNlbGVjdEFsbEZpZWxkcygpLmJ1aWxkKCkNCg0KICAgICAgQ2xvc3VyZSA8ID8gPiB1cGRhdGVBbGxSZWNvcmRzID0gew0KICAgICAgICBMb2NrZWRSZXN1bHQgbG9ja2VkUmVzdWx0IC0+DQoNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhMU1RRIiwgbmV3TFNUUSkNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhMTURUIiwgdXRpbGl0eS5jYWxsKCJEYXRlVXRpbCIsICJjdXJyZW50RGF0ZVk4QXNJbnQiKSkNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpDQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQ0hOTyIsIGxvY2tlZFJlc3VsdC5nZXRJbnQoIkVYQ0hOTyIpICsgMSkNCg0KICAgICAgICBsb2NrZWRSZXN1bHQudXBkYXRlKCkNCg0KICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSEwiLCBuZXdXSExPKQ0KICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWFBCQU4iLCBsb2NrZWRSZXN1bHQuZ2V0U3RyaW5nKCJFWFNCQU4iKSkNCiAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hTIiwgbmV3V0hTTCkNCiAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDQU1VIiwgbmV3Q0FNVSkNCiAgICAgIH0NCg0KICAgICAgd2hpbGUgKGFjdGlvbkVYVDQwMS5yZWFkQWxsTG9jayhjb250YWluZXJFWFQ0MDEsIDYsIHVwZGF0ZUFsbFJlY29yZHMpKSB7DQogICAgICAgIC8vDQogICAgICB9DQogICAgfQ0KDQogICAgbG9nZ2VyLmRlYnVnKCJGaW5pc2hlZCB1cGRhdGVBbGxMZXZlbHMiKQ0KICB9DQoNCiAgcHVibGljIHZvaWQgc3BsaXRBbGxMZXZlbHMoU3RyaW5nIG5ld1dITE8sIFN0cmluZyBuZXdXSFNMLCBTdHJpbmcgbmV3Q0FNVSkgew0KICAgIGxvZ2dlci5kZWJ1ZygiU3RhcnRlZCBzcGxpdEFsbExldmVscyIpDQoNCiAgICBsb2dnZXIuZGVidWcoIkRvd253YXJkcyBpbiB0aGUgSGllcmFyY2h5IikNCiAgICAvLyBDaGFuZ2UgYWxsIFByZS1MZXZlbHMgKERvd253YXJkcyBpbiB0aGUgSGllcmFyY2h5ISkNCiAgICBEQkFjdGlvbiBhY3Rpb25FWFQ0MDEgPSBkYXRhYmFzZS50YWJsZSgiRVhUNDAxIikuaW5kZXgoIjIwIikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKQ0KDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDT05PIiwgcHJvZ3JhbS5MREFaRC5DT05PLnRvU3RyaW5nKCkudG9JbnRlZ2VyKCkpDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hMIiwgZnJvbVdITE8pDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhTQkFOIiwgb3JpZ0JBTk8pDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hTIiwgZnJvbVdIU0wpDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDQU1VIiwgZnJvbUNBTVUpDQoNCiAgICBDbG9zdXJlIDwgPyA+IHJlYWRBbGxSZWNvcmRzRVhUNDAxID0gew0KICAgICAgREJDb250YWluZXIgcmVzdWx0Q29udGFpbmVyIC0+DQogICAgICBsb2dnZXIuZGVidWcoIlJlYWRpbmcgcmVjb3JkcyBmcm9tIEVYVDQwMSIpDQogICAgICBsb2dnZXIuZGVidWcoY29udGFpbmVyRVhUNDAxLnRvU3RyaW5nKCkpDQogICAgICBjb250YWluZXJFWFQ0MDEgPSByZXN1bHRDb250YWluZXINCiAgICB9DQoNCiAgICBpZiAoYWN0aW9uRVhUNDAxLnJlYWRBbGwoY29udGFpbmVyRVhUNDAxLCA2LCAxLCByZWFkQWxsUmVjb3Jkc0VYVDQwMSkpIHsNCiAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdITCIsIGZyb21XSExPKQ0KICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhTQkFOIiwgY29udGFpbmVyRVhUNDAxLmdldFN0cmluZygiRVhQQkFOIikpDQogICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSFMiLCBmcm9tV0hTTCkNCiAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ0FNVSIsIGZyb21DQU1VKQ0KDQogICAgICBhY3Rpb25FWFQ0MDEgPSBkYXRhYmFzZS50YWJsZSgiRVhUNDAxIikuaW5kZXgoIjIwIikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKQ0KDQogICAgICBDbG9zdXJlIDwgPyA+IHVwZGF0ZUFsbFJlY29yZHMgPSB7DQogICAgICAgIExvY2tlZFJlc3VsdCBsb2NrZWRSZXN1bHQgLT4NCiAgICAgICAgbG9nZ2VyLmRlYnVnKCJVcGRhdGluZyByZWNvcmRzIGluIEVYVDQwMSIpDQogICAgICAgIGxvZ2dlci5kZWJ1Zyhjb250YWluZXJFWFQ0MDEudG9TdHJpbmcoKSkNCiAgICAgICAgbG9nZ2VyLmRlYnVnKGxvY2tlZFJlc3VsdC50b1N0cmluZygpKQ0KDQogICAgICAgIGxvY2tlZFJlc3VsdC5hbGxDb2x1bW5zLmVhY2ggew0KICAgICAgICAgIFN0cmluZyBjb2x1bW4gLT4NCiAgICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoY29sdW1uLCBsb2NrZWRSZXN1bHQuZ2V0KGNvbHVtbikpDQogICAgICAgIH0NCg0KICAgICAgICBpZiAobG9ja2VkUmVzdWx0LmdldCgiRVhDQU1VIikgPT0gZnJvbUNBTVUpIHsNCiAgICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWExTVFEiLCBjb250YWluZXJNSVRMT0MuZ2V0RG91YmxlKCJNTFNUUVQiKSkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWExTVFEiLCBNYXRoLmFicyhUUlFUKSkNCiAgICAgICAgfQ0KICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWExNRFQiLCB1dGlsaXR5LmNhbGwoIkRhdGVVdGlsIiwgImN1cnJlbnREYXRlWThBc0ludCIpKQ0KICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWENISUQiLCBwcm9ncmFtLmdldFVzZXIoKSkNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhDSE5PIiwgbG9ja2VkUmVzdWx0LmdldEludCgiRVhDSE5PIikgKyAxKQ0KDQogICAgICAgIGxvY2tlZFJlc3VsdC51cGRhdGUoKQ0KDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdITCIsIG5ld1dITE8pDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdIUyIsIG5ld1dIU0wpDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ0FNVSIsIG5ld0NBTVUpDQoNCiAgICAgICAgbG9nZ2VyLmRlYnVnKCJSZWFkaW5nIHJlY29yZHMgZnJvbSBFWFQ0MDEgYWdhaW4iKQ0KICAgICAgICBsb2dnZXIuZGVidWcoY29udGFpbmVyRVhUNDAxLnRvU3RyaW5nKCkpDQoNCiAgICAgICAgaWYgKCFhY3Rpb25FWFQ0MDEucmVhZEFsbChjb250YWluZXJFWFQ0MDEsIDYsIDEsIHJlYWRBbGxSZWNvcmRzRVhUNDAxKSkgew0KICAgICAgICAgIGxvY2tlZFJlc3VsdC5hbGxDb2x1bW5zLmVhY2ggew0KICAgICAgICAgICAgU3RyaW5nIGNvbHVtbiAtPg0KICAgICAgICAgICAgICBpZiAoIVsiRVhMV0hMIiwgIkVYTFdIUyIsICJFWENBTVUiXS5jb250YWlucyhjb2x1bW4pKSB7DQogICAgICAgICAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldChjb2x1bW4sIGxvY2tlZFJlc3VsdC5nZXQoY29sdW1uKSkNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWFdITE8iLCBuZXdXSExPKQ0KICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYV0hTTCIsIG5ld1dIU0wpDQogICAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDQU1VIiwgbmV3Q0FNVSkNCiAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWENXSEwiLCBuZXdXSExPKQ0KICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ1dIUyIsIG5ld1dIU0wpDQoNCiAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExTVFEiLCBNYXRoLmFicyhUUlFUKSkNCiAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWFJHRFQiLCB1dGlsaXR5LmNhbGwoIkRhdGVVdGlsIiwgImN1cnJlbnREYXRlWThBc0ludCIpKQ0KICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYUkdUTSIsIHV0aWxpdHkuY2FsbCgiRGF0ZVV0aWwiLCAiY3VycmVudFRpbWVBc0ludCIpKQ0KICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTE1EVCIsIHV0aWxpdHkuY2FsbCgiRGF0ZVV0aWwiLCAiY3VycmVudERhdGVZOEFzSW50IikpDQogICAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpDQogICAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDSE5PIiwgMSkNCg0KICAgICAgICAgIGFjdGlvbkVYVDQwMS5pbnNlcnQoY29udGFpbmVyRVhUNDAxKQ0KDQogICAgICAgICAgbG9nZ2VyLmRlYnVnKCJJbnNlcnRpbmcgcmVjb3JkcyBpbiBFWFQ0MDEiKQ0KICAgICAgICAgIGxvZ2dlci5kZWJ1Zyhjb250YWluZXJFWFQ0MDEudG9TdHJpbmcoKSkNCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdITCIsIGZyb21XSExPKQ0KICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWFNCQU4iLCBsb2NrZWRSZXN1bHQuZ2V0U3RyaW5nKCJFWFBCQU4iKSkNCiAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hTIiwgZnJvbVdIU0wpDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ0FNVSIsIGZyb21DQU1VKQ0KDQogICAgICAgIGxvZ2dlci5kZWJ1ZygiUmVzZXQgY29udGFpbmVyIGZvciBFWFQ0MDEiKQ0KICAgICAgICBsb2dnZXIuZGVidWcoY29udGFpbmVyRVhUNDAxLnRvU3RyaW5nKCkpDQoNCiAgICAgIH0NCg0KICAgICAgd2hpbGUgKGFjdGlvbkVYVDQwMS5yZWFkQWxsTG9jayhjb250YWluZXJFWFQ0MDEsIDYsIHVwZGF0ZUFsbFJlY29yZHMpKSB7DQogICAgICAgIC8vDQogICAgICB9DQogICAgfQ0KDQogICAgbG9nZ2VyLmRlYnVnKCJVcHdhcmRzIGluIHRoZSBIaWVyYXJjaHkiKQ0KICAgIC8vIENoYW5nZSBhbGwgUG9zdC1MZXZlbHMgKFVwd2FyZHMgaW4gdGhlIEhpZXJhcmNoeSEpDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDT05PIiwgcHJvZ3JhbS5MREFaRC5DT05PLnRvU3RyaW5nKCkudG9JbnRlZ2VyKCkpDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hMIiwgZnJvbVdITE8pDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhTQkFOIiwgb3JpZ0JBTk8pDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hTIiwgZnJvbVdIU0wpDQogICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDQU1VIiwgZnJvbUNBTVUpDQoNCiAgICBpZiAoYWN0aW9uRVhUNDAxLnJlYWRBbGwoY29udGFpbmVyRVhUNDAxLCA2LCByZWFkQWxsUmVjb3Jkc0VYVDQwMSkpIHsNCiAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdITCIsIGZyb21XSExPKQ0KICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhQQkFOIiwgY29udGFpbmVyRVhUNDAxLmdldFN0cmluZygiRVhTQkFOIikpDQogICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSFMiLCBmcm9tV0hTTCkNCiAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ0FNVSIsIGZyb21DQU1VKQ0KDQogICAgICBhY3Rpb25FWFQ0MDEgPSBkYXRhYmFzZS50YWJsZSgiRVhUNDAxIikuaW5kZXgoIjEwIikuc2VsZWN0QWxsRmllbGRzKCkuYnVpbGQoKQ0KDQogICAgICBDbG9zdXJlIDwgPyA+IHVwZGF0ZUFsbFJlY29yZHMgPSB7DQogICAgICAgIExvY2tlZFJlc3VsdCBsb2NrZWRSZXN1bHQgLT4NCg0KICAgICAgICBpZiAobG9ja2VkUmVzdWx0LmdldCgiRVhDQU1VIikgPT0gZnJvbUNBTVUpIHsNCiAgICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWExTVFEiLCBjb250YWluZXJNSVRMT0MuZ2V0RG91YmxlKCJNTFNUUVQiKSkNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBsb2NrZWRSZXN1bHQuc2V0KCJFWExTVFEiLCBNYXRoLmFicyhUUlFUKSkNCiAgICAgICAgfQ0KDQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYTE1EVCIsIExvY2FsRGF0ZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJZWVlZTU1kZCIpKS50b0ludGVnZXIoKSkNCiAgICAgICAgbG9ja2VkUmVzdWx0LnNldCgiRVhDSElEIiwgcHJvZ3JhbS5nZXRVc2VyKCkpDQogICAgICAgIGxvY2tlZFJlc3VsdC5zZXQoIkVYQ0hOTyIsIGxvY2tlZFJlc3VsdC5nZXRJbnQoIkVYQ0hOTyIpICsgMSkNCg0KICAgICAgICBsb2NrZWRSZXN1bHQudXBkYXRlKCkNCg0KICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSEwiLCBuZXdXSExPKQ0KICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWExXSFMiLCBuZXdXSFNMKQ0KICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWENBTVUiLCBuZXdDQU1VKQ0KDQogICAgICAgIGFjdGlvbkVYVDQwMSA9IGRhdGFiYXNlLnRhYmxlKCJFWFQ0MDEiKS5pbmRleCgiMjAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQoNCiAgICAgICAgaWYgKCFhY3Rpb25FWFQ0MDEucmVhZEFsbChjb250YWluZXJFWFQ0MDEsIDYsIDEsIHJlYWRBbGxSZWNvcmRzRVhUNDAxKSkgew0KICAgICAgICAgIGxvY2tlZFJlc3VsdC5hbGxDb2x1bW5zLmVhY2ggew0KICAgICAgICAgICAgU3RyaW5nIGNvbHVtbiAtPg0KICAgICAgICAgICAgICBpZiAoIVsiRVhMV0hMIiwgIkVYTFdIUyIsICJFWENBTVUiXS5jb250YWlucyhjb2x1bW4pKSB7DQogICAgICAgICAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldChjb2x1bW4sIGxvY2tlZFJlc3VsdC5nZXQoY29sdW1uKSkNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWFdITE8iLCBuZXdXSExPKQ0KICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYV0hTTCIsIG5ld1dIU0wpDQogICAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhDQU1VIiwgbmV3Q0FNVSkNCiAgICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWENXSEwiLCBuZXdXSExPKQ0KICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ1dIUyIsIG5ld1dIU0wpDQogICAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMU1RRIiwgTWF0aC5hYnMoVFJRVCkpDQogICAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhSR0RUIiwgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oIllZWVlNTWRkIikpLnRvSW50ZWdlcigpKQ0KICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYUkdUTSIsIExvY2FsVGltZS5ub3coKS5mb3JtYXQoRGF0ZVRpbWVGb3JtYXR0ZXIub2ZQYXR0ZXJuKCJISG1tc3MiKSkudG9JbnRlZ2VyKCkpDQogICAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMTURUIiwgTG9jYWxEYXRlLm5vdygpLmZvcm1hdChEYXRlVGltZUZvcm1hdHRlci5vZlBhdHRlcm4oIllZWVlNTWRkIikpLnRvSW50ZWdlcigpKQ0KICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ0hJRCIsIHByb2dyYW0uZ2V0VXNlcigpKQ0KICAgICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ0hOTyIsIDApDQoNCiAgICAgICAgICBhY3Rpb25FWFQ0MDEuaW5zZXJ0KGNvbnRhaW5lckVYVDQwMSkNCiAgICAgICAgfQ0KDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYTFdITCIsIGZyb21XSExPKQ0KICAgICAgICBjb250YWluZXJFWFQ0MDEuc2V0KCJFWFBCQU4iLCBjb250YWluZXJFWFQ0MDEuZ2V0U3RyaW5nKCJFWFNCQU4iKSkNCiAgICAgICAgY29udGFpbmVyRVhUNDAxLnNldCgiRVhMV0hTIiwgZnJvbVdIU0wpDQogICAgICAgIGNvbnRhaW5lckVYVDQwMS5zZXQoIkVYQ0FNVSIsIGZyb21DQU1VKQ0KDQogICAgICAgIGFjdGlvbkVYVDQwMSA9IGRhdGFiYXNlLnRhYmxlKCJFWFQ0MDEiKS5pbmRleCgiMTAiKS5zZWxlY3RBbGxGaWVsZHMoKS5idWlsZCgpDQogICAgICB9DQoNCiAgICAgIHdoaWxlIChhY3Rpb25FWFQ0MDEucmVhZEFsbExvY2soY29udGFpbmVyRVhUNDAxLCA2LCB1cGRhdGVBbGxSZWNvcmRzKSkgew0KDQogICAgICB9DQogICAgfQ0KDQogICAgbG9nZ2VyLmRlYnVnKCJGaW5pc2hlZCBzcGxpdEFsbExldmVscyIpDQogIH0NCg0KfQ=="}}}